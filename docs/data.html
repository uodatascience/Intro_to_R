<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R Guide Index</title>
  <meta name="description" content="R Guide Index">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="R Guide Index" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="<a href="https://github.com/uodatascience/R_Guide" class="uri">https://github.com/uodatascience/R_Guide</a>" />
  
  
  <meta name="github-repo" content="uodatascience/R_Guide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Guide Index" />
  
  
  

<meta name="author" content="UO Data Science">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="objects-1.html">
<link rel="next" href="functions-1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Lessons</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#installing-r-and-r-studio"><i class="fa fa-check"></i><b>2.1</b> Installing R and R Studio</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#how-do-i-r"><i class="fa fa-check"></i><b>2.2</b> How do I R?!</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#using-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> Using RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>2.3</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>3</b> What is R?</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-r.html"><a href="what-is-r.html#objects"><i class="fa fa-check"></i><b>3.1</b> Objects</a></li>
<li class="chapter" data-level="3.2" data-path="what-is-r.html"><a href="what-is-r.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a></li>
<li class="chapter" data-level="3.3" data-path="what-is-r.html"><a href="what-is-r.html#packages"><i class="fa fa-check"></i><b>3.3</b> Packages</a></li>
<li class="chapter" data-level="3.4" data-path="what-is-r.html"><a href="what-is-r.html#some-useful-basic-syntax"><i class="fa fa-check"></i><b>3.4</b> Some useful basic syntax</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="objects-1.html"><a href="objects-1.html"><i class="fa fa-check"></i><b>4</b> Objects</a><ul>
<li class="chapter" data-level="4.1" data-path="objects-1.html"><a href="objects-1.html#what-are-objects"><i class="fa fa-check"></i><b>4.1</b> What are Objects?</a><ul>
<li class="chapter" data-level="4.1.1" data-path="objects-1.html"><a href="objects-1.html#object-terminology"><i class="fa fa-check"></i><b>4.1.1</b> Object terminology</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="objects-1.html"><a href="objects-1.html#objects-in-r"><i class="fa fa-check"></i><b>4.2</b> Objects in R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="objects-1.html"><a href="objects-1.html#object-systems"><i class="fa fa-check"></i><b>4.2.1</b> Object Systems</a></li>
<li class="chapter" data-level="4.2.2" data-path="objects-1.html"><a href="objects-1.html#attributes"><i class="fa fa-check"></i><b>4.2.2</b> Attributes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="objects-1.html"><a href="objects-1.html#base-types"><i class="fa fa-check"></i><b>4.3</b> Base Types</a><ul>
<li class="chapter" data-level="4.3.1" data-path="objects-1.html"><a href="objects-1.html#vectors"><i class="fa fa-check"></i><b>4.3.1</b> Vectors</a></li>
<li class="chapter" data-level="4.3.2" data-path="objects-1.html"><a href="objects-1.html#matrices-arrays"><i class="fa fa-check"></i><b>4.3.2</b> Matrices &amp; Arrays</a></li>
<li class="chapter" data-level="4.3.3" data-path="objects-1.html"><a href="objects-1.html#data-frames"><i class="fa fa-check"></i><b>4.3.3</b> Data Frames</a></li>
<li class="chapter" data-level="4.3.4" data-path="objects-1.html"><a href="objects-1.html#etc."><i class="fa fa-check"></i><b>4.3.4</b> Etc.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="objects-1.html"><a href="objects-1.html#s3-objects"><i class="fa fa-check"></i><b>4.4</b> S3 Objects</a><ul>
<li class="chapter" data-level="4.4.1" data-path="objects-1.html"><a href="objects-1.html#example-extending-s3-objects"><i class="fa fa-check"></i><b>4.4.1</b> Example: Extending S3 Objects</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="objects-1.html"><a href="objects-1.html#s4-objects"><i class="fa fa-check"></i><b>4.5</b> S4 Objects</a></li>
<li class="chapter" data-level="4.6" data-path="objects-1.html"><a href="objects-1.html#reference-classes"><i class="fa fa-check"></i><b>4.6</b> Reference Classes</a></li>
<li class="chapter" data-level="4.7" data-path="objects-1.html"><a href="objects-1.html#references"><i class="fa fa-check"></i><b>4.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Data</a><ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#loading-data"><i class="fa fa-check"></i><b>5.1</b> Loading data</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data.html"><a href="data.html#one-day-we-will-have-a-summary-table-here"><i class="fa fa-check"></i><b>5.1.1</b> One day we will have a summary table here</a></li>
<li class="chapter" data-level="5.1.2" data-path="data.html"><a href="data.html#csv-files"><i class="fa fa-check"></i><b>5.1.2</b> .csv files</a></li>
<li class="chapter" data-level="5.1.3" data-path="data.html"><a href="data.html#defaults"><i class="fa fa-check"></i><b>5.1.3</b> Defaults</a></li>
<li class="chapter" data-level="5.1.4" data-path="data.html"><a href="data.html#a-brief-interlude-into-formats-for-data-in-r"><i class="fa fa-check"></i><b>5.1.4</b> A brief interlude into formats for data in R</a></li>
<li class="chapter" data-level="5.1.5" data-path="data.html"><a href="data.html#format-issues"><i class="fa fa-check"></i><b>5.1.5</b> Format issues?</a></li>
<li class="chapter" data-level="5.1.6" data-path="data.html"><a href="data.html#sav-files"><i class="fa fa-check"></i><b>5.1.6</b> .sav files</a></li>
<li class="chapter" data-level="5.1.7" data-path="data.html"><a href="data.html#rio-for-general-import"><i class="fa fa-check"></i><b>5.1.7</b> <code>rio</code> for general import</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#saving-data"><i class="fa fa-check"></i><b>5.2</b> Saving data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="data.html"><a href="data.html#rdata-files"><i class="fa fa-check"></i><b>5.2.1</b> .RData files</a></li>
<li class="chapter" data-level="5.2.2" data-path="data.html"><a href="data.html#sink"><i class="fa fa-check"></i><b>5.2.2</b> <code>sink</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#indexing"><i class="fa fa-check"></i><b>5.3</b> Indexing</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data.html"><a href="data.html#logical-indexing"><i class="fa fa-check"></i><b>5.3.1</b> Logical indexing</a></li>
<li class="chapter" data-level="5.3.2" data-path="data.html"><a href="data.html#assignment-with-indexing"><i class="fa fa-check"></i><b>5.3.2</b> Assignment with Indexing</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#manipulating-data"><i class="fa fa-check"></i><b>5.4</b> Manipulating Data</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data.html"><a href="data.html#wide-vs.long-data"><i class="fa fa-check"></i><b>5.4.1</b> Wide vs. Long Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="data.html"><a href="data.html#piping-syntax"><i class="fa fa-check"></i><b>5.4.2</b> Piping syntax</a></li>
<li class="chapter" data-level="5.4.3" data-path="data.html"><a href="data.html#why-use-pipes"><i class="fa fa-check"></i><b>5.4.3</b> Why use pipes?</a></li>
<li class="chapter" data-level="5.4.4" data-path="data.html"><a href="data.html#saving-the-output-of-your-pipe"><i class="fa fa-check"></i><b>5.4.4</b> Saving the output of your pipe</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#reshaping-data"><i class="fa fa-check"></i><b>5.5</b> Reshaping Data</a><ul>
<li class="chapter" data-level="5.5.1" data-path="data.html"><a href="data.html#wide-to-long"><i class="fa fa-check"></i><b>5.5.1</b> Wide to Long</a></li>
<li class="chapter" data-level="5.5.2" data-path="data.html"><a href="data.html#long-to-wide"><i class="fa fa-check"></i><b>5.5.2</b> Long to wide</a></li>
<li class="chapter" data-level="5.5.3" data-path="data.html"><a href="data.html#final-note-on-reshaping-data"><i class="fa fa-check"></i><b>5.5.3</b> Final note on reshaping data</a></li>
<li class="chapter" data-level="5.5.4" data-path="data.html"><a href="data.html#section"><i class="fa fa-check"></i><b>5.5.4</b> </a></li>
<li class="chapter" data-level="5.5.5" data-path="data.html"><a href="data.html#resources"><i class="fa fa-check"></i><b>5.5.5</b> Resources</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>6</b> Functions</a></li>
<li class="chapter" data-level="7" data-path="useful-functions.html"><a href="useful-functions.html"><i class="fa fa-check"></i><b>7</b> Useful Functions</a><ul>
<li class="chapter" data-level="7.1" data-path="useful-functions.html"><a href="useful-functions.html#workspace"><i class="fa fa-check"></i><b>7.1</b> Workspace</a></li>
<li class="chapter" data-level="7.2" data-path="useful-functions.html"><a href="useful-functions.html#objects-2"><i class="fa fa-check"></i><b>7.2</b> Objects</a></li>
<li class="chapter" data-level="7.3" data-path="useful-functions.html"><a href="useful-functions.html#iteration"><i class="fa fa-check"></i><b>7.3</b> Iteration</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="style-tips.html"><a href="style-tips.html"><i class="fa fa-check"></i><b>8</b> Style Tips</a><ul>
<li class="chapter" data-level="8.1" data-path="style-tips.html"><a href="style-tips.html#nothing-here-except-a-reminder-to-jonny-that-they-should-make-this-page"><i class="fa fa-check"></i><b>8.1</b> NOTHING HERE EXCEPT A REMINDER TO JONNY THAT THEY SHOULD MAKE THIS PAGE</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="how-do-i.html"><a href="how-do-i.html"><i class="fa fa-check"></i><b>9</b> How do I…</a><ul>
<li class="chapter" data-level="9.1" data-path="how-do-i.html"><a href="how-do-i.html#yeeeeeeep-same-thing-here-nothing-but-a-slim-breeze-whistling-through-yer-earwells-the-tickle-tells-ya-it-dont-exist-yet"><i class="fa fa-check"></i><b>9.1</b> YEEEEEEEP SAME THING HERE NOTHING BUT A SLIM BREEZE WHISTLING THROUGH YER EARWELLS, THE TICKLE TELLS YA IT DONT EXIST YET</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Guide Index</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data" class="section level1">
<h1><span class="header-section-number">5</span> Data</h1>
<div id="loading-data" class="section level2">
<h2><span class="header-section-number">5.1</span> Loading data</h2>
<div id="one-day-we-will-have-a-summary-table-here" class="section level3">
<h3><span class="header-section-number">5.1.1</span> One day we will have a summary table here</h3>
<p>Most of the time we have a datafile (either on our hard drive or on the internet) that we want to work with in R. To do that, we can use a function to read the data into R. For instance, the <strong><code>read.table()</code></strong> is a flexible function for reading in data in various formats.</p>
</div>
<div id="csv-files" class="section level3">
<h3><span class="header-section-number">5.1.2</span> .csv files</h3>
<p>In order to use <strong><code>read.table()</code></strong>, you will typically need to specify some of the arguments, such as the argument <strong><code>sep =</code></strong>, which is where you specify the thing that seperates values in your data file.</p>
<p>For example, if you are working with a data file in the comma seperated values (csv) format, you would need to specify that commas are the seperator with <strong><code>sep = &quot;,&quot;</code></strong>.</p>
</div>
<div id="defaults" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Defaults</h3>
<p>Thankfully, other people have done this for us, and have created functions that have the proper defaults to work with common formats like csv fles. For csv files, To see the defaults, simply check the documentation with e.g. <strong><code>?read.table</code></strong></p>
<p><strong><code>read.csv()</code></strong> is basically a version of <strong><code>read.table()</code></strong> with the defaults set up to work well with csv files. These defaults include setting <strong>“,”</strong> as the seperator, and setting <strong><code>header = TRUE</code></strong>, which means that R will read in the first row in the csv file as being a header row, and treat that row as the row of column names. These defaults can be changed though, so if you had a file with no header, you would indicate that with <strong><code>header = FALSE</code></strong>, like so</p>
<p><code>read.csv(file_path/file_name.csv, header = FALSE)</code></p>
<p>where file_path is the full path to the file, and file_name is the name of the data file. Take a look at the documentation for <code>read.csv()</code> with <code>?read.csv()</code> to see the different arguments and defaults.</p>
</div>
<div id="a-brief-interlude-into-formats-for-data-in-r" class="section level3">
<h3><span class="header-section-number">5.1.4</span> A brief interlude into formats for data in R</h3>
<p>There are lots of options for reading data into R, even for a single format.</p>
<p>For example, we could instead use <strong><code>read_csv()</code></strong> from the <strong><code>readr</code></strong> package. The main difference between <strong><code>read.csv()</code></strong> and <strong><code>read_csv()</code></strong> is that they load the data into different formats in R. <strong><code>read.csv()</code></strong> will read your data in as a <strong><code>data.frame</code></strong>, which is a common format of data in R.</p>
<p><strong><code>read_csv()</code></strong> will read your data in as a <strong><code>tibble</code></strong>, which is the data format associated with the tidyverse. There are a couple of differences between these formats. They have different printing defaults, there are differences in subsetting, and differences in recycling. Check out the documentation by running the code <strong><code>vignette(&quot;tibble&quot;)</code></strong> or by checking out the chapter on tibbles in the R for Data Science Book <a href="http://r4ds.had.co.nz/tibbles.html" class="uri">http://r4ds.had.co.nz/tibbles.html</a>.</p>
<p>Outside of these differences, they are mostly interchangeable (for most purposes), but occassionally a function will only work properly with one or the other. For example, the <strong><code>reshape()</code></strong> function only works properly with <em>data.frames</em> (unless that has changed in an update).</p>
</div>
<div id="format-issues" class="section level3">
<h3><span class="header-section-number">5.1.5</span> Format issues?</h3>
<p>In some rare cases, you may be getting an error due to differences between how your data is formatted in R and what format the function you’re attempting to use works with.</p>
<p>This will sometimes be spelled out in the documentation (e.g., <strong><code>reshape</code></strong> says it takes data frames as the first argument), but its not always clear; sometimes, you just need to test it out. If you do need to go between different formats, that is easy to do in R with a couple of functions. <strong><code>as.data.frame()</code></strong> will turn an object that can be a dataframe into a dataframe. <strong><code>as_tibble</code></strong> will turn an object that can be a tibble into a tibble.</p>
</div>
<div id="sav-files" class="section level3">
<h3><span class="header-section-number">5.1.6</span> .sav files</h3>
<p>R can also work with datafiles that are formatted for SPSS, which have the extension ‘.sav’.</p>
<p>Like csv’s, there are a few options. The one that seems to work the best is <strong><code>read_spss()</code></strong> from the haven package (also a part of the tidyverse). There is also a function called <strong><code>read.spss()</code></strong> from the <strong><code>foreign</code></strong> package, but it is no longer being maintained and may stop working; it also had some frustrating qualities, so probably best to stick to <strong><code>read_spss()</code></strong>. It’s worth noting that <strong><code>read_spss()</code></strong> will format your data as a <strong><code>tibble</code></strong>. If you don’t want it as a <strong><code>tibble</code></strong>, you can always use the <strong><code>as.data.frame()</code></strong> function to turn it into a generic <strong><code>data.frame</code></strong>.</p>
</div>
<div id="rio-for-general-import" class="section level3">
<h3><span class="header-section-number">5.1.7</span> <code>rio</code> for general import</h3>
<p>Another function worth knowing about for reading in data is the <strong><code>import()</code></strong> function from the <strong><code>rio</code></strong> package. The nice thing about <strong><code>import()</code></strong> is that it works with lots of different types of datafiles, and very little has to be changed for each type of datafile. For example, if our data (let’s say its name is ‘df’) were a .sav file, we would read it in with the following command:</p>
<p><code>import(df.sav)</code></p>
<p>If it were instead a csv, we would use the following command:</p>
<p><code>import(df.csv)</code></p>
<p>Note that virtually nothing changed, just the file extension (which is part of the name of the file). <strong><code>import()</code></strong> is able to figure out the format of the file based on that extension.</p>
<p><strong>Remember to assign your data to a variable in the environment!</strong></p>
<p>A pretty common and frustrating mistake people make when starting with R is not saving their data file as an object. For example, if we were loading in our datafile called ‘df’, we may want to run some code like this:</p>
<p><code>import(df.csv)</code></p>
<p>However, this is telling R to just read the data. If you run code like that, it will simply read the data, and print out the data (or some subset of it) into the console. Then, when you go to work with the data, it won’t be in your global environment. That’s because you didn’t save it as an object. You would do that the same way you save anything as an object, with the assignment operator: <code>&lt;-</code>. So instead of the above, you’d instead want to run something like the following:</p>
<p><code>df &lt;- import(df.csv)</code></p>
<p>Now R has read our data and stored it as an object called <code>df</code>, that we can start running our models on.</p>
</div>
</div>
<div id="saving-data" class="section level2">
<h2><span class="header-section-number">5.2</span> Saving data</h2>
<p>Most of the above functions have complementary <code>write</code> functions, for example <code>write.csv</code> or <code>haven::write_sav</code>. There are two other common ways you may want to save your data</p>
<div id="rdata-files" class="section level3">
<h3><span class="header-section-number">5.2.1</span> .RData files</h3>
<p>Because all objects in R descend from a precious few C structures, they can all be easily <strong>serialized</strong>, or converted into a string of bits that can be written to disk (not always true in other languages, like Python). These files typically can’t be read by anything but R (except if that thing is another programming language where someone has written a specific routine to do so!), so if your mom tries to look at your cool data in openoffice they’ll be out of luck.</p>
<p>Saving (and loading) .RData files works with the … <code>save</code> and … <code>load</code> functions</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cant_forget &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;you have to stop wiping your nose with just whatever is close at hand&quot;</span>,
                 <span class="st">&quot;see you did it just now that was mine&quot;</span>)
<span class="kw">save</span>(cant_forget, <span class="dt">file=</span><span class="st">&quot;cant_forget.RData&quot;</span>)

<span class="co"># Now delete the object so we know our load is real</span>
<span class="kw">rm</span>(cant_forget)

<span class="co"># here we load to the .GlobalEnv, don&#39;t worry we&#39;ll cover environments later</span>
<span class="kw">load</span>(<span class="st">&quot;cant_forget.RData&quot;</span>)
cant_forget</code></pre></div>
<pre><code>## [1] &quot;you have to stop wiping your nose with just whatever is close at hand&quot;
## [2] &quot;see you did it just now that was mine&quot;</code></pre>
<p>Note: as is true of all files, the extension (ending it with ‘RData’) doesn’t effect the way that a file is saved or represented on the disk, it just serves to tell the operating system which programs can open it, and to tell other programs how they should open it. You could just as easily save your object like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(cant_forget, <span class="dt">file=</span><span class="st">&quot;cant_forget.butiwantto&quot;</span>)</code></pre></div>
<p>There is one special .RData file, and that’s the file that’s just called “.RData” in your user directory (for osx <code>/Users/Username</code> – probably hidden by default). R automatically loads this file every time it opens – this is the file that is made whenever you accept RStudio’s frequent offers to save your workspace image.</p>
<p><code>save</code> is also capable of using a few common compression algorithms. This is most useful for large objects that have many repeated values – common with “long” format data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">save</span>(cant_forget, <span class="dt">file=</span><span class="st">&quot;cant_forget.RData&quot;</span>,
     <span class="dt">compress=</span><span class="ot">TRUE</span>, <span class="co"># or &quot;gzip&quot;, &quot;bzip2&quot;, &quot;xz&quot;</span>
     <span class="dt">compression_level=</span><span class="dv">6</span>) <span class="co"># more is smaller, but slower</span></code></pre></div>
<p>If you’re curious, check out the <code>saveRDS</code> function - it’s designed to save single objects (rather than <code>save</code>, which can save arbitrary numbers of objects by keeping them in an environment). Since <code>save</code> saves the object and its environment, when it is loaded it will have the same name – this can be troublesome when you have already used that name, or when you forget what the name is. Loading objects (<code>readRDS</code>) saved by <code>saveRDS</code> works like other loading functions, so you can assign the loaded object to whatver name you’d like.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">saveRDS</span>(cant_forget, <span class="dt">file=</span><span class="st">&quot;cant_forget.rds&quot;</span>)

<span class="co"># We can rewrite our fate.</span>
sad_news &lt;-<span class="st"> </span><span class="kw">readRDS</span>(<span class="st">&quot;cant_forget.rds&quot;</span>)</code></pre></div>
</div>
<div id="sink" class="section level3">
<h3><span class="header-section-number">5.2.2</span> <code>sink</code></h3>
<p>Perhaps common is an overstatement. Consider these the option of last resort when all you want to do is put what you see in this window in some other window and ya don’t care how ya do it.</p>
<p>Any output that would go to the console (specifically to <code>stdout</code> - try <code>?stdout</code> - so it’s a bit tricky to open a sink in a code chunk) can be diverted to a file by using the <code>sink</code> function. You must call <code>sink</code> with a filename to start diverting data, and then call <code>sink</code> again to stop.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Open the sink</span>
<span class="kw">sink</span>(<span class="st">&quot;save-everything-here.txt&quot;</span>)

life_story &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;what we need at the store 2day guys&quot;</span>, <span class="st">&quot;it&#39;s always just apples and bananas&quot;</span>, <span class="st">&quot;we have severe vitamin deficiencies&quot;</span>)
life_story</code></pre></div>
<pre><code>## [1] &quot;what we need at the store 2day guys&quot;
## [2] &quot;it&#39;s always just apples and bananas&quot;
## [3] &quot;we have severe vitamin deficiencies&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># turn off the sink</span>
<span class="kw">sink</span>()

<span class="co"># now see what&#39;s in our file</span>
<span class="kw">readLines</span>(<span class="st">&quot;save-everything-here.txt&quot;</span>)</code></pre></div>
<pre><code>## character(0)</code></pre>
<p><code>sink</code> doesn’t work with graphical output, to do that we have to use a function that dumps to a graphics driver, which then saves it as a file. We can see our current graphics device by getting that option…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">getOption</span>(<span class="st">&quot;device&quot;</span>)</code></pre></div>
<pre><code>## function (width = 7, height = 7, ...) 
## {
##     grDevices::pdf(NULL, width, height, ...)
## }
## &lt;environment: namespace:knitr&gt;</code></pre>
<p>The devices available in the base package are:</p>
<ul>
<li><code>pdf()</code></li>
<li><code>postscript()</code></li>
<li><code>xfig()</code></li>
<li><code>bitmap()</code></li>
<li><code>pictex()</code></li>
</ul>
<p>For example</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># make n save a cool plot to show your friends</span>
<span class="kw">pdf</span>(<span class="st">&quot;put-plots-here.pdf&quot;</span>)
<span class="kw">plot</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>))
<span class="kw">dev.off</span>()</code></pre></div>
<pre><code>## quartz_off_screen 
##                 2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># open the pdf however yer system wants to</span>
abs_path &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">getwd</span>(), <span class="st">&quot;put-plots-here.pdf&quot;</span>)
<span class="kw">system2</span>(<span class="st">&#39;open&#39;</span>, <span class="dt">args=</span>abs_path, <span class="dt">wait=</span><span class="ot">FALSE</span>)</code></pre></div>
<p>Notice how we have to use <code>dev.off()</code> rather than calling <code>pdf()</code> again as would be expected from <code>sink</code></p>
</div>
</div>
<div id="indexing" class="section level2">
<h2><span class="header-section-number">5.3</span> Indexing</h2>
<p>Or, how to get specific pieces of stuff.</p>
<p>We’ve already seen a bunch of basic indexing</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># try ?seq</span>
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">25</span>, <span class="dv">5</span>)
x</code></pre></div>
<pre><code>## [1]  5 10 15 20 25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">1</span>:<span class="dv">24</span>, <span class="dt">dim=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">8</span>))
y</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
## [1,]    1    4    7   10   13   16   19   22
## [2,]    2    5    8   11   14   17   20   23
## [3,]    3    6    9   12   15   18   21   24</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="st">&quot;scores&quot;</span>=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), 
          <span class="st">&quot;numbers&quot;</span>=<span class="kw">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>))

<span class="co"># good ole positional indexing</span>
x[<span class="dv">3</span>]</code></pre></div>
<pre><code>## [1] 15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># indexing with a vector to select multiple positions</span>
x[<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)]</code></pre></div>
<pre><code>## [1] 15 25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># higher dimensional objects have more dimensions to index</span>
y[<span class="dv">1</span>,<span class="dv">5</span>]</code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># both together</span>
y[<span class="dv">3</span>, <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">7</span>)]</code></pre></div>
<pre><code>## [1]  9 12 21</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># leaving a position blank selects all of its indices</span>
y[<span class="dv">2</span>,]</code></pre></div>
<pre><code>## [1]  2  5  8 11 14 17 20 23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># with names</span>
<span class="kw">names</span>(x) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;adam&quot;</span>, <span class="st">&quot;steve&quot;</span>, <span class="st">&quot;harry&quot;</span>, <span class="st">&quot;ted&quot;</span>, <span class="st">&quot;watson&quot;</span>)
x[<span class="st">&quot;harry&quot;</span>]</code></pre></div>
<pre><code>## harry 
##    15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z[<span class="st">&quot;numbers&quot;</span>]</code></pre></div>
<pre><code>## $numbers
## [1]  6  7  8  9 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Using double brackets to return a vector instead of a list</span>
z[[<span class="st">&quot;numbers&quot;</span>]]</code></pre></div>
<pre><code>## [1]  6  7  8  9 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># and the equivalent dollar sign</span>
z$scores</code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<p>Negative values deselect</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[-<span class="dv">3</span>]</code></pre></div>
<pre><code>##   adam  steve    ted watson 
##      5     10     20     25</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># useful to select starting from the end</span>
-(<span class="dv">1</span>:<span class="dv">3</span>) <span class="co"># quick way to construct sequences of negative numbers</span></code></pre></div>
<pre><code>## [1] -1 -2 -3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[-(<span class="dv">1</span>:<span class="dv">3</span>)] <span class="co"># get the last two</span></code></pre></div>
<pre><code>##    ted watson 
##     20     25</code></pre>
<p>We have also seen chained indexing, think of it like indexing the product of each successive indexing operation</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)][<span class="dv">2</span>]</code></pre></div>
<pre><code>## harry 
##    15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z[[<span class="st">&quot;numbers&quot;</span>]][<span class="dv">4</span>]</code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># one reason why it&#39;s important what class is returned from your indexing operation</span>
<span class="co"># aka knowing why we use double brackets</span>
z[<span class="st">&quot;numbers&quot;</span>][<span class="dv">4</span>]</code></pre></div>
<pre><code>## $&lt;NA&gt;
## NULL</code></pre>
<p>dplyr has a <code>select</code> function and a collection of tools (“select helpers”) to make selecting variables by name a bit more flexible:</p>
<ul>
<li><code>starts_with()</code></li>
<li><code>ends_with()</code></li>
<li><code>contains()</code></li>
<li><code>matches()</code> - variables that match a regular expression</li>
<li><code>num_range()</code> - eg <code>num_range(&quot;x&quot;,1:5)</code> to select <code>x1, x2, ...</code></li>
<li><code>one_of()</code> - find variables in a list, eg. <code>one_of(c(&quot;calcium&quot;, &quot;potassium&quot;, &quot;magnesium&quot;))</code></li>
<li><code>everything()</code> - all variables, don’t know why you’d use this.</li>
</ul>
<p>A few examples…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span>ggplot2::diamonds
<span class="kw">names</span>(df)</code></pre></div>
<pre><code>##  [1] &quot;carat&quot;   &quot;cut&quot;     &quot;color&quot;   &quot;clarity&quot; &quot;depth&quot;   &quot;table&quot;   &quot;price&quot;  
##  [8] &quot;x&quot;       &quot;y&quot;       &quot;z&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">select</span>(df, <span class="kw">starts_with</span>(<span class="st">&quot;c&quot;</span>)))</code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   carat       cut color clarity
##   &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt;
## 1  0.23     Ideal     E     SI2
## 2  0.21   Premium     E     SI1
## 3  0.23      Good     E     VS1
## 4  0.29   Premium     I     VS2
## 5  0.31      Good     J     SI2
## 6  0.24 Very Good     J    VVS2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">select</span>(df, <span class="kw">one_of</span>(<span class="kw">c</span>(<span class="st">&quot;color&quot;</span>, <span class="st">&quot;hue&quot;</span>, <span class="st">&quot;luminance&quot;</span>, <span class="st">&quot;clarity&quot;</span>))))</code></pre></div>
<pre><code>## Warning: Unknown variables: `hue`, `luminance`</code></pre>
<pre><code>## # A tibble: 6 x 2
##   color clarity
##   &lt;ord&gt;   &lt;ord&gt;
## 1     E     SI2
## 2     E     SI1
## 3     E     VS1
## 4     I     VS2
## 5     J     SI2
## 6     J    VVS2</code></pre>
<div id="logical-indexing" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Logical indexing</h3>
<p>In addition to specifying what we want by position, we can specify what we want by using a vector of booleans (<code>TRUE</code>, <code>FALSE</code>) the same length as the object</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="dv">3</span>]</code></pre></div>
<pre><code>## harry 
##    15</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x[<span class="kw">c</span>(<span class="ot">FALSE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">FALSE</span>)]</code></pre></div>
<pre><code>## harry 
##    15</code></pre>
<p>This is useful when combined with logical statements (see <code>?base::Logic</code>) and comparisons (see <code>?Comparison</code>). One makes logical statements or comparisons with these operators:</p>
<table>
<thead>
<tr class="header">
<th>Operator</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>!x</code></td>
<td>not x</td>
</tr>
<tr class="even">
<td><code>x &amp; y</code>, <code>x &amp;&amp; y</code></td>
<td>x and y (vectorized, single comparison)</td>
</tr>
<tr class="odd">
<td><code>x | y</code>, <code>x || y</code></td>
<td>x or y (vectorized, single comparison)</td>
</tr>
<tr class="even">
<td><code>xor(x, y)</code></td>
<td>exclusive or (x or y but not both)</td>
</tr>
<tr class="odd">
<td><code>x &lt; y</code></td>
<td>x less than y</td>
</tr>
<tr class="even">
<td><code>x &lt;= y</code></td>
<td>x less than or equal to y</td>
</tr>
<tr class="odd">
<td><code>x &gt; y</code></td>
<td>x greater than y</td>
</tr>
<tr class="even">
<td><code>x &gt;= y</code></td>
<td>x greater than or equal to y</td>
</tr>
<tr class="odd">
<td><code>x == y</code></td>
<td>x is equal to y</td>
</tr>
<tr class="even">
<td><code>x != y</code></td>
<td>x is not equal to y</td>
</tr>
</tbody>
</table>
<p>These will all output boolean vectors, more examples</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &gt;<span class="st"> </span><span class="dv">10</span></code></pre></div>
<pre><code>##   adam  steve  harry    ted watson 
##  FALSE  FALSE   TRUE   TRUE   TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &gt;=<span class="st"> </span><span class="dv">10</span></code></pre></div>
<pre><code>##   adam  steve  harry    ted watson 
##  FALSE   TRUE   TRUE   TRUE   TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># logical operators can be combined</span>
(x &gt;<span class="st"> </span><span class="dv">10</span>) &amp;<span class="st"> </span>(x &lt;<span class="st"> </span><span class="dv">20</span>)</code></pre></div>
<pre><code>##   adam  steve  harry    ted watson 
##  FALSE  FALSE   TRUE  FALSE  FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the single &amp; will compare each element</span>
<span class="kw">cbind</span>((x&gt;<span class="dv">10</span>), (x&lt;<span class="dv">20</span>),((x&gt;<span class="dv">10</span>) &amp;<span class="st"> </span>(x&lt;<span class="dv">20</span>)))</code></pre></div>
<pre><code>##         [,1]  [,2]  [,3]
## adam   FALSE  TRUE FALSE
## steve  FALSE  TRUE FALSE
## harry   TRUE  TRUE  TRUE
## ted     TRUE FALSE FALSE
## watson  TRUE FALSE FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># double &amp;&amp;s will only compare the first element - use it when you are trying to evaluate whether a single thing is true or false, eg. is this value greater than one? are my vectors the same length?</span>
(<span class="kw">max</span>(x) &gt;<span class="st"> </span><span class="dv">20</span>) &amp;&amp;<span class="st"> </span>(<span class="kw">min</span>(x) &lt;=<span class="st"> </span><span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>This can be used in indexing, either by explicitly referring to the object within the indexing operator, or by using the <code>with</code> function</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get all the rows in diamonds who are Good or Very Good</span>
<span class="co"># remember the comma at the end, we want to select all columns</span>
df[df$cut==<span class="st">&quot;Good&quot;</span> |<span class="st"> </span>df$cut==<span class="st">&quot;Very Good&quot;</span>,]</code></pre></div>
<pre><code>## # A tibble: 16,988 x 10
##    carat       cut color clarity depth table price     x     y     z
##    &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
##  2  0.31      Good     J     SI2  63.3    58   335  4.34  4.35  2.75
##  3  0.24 Very Good     J    VVS2  62.8    57   336  3.94  3.96  2.48
##  4  0.24 Very Good     I    VVS1  62.3    57   336  3.95  3.98  2.47
##  5  0.26 Very Good     H     SI1  61.9    55   337  4.07  4.11  2.53
##  6  0.23 Very Good     H     VS1  59.4    61   338  4.00  4.05  2.39
##  7  0.30      Good     J     SI1  64.0    55   339  4.25  4.28  2.73
##  8  0.30      Good     J     SI1  63.4    54   351  4.23  4.29  2.70
##  9  0.30      Good     J     SI1  63.8    56   351  4.23  4.26  2.71
## 10  0.30 Very Good     J     SI1  62.7    59   351  4.21  4.27  2.66
## # ... with 16,978 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># you can combine boolean vectors arbitrarily</span>

df[df$cut==<span class="st">&quot;Good&quot;</span> &amp;<span class="st"> </span>df$carat&gt;<span class="dv">1</span>,]</code></pre></div>
<pre><code>## # A tibble: 1,579 x 10
##    carat   cut color clarity depth table price     x     y     z
##    &lt;dbl&gt; &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1  1.01  Good     I      I1  63.1    57  2844  6.35  6.39  4.02
##  2  1.01  Good     H      I1  64.2    61  2846  6.25  6.18  3.99
##  3  1.03  Good     J     SI1  63.6    57  2855  6.38  6.29  4.03
##  4  1.04  Good     I     SI2  59.9    64  2970  6.51  6.45  3.88
##  5  1.01  Good     E      I1  63.8    57  3032  6.40  6.33  4.06
##  6  1.02  Good     E      I1  63.1    60  3051  6.31  6.40  4.01
##  7  1.01  Good     J     SI2  63.7    60  3088  6.40  6.29  4.05
##  8  1.29  Good     I      I1  64.2    54  3098  6.93  6.83  4.42
##  9  1.52  Good     E      I1  57.3    58  3105  7.53  7.42  4.28
## 10  1.52  Good     E      I1  57.3    58  3105  7.53  7.42  4.28
## # ... with 1,569 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># select columns in the usual way too</span>
<span class="kw">head</span>(df[df$cut==<span class="st">&quot;Good&quot;</span> &amp;<span class="st"> </span>df$carat&gt;<span class="dv">1</span>, <span class="dv">2</span>])</code></pre></div>
<pre><code>## # A tibble: 6 x 1
##     cut
##   &lt;ord&gt;
## 1  Good
## 2  Good
## 3  Good
## 4  Good
## 5  Good
## 6  Good</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df[df$cut==<span class="st">&quot;Good&quot;</span> &amp;<span class="st"> </span>df$carat&gt;<span class="dv">1</span>, <span class="st">&quot;color&quot;</span>])</code></pre></div>
<pre><code>## # A tibble: 6 x 1
##   color
##   &lt;ord&gt;
## 1     I
## 2     H
## 3     J
## 4     I
## 5     E
## 6     E</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df[df$cut==<span class="st">&quot;Good&quot;</span> &amp;<span class="st"> </span>df$carat&gt;<span class="dv">1</span>,]$color)</code></pre></div>
<pre><code>## [1] I H J I E E
## Levels: D &lt; E &lt; F &lt; G &lt; H &lt; I &lt; J</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># %in% is a useful way to select multiple levels of a factor</span>
<span class="kw">head</span>(df[df$cut %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Very Good&quot;</span>),])</code></pre></div>
<pre><code>## # A tibble: 6 x 10
##   carat       cut color clarity depth table price     x     y     z
##   &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
## 2  0.31      Good     J     SI2  63.3    58   335  4.34  4.35  2.75
## 3  0.24 Very Good     J    VVS2  62.8    57   336  3.94  3.96  2.48
## 4  0.24 Very Good     I    VVS1  62.3    57   336  3.95  3.98  2.47
## 5  0.26 Very Good     H     SI1  61.9    55   337  4.07  4.11  2.53
## 6  0.23 Very Good     H     VS1  59.4    61   338  4.00  4.05  2.39</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># with temporarily attaches our dataframe so we don&#39;t have to keep referring to it explicitly</span>
<span class="kw">head</span>(<span class="kw">with</span>(df, df[cut %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Very Good&quot;</span>),]))</code></pre></div>
<pre><code>## # A tibble: 6 x 10
##   carat       cut color clarity depth table price     x     y     z
##   &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
## 2  0.31      Good     J     SI2  63.3    58   335  4.34  4.35  2.75
## 3  0.24 Very Good     J    VVS2  62.8    57   336  3.94  3.96  2.48
## 4  0.24 Very Good     I    VVS1  62.3    57   336  3.95  3.98  2.47
## 5  0.26 Very Good     H     SI1  61.9    55   337  4.07  4.11  2.53
## 6  0.23 Very Good     H     VS1  59.4    61   338  4.00  4.05  2.39</code></pre>
<p>A boolean vector can be converted back to a numerical position vector with <code>which</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &gt;<span class="st"> </span><span class="dv">10</span></code></pre></div>
<pre><code>##   adam  steve  harry    ted watson 
##  FALSE  FALSE   TRUE   TRUE   TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">which</span>(x &gt;<span class="st"> </span><span class="dv">10</span>)</code></pre></div>
<pre><code>##  harry    ted watson 
##      3      4      5</code></pre>
</div>
<div id="assignment-with-indexing" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Assignment with Indexing</h3>
<p>Sometimes we need to change some values in an existing object, but all assignments to existing objects have to have the same shape and class. If you give something too small, it will be repeated Rather than having to create a new object, we can assign to an indexed subset of an object</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">friends &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">names=</span><span class="kw">c</span>(<span class="st">&quot;toothbrush&quot;</span>, <span class="st">&quot;vacuum&quot;</span>, <span class="st">&quot;blinds&quot;</span>),
                      <span class="dt">hobbies=</span><span class="kw">c</span>(<span class="st">&quot;brushing&quot;</span>, <span class="st">&quot;spinning&quot;</span>, <span class="st">&quot;darkening&quot;</span>),
                      <span class="dt">favorites=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))

<span class="co"># too small :(</span>
friends$favorites &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)</code></pre></div>
<pre><code>## Error in `$&lt;-.data.frame`(`*tmp*`, favorites, value = c(4, 5)): replacement has 2 rows, data has 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># toothbrush and vacuum get a demotion</span>
friends[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),]$favorites &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)</code></pre></div>
</div>
</div>
<div id="manipulating-data" class="section level2">
<h2><span class="header-section-number">5.4</span> Manipulating Data</h2>
<p>Now that you have your data in R, and have maybe subsetted it in some manner, you may want to manipulate the data. In this section, we’ll cover some ways that you might want to manipulate data, including manipulating the format of the data and creating new variables (both from combining/splitting existing variables, and creating new ones if you need to).</p>
<div id="wide-vs.long-data" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Wide vs. Long Data</h3>
<p>Let’s start by talking about one of the more common data format issues, which is whether data are structured in a <em>long</em> or <em>wide</em> format. These, like basically all things, exist on a continuum (data is almost always somewhere in between the extremes of long and wide). So, it’s probably helpful to start with an example.</p>
<p>One common design that leads to data easily represented as wide or long is longitudinal data. Let’s say we administer the Big Five Inventory - 2 (BFI-2; Soto &amp; John, 2016) to a sample of incoming freshman annually for 4 years. To keep things simple, let’s say we only have that data (nothing else was administered). In this case, you may have a dataset that looks like this:</p>
<pre><code>## Loading tidyverse: ggplot2
## Loading tidyverse: tibble
## Loading tidyverse: tidyr
## Loading tidyverse: readr
## Loading tidyverse: purrr</code></pre>
<pre><code>## Conflicts with tidy packages ----------------------------------------------</code></pre>
<pre><code>## filter(): dplyr, stats
## lag():    dplyr, stats</code></pre>
<pre><code>## # A tibble: 100 x 21
##      pid agreeableness_t1 conscientiousness_t1 neuroticism_t1
##    &lt;dbl&gt;            &lt;dbl&gt;                &lt;dbl&gt;          &lt;dbl&gt;
##  1     1         3.272170             2.910066       1.930431
##  2     2         4.437896             5.077282       3.426696
##  3     3         2.637504             1.142518       3.235054
##  4     4         3.565533             3.592956       4.294807
##  5     5         3.420215             1.192690       3.625460
##  6     6         3.055457             2.939600       2.746538
##  7     7         3.601571             4.568350       3.656175
##  8     8         2.721202             2.324931       3.278157
##  9     9         2.235776             3.469522       2.424450
## 10    10         4.018627             2.210176       4.517837
## # ... with 90 more rows, and 17 more variables: extraversion_t1 &lt;dbl&gt;,
## #   openness_t1 &lt;dbl&gt;, agreeableness_t2 &lt;dbl&gt;, conscientiousness_t2 &lt;dbl&gt;,
## #   neuroticism_t2 &lt;dbl&gt;, extraversion_t2 &lt;dbl&gt;, openness_t2 &lt;dbl&gt;,
## #   agreeableness_t3 &lt;dbl&gt;, conscientiousness_t3 &lt;dbl&gt;,
## #   neuroticism_t3 &lt;dbl&gt;, extraversion_t3 &lt;dbl&gt;, openness_t3 &lt;dbl&gt;,
## #   agreeableness_t4 &lt;dbl&gt;, conscientiousness_t4 &lt;dbl&gt;,
## #   neuroticism_t4 &lt;dbl&gt;, extraversion_t4 &lt;dbl&gt;, openness_t4 &lt;dbl&gt;</code></pre>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    100 obs. of  21 variables:
##  $ pid                 : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ agreeableness_t1    : num  3.27 4.44 2.64 3.57 3.42 ...
##  $ conscientiousness_t1: num  2.91 5.08 1.14 3.59 1.19 ...
##  $ neuroticism_t1      : num  1.93 3.43 3.24 4.29 3.63 ...
##  $ extraversion_t1     : num  4.0515 3.04 0.0634 3.3821 3.1879 ...
##  $ openness_t1         : num  5.32 5.07 3.35 1.62 2.65 ...
##  $ agreeableness_t2    : num  3.91 5.07 2.87 4.18 3.82 ...
##  $ conscientiousness_t2: num  3.16 4.95 1.67 4.11 1.78 ...
##  $ neuroticism_t2      : num  2.27 3.98 3.78 4.51 4.01 ...
##  $ extraversion_t2     : num  4.728 3.363 0.826 3.889 3.402 ...
##  $ openness_t2         : num  5.86 5.54 4 2.06 3.07 ...
##  $ agreeableness_t3    : num  4.63 5.27 3.13 4.27 4.39 ...
##  $ conscientiousness_t3: num  3.65 5.41 2.43 4.39 1.98 ...
##  $ neuroticism_t3      : num  2.86 4.77 4.07 4.76 4.72 ...
##  $ extraversion_t3     : num  5.24 3.67 1.51 4.28 3.65 ...
##  $ openness_t3         : num  6.53 5.85 4.82 2.75 3.34 ...
##  $ agreeableness_t4    : num  4.88 5.65 3.85 4.64 4.86 ...
##  $ conscientiousness_t4: num  4.17 5.57 2.76 4.92 2.64 ...
##  $ neuroticism_t4      : num  2.94 5.56 4.96 5.26 4.95 ...
##  $ extraversion_t4     : num  5.65 4.26 1.61 5.12 3.78 ...
##  $ openness_t4         : num  7.17 6.36 5.8 3.21 3.82 ...</code></pre>
<p>As you can see in the above, we have a row for each participant, and a column corresponding to each Big 5 score at each time point. For example, column 2 contains each participant’s score on Agreeableness at time 1, column 7 contains each participant’s score on Agreeableness at time 2, etc.</p>
<p>This data is in a <em>wide</em> format. It’s also in basically the widest format it could be in for any reasonable purpose; the only way to make it wider would be to have a single row, and a column for each participant X Big 5 score X time point.</p>
<p>What would make this data <em>long</em>? There are two dimensions that we could lengthen the data on, but the more common one you might see is time. That is, we’d have a row for each participant X time point combination, like the following:</p>
<p>So we now have a row for each participant at each time point, and a column for each of the Big 5. We could also make it a little longer, by making each row correspond to a score on each Big Five trait for each participant at each time point, like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_long %&gt;%
<span class="st">  </span><span class="kw">gather</span>(trait, score, agreeableness:openness)</code></pre></div>
<pre><code>## # A tibble: 2,000 x 4
##      pid  time         trait    score
##    &lt;dbl&gt; &lt;chr&gt;         &lt;chr&gt;    &lt;dbl&gt;
##  1     1    t1 agreeableness 3.272170
##  2     1    t2 agreeableness 3.908980
##  3     1    t3 agreeableness 4.630217
##  4     1    t4 agreeableness 4.879904
##  5     2    t1 agreeableness 4.437896
##  6     2    t2 agreeableness 5.069580
##  7     2    t3 agreeableness 5.269524
##  8     2    t4 agreeableness 5.648835
##  9     3    t1 agreeableness 2.637504
## 10     3    t2 agreeableness 2.866149
## # ... with 1,990 more rows</code></pre>
</div>
<div id="piping-syntax" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Piping syntax</h3>
<p>Before we get into reshaping data, its importantt we cover a type of syntax called piping. Piping is not unique to R, but it is highly useful in R, especially for data wrangling and manipulation. The pipe itself is this symbol <code>%&gt;%</code>, and in R, it comes from the <em>magrittr</em> package (this is a references to the famous painging by Magritte,the treachery of images). <em>magrittr</em> is part of the tidyverse, so it will load when you call the tidyverse library.</p>
<div id="a-quick-sidenote-about-the-term-pipe" class="section level4">
<h4><span class="header-section-number">5.4.2.1</span> A quick sidenote about the term pipe</h4>
<p>As mentioned above, a pipe in piping syntax is symbolized by <code>%&gt;%</code>. However, another character is sometimes called a pipe, which is the vertical bar |, and this is used quite a bit in logical/boolean operations (| means or in logical statements).</p>
</div>
<div id="the-logic-of-piping-syntax" class="section level4">
<h4><span class="header-section-number">5.4.2.2</span> The logic of piping syntax</h4>
<p>The general idea of piping syntax, is that we have some function on the lefthand and righthand side of the pipe. The function on the leftside is evaluated, and then the <strong>output</strong> of that function is passed to the function on the righthand side of the pipe as the first argument of that function. Let’s start with a simple example. We’ll create a vector of values and take the mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># first set.seed, because we&#39;re going to be sampling values. </span>
<span class="co"># this will make it so we always get the same result.</span>
<span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="co"># first create a vector using rnorm. This is saying give me a random sample of 20 observations, drawn from a normal distribution with a mean of 5 and sd of 1.</span>
<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>) %&gt;%<span class="st"> </span><span class="kw">mean</span>()</code></pre></div>
<pre><code>## [1] 5.107867</code></pre>
<p>As you can see, on the lefthand side of the pipe <code>%&gt;%</code>, we have a function that create a vector of 20 values (sampled from a normal distribution, with a mean of 5 and an sd of 1). On the righthand side, we simply have the function mean(), which calculates the mean of a vector of values. And so what’s happening, is first the function on the righthand side creates a vector; the output of this function is simply the vector of values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>##  [1] 4.497808 5.131531 4.921083 5.886785 5.116971 5.318630 4.418209
##  [8] 5.714533 4.174741 4.640138 5.089886 5.096274 4.798366 5.739840
## [15] 5.123380 4.970683 4.611146 5.510856 4.086186 7.310297</code></pre>
<p>So the output of this fucntion, the vector of 20 values, is then passed along to the mean function. The mean function requires a vector of values for its first argument (see for yourself by running <code>?mean</code>). So, we end the pipe with simply <code>mean()</code>, and this provides the mean.</p>
</div>
<div id="a-quick-tip-about-style" class="section level4">
<h4><span class="header-section-number">5.4.2.3</span> A quick tip about style</h4>
<p>It’s typically considered good practice to not have more than one pipe per line. So what I have above is considered bad coding style. So instead of</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>) %&gt;%<span class="st"> </span><span class="kw">mean</span>()</code></pre></div>
<pre><code>## [1] 5.107867</code></pre>
<p>You should instead do this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>) %&gt;%
<span class="st">  </span><span class="kw">mean</span>()</code></pre></div>
<pre><code>## [1] 5.107867</code></pre>
</div>
<div id="logic-of-piping-syntax-continued" class="section level4">
<h4><span class="header-section-number">5.4.2.4</span> Logic of Piping Syntax continued</h4>
<p>As we covered above, the function following the pipe takes the output of the preceding function as its <strong>first</strong> argument. In the preceding example, we didn’t supply another argument, and so the righthand side of the pipe was simply <code>mean()</code>. Let’s say, we wanted to specify an additional argument. One option in <code>mean()</code> is trim, which indicates the proportion of values we want to trim from the vector before calculating the mean. Let’s say we wanted only half the data points; I have no idea why someone would do something like this, especially with a vector of 20 values, but let’s do it anyway.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="co"># This is the same as before</span>
<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>) %&gt;%
<span class="co"># Notice that the mean() function now contains the argument trim = 0.5</span>
<span class="st">    </span><span class="kw">mean</span>(<span class="dt">trim =</span> <span class="fl">0.5</span>)</code></pre></div>
<pre><code>## [1] 5.09308</code></pre>
<p>You’ll see we got a slightly different value; a value a little closer to the population mean of 5, since 50% of the values in the tails were removed from the vectore before calculating the mean.</p>
<p>This can be pretty confusing when you’re new to piping, because our <code>mean()</code> function is basically missing an argument, namely, the argument with the name of the vector of values. Importantly, the argument isn’t missing, it’s just sort of hidden under the hood. The <code>mean()</code> line above, to R, is actually looking something like this: <code>mean(vector_output_above, trim = 0.5)</code>, it’s just that the first argument is hidden from view. We could do this in two steps, without pipes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="co"># we could create the vectore, and save it as an object</span>
vector_from_pipe &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>)
<span class="co"># and then take the mean</span>
<span class="kw">mean</span>(vector_from_pipe, <span class="dt">trim =</span> .<span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 5.09308</code></pre>
<p>And we get the same trimmed mean. We could also do this with one step:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="dt">trim =</span> .<span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] 5.09308</code></pre>
<p>And we can see that we get the same result. Some of you may have noticed that we have three different routes to the same destination. So why use pipes?</p>
</div>
</div>
<div id="why-use-pipes" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Why use pipes?</h3>
<p>There are probably lots of reasons to use or not use pipes. The most important and most often mentioned reasons to use pipes are <em>cleanliness</em> (which I hear is next to <em>godliness</em>) and efficiency. We can think of three related advantages:</p>
<ol style="list-style-type: decimal">
<li>Cleaner code
<ul>
<li>This is nice, because it helps make your code more readable by other humans.</li>
<li>Other humans include your future self, who may return to a code file 6 months or a year later, and want to know wtf the code is doing.</li>
</ul></li>
<li>Cleaner environment
<ul>
<li>When you use pipes, you have basically no reason to save objects from intermediary steps in your data wrangling / analysis workflow, because you can just pass output from function to function without saving it (recall when we broke apart the pipe into two steps above).</li>
</ul></li>
<li>Efficiency
<ul>
<li>This is efficiency for you, the person doing the coding (not more efficient computing)</li>
<li>This advantage primarily comes from the fact that withhout pipes, you have to save objects from intermediary steps. This can create ineffencies and/or errors:
<ul>
<li>Inefficiences stem from having to keep coming up with names for objects from intermediary steps.</li>
<li>errors can crop up from re-using names (to be more efficient), which can easily lead to calling the wrong object in an analysis or over-writing one that you need later.</li>
</ul></li>
</ul></li>
</ol>
<div id="cleaner-code" class="section level4">
<h4><span class="header-section-number">5.4.3.1</span> Cleaner code</h4>
<p>With pipes, its often easier to make code that is cleaner, and easier for other humans to read. The last part is important, because R doesnt care if your code is clean (as long as its syntactically correct), but clean code is easier for your collaborators (including future you) to understand.</p>
<p>Why do pipes make cleaner code? An example may help with this. Compare this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)

<span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="dt">trim =</span> .<span class="dv">5</span>)</code></pre></div>
<p>to this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)

<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>) %&gt;%
<span class="st">    </span><span class="kw">mean</span>(<span class="dt">trim =</span> <span class="fl">0.5</span>)</code></pre></div>
<p>The second, piped, example is a little easier to parse. One reason is it more closely matches the way we tend to think about analysis. In the former example, we’re saying take a mean, and what I want you to take a mean of is this vector, and this is how I want you to make this vector (random sample from a normal dist, etc.). In the latter, we’re saying make a vector like this (random sample, etc.), and then take its mean. I find the latter is more similar to the way I think about the steps in an analysis.</p>
</div>
<div id="a-cleaner-environment" class="section level4">
<h4><span class="header-section-number">5.4.3.2</span> A cleaner environment</h4>
<p>This is a smaller and less important advantage, but an advantage none the less. Not having to save objects from intermediary steps means less stuff crowding up you environment. Now, you don’t have to save those intermediary steps, but doing so will often make cleaner code. Pipes maximize cleanliness of both your code and environment, so with pipes you don’t have to make this trade-off. Recall this example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
<span class="co"># we could create the vectore, and save it as an object</span>
vector_from_pipe &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>)
<span class="co"># and then take the mean</span>
<span class="kw">mean</span>(vector_from_pipe, <span class="dt">trim =</span> .<span class="dv">5</span>)</code></pre></div>
<p>We saved the vector me made with <code>rnorm()</code> so that we could pass that vector to the <code>mean</code> function. Now this code is a little easier to read than this code, that doesn’t save the object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="dt">trim =</span> .<span class="dv">5</span>)</code></pre></div>
<p>So the first chunk is easier to read, but clutters our environment, while the second chunk is harder to read but creates less clutter. Which is better? Who know. Pipes avoid making this tough decision, by making cleaner code that doesn’t clutter up our environment:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">5</span>, <span class="dt">sd =</span> <span class="dv">1</span>) %&gt;%
<span class="st">  </span><span class="kw">mean</span>()</code></pre></div>
<p>You may be wondering why a cluttered environment matters. The main thing is that it can create ineffeciencies in two ways: 1. sometimes you want to quickly glance over to your environment window to get some information (like what you named that dataset); this is obviously harder in a busier visual environment. 2. You can hit tab to autocomplete; the more objects with similar names you have, the less efficient autocomplete is.</p>
</div>
<div id="efficiency" class="section level4">
<h4><span class="header-section-number">5.4.3.3</span> Efficiency</h4>
<p>This one is pretty straight forward. By not having to save objects from intermediary steps, we have to come up with less names and remember less names. Coming up with names is hard; remembering what names correspond to what is harder. Both of these things will slow you down.</p>
<p>For example, we had to name the vector when we saved it in the above example; this added about 2 seconds to my work in preparing this code. Say we needed a new vector, that was the log transformed values of the previous vetor. We might name that <code>log_vector_from_pipe</code>; this probably added another 2 seconds. Now obviously, these are small additions of time, but they add up. Plus, sometimes coming up with unique names gets tough (when you’re on the 5th or 6th or 10th vector that you have to name)</p>
</div>
<div id="a-note-about-scaling" class="section level4">
<h4><span class="header-section-number">5.4.3.4</span> A note about Scaling</h4>
<p>One more thing to keep in mind is that gains in cleanliness and efficiency scale with the complexity of what you’re doing. Let’s say, we had a dataset that we wanted to take a subset of cases/rows from (those where age is &gt; 25), and just a couple of just a couple of columns (a, b, c, d), then we wanted to log transform that data, and then wanted to get descriptives for all of the remaining variables.</p>
<p>Without pipes, you’ll either end up with some difficult to read code:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(psych)
<span class="kw">describe</span>(<span class="kw">log</span>(<span class="kw">select</span>(<span class="kw">filter</span>(data, age &gt;<span class="st"> </span><span class="dv">5</span>), a, b, c, d)))</code></pre></div>
<p>or some throwaway objects:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span> (psych)
data_subset_age &lt;-<span class="st"> </span><span class="kw">filter</span>(data, age &gt;<span class="st"> </span><span class="dv">5</span>)
data_subset_age_abcd &lt;-<span class="st"> </span><span class="kw">select</span>(data_subset_age, a, b, c, d)
log_data_subset_age_abcd &lt;-<span class="st"> </span><span class="kw">log</span>(data_subset_age_abcd)
<span class="kw">describe</span>(log_data_subset_age_abcd)</code></pre></div>
<p>With pipes, we can avoid these issues:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data %&gt;%
<span class="st">  </span><span class="kw">filter</span>(age &gt;<span class="st"> </span><span class="dv">25</span>) %&gt;%
<span class="st">  </span><span class="kw">select</span>(a, b, c, d) %&gt;%
<span class="st">  </span><span class="kw">describe</span>()</code></pre></div>
<p>See, so much easier to read, and not flooding our enviornment with clutter and not taxing our already taxed minds with having to come up with a bunch of damn names.</p>
</div>
</div>
<div id="saving-the-output-of-your-pipe" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Saving the output of your pipe</h3>
<p>So far, we’ve been runing with example where we just ran functions in pipes without saving the output. Sometimes this is useful, like if we just wanted to see the descriptives in the above example (and didn’t want to do anything else with those descriptives). But, often we want to take the output from the pipe and save it to an object so we can do analyses with it later. For example, instead of just getting descriptives, maybe we want a dataset that has only people above 25 and columns a, b, c, d to use in analyses. We just add the assignment and object name at the top, like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">age25plus_abcd &lt;-<span class="st"> </span>data %&gt;%
<span class="st">  </span><span class="kw">filter</span>(age &gt;<span class="st"> </span><span class="dv">25</span>) %&gt;%
<span class="st">  </span><span class="kw">select</span>(a, b, c, d)</code></pre></div>
</div>
</div>
<div id="reshaping-data" class="section level2">
<h2><span class="header-section-number">5.5</span> Reshaping Data</h2>
<p>At the start of the data manipulation section, we talked about long vs wide data. Now let’s talk about how to actually lengthen or widen or data. We’ll use the same dataset we made up for the starting example: 4 year longitudinal study where the Big Five were measured annually.</p>
<div id="wide-to-long" class="section level3">
<h3><span class="header-section-number">5.5.1</span> Wide to Long</h3>
<p>We’ll start with lengthening our data. We currently have our data in a wide format that looks something like this for now:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_wide</code></pre></div>
<pre><code>## # A tibble: 100 x 21
##      pid agreeableness_t1 conscientiousness_t1 neuroticism_t1
##    &lt;dbl&gt;            &lt;dbl&gt;                &lt;dbl&gt;          &lt;dbl&gt;
##  1     1         3.272170             2.910066       1.930431
##  2     2         4.437896             5.077282       3.426696
##  3     3         2.637504             1.142518       3.235054
##  4     4         3.565533             3.592956       4.294807
##  5     5         3.420215             1.192690       3.625460
##  6     6         3.055457             2.939600       2.746538
##  7     7         3.601571             4.568350       3.656175
##  8     8         2.721202             2.324931       3.278157
##  9     9         2.235776             3.469522       2.424450
## 10    10         4.018627             2.210176       4.517837
## # ... with 90 more rows, and 17 more variables: extraversion_t1 &lt;dbl&gt;,
## #   openness_t1 &lt;dbl&gt;, agreeableness_t2 &lt;dbl&gt;, conscientiousness_t2 &lt;dbl&gt;,
## #   neuroticism_t2 &lt;dbl&gt;, extraversion_t2 &lt;dbl&gt;, openness_t2 &lt;dbl&gt;,
## #   agreeableness_t3 &lt;dbl&gt;, conscientiousness_t3 &lt;dbl&gt;,
## #   neuroticism_t3 &lt;dbl&gt;, extraversion_t3 &lt;dbl&gt;, openness_t3 &lt;dbl&gt;,
## #   agreeableness_t4 &lt;dbl&gt;, conscientiousness_t4 &lt;dbl&gt;,
## #   neuroticism_t4 &lt;dbl&gt;, extraversion_t4 &lt;dbl&gt;, openness_t4 &lt;dbl&gt;</code></pre>
<p>And say we want it to lengthen it to look like this:</p>
<pre><code>## # A tibble: 400 x 7
##      pid  time agreeableness conscientiousness extraversion neuroticism
##  * &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1     1    t1      3.272170          2.910066   4.05151416    1.930431
##  2     1    t2      3.908980          3.155975   4.72821482    2.274380
##  3     1    t3      4.630217          3.651040   5.24490921    2.861416
##  4     1    t4      4.879904          4.169724   5.65135039    2.935181
##  5     2    t1      4.437896          5.077282   3.03995468    3.426696
##  6     2    t2      5.069580          4.948804   3.36266652    3.975431
##  7     2    t3      5.269524          5.410024   3.66931986    4.769191
##  8     2    t4      5.648835          5.568569   4.25892682    5.559122
##  9     3    t1      2.637504          1.142518   0.06342994    3.235054
## 10     3    t2      2.866149          1.671569   0.82641445    3.782311
## # ... with 390 more rows, and 1 more variables: openness &lt;dbl&gt;</code></pre>
<p>We can use a function called <code>gather()</code> from the <em>tidyr</em> package (another package in the tidyverse). <code>gather()</code> requires at least three arguments:</p>
<ul>
<li>data
<ul>
<li>This one is easy. It is the dataset that we want to lengthen</li>
</ul></li>
<li>key
<ul>
<li>This is the name for the new variable (or new column) that will contain the information that was previously in the column names. In most cases, it will be the name for the new variable that contains the name for what used to be variables.</li>
<li>In our example, this column will contain the variables agreeableness_t1, conscientiousness_t1, etc.</li>
<li>You can give any name you want here.</li>
</ul></li>
<li>value
<ul>
<li>this is the name of the new variable (or new column) that will contain the scores that used to be spread out across different columns.</li>
</ul></li>
</ul>
<p>And that’s all that is required.</p>
<p>The most important remaining part of this syntax is the columns that you want to <em>gather</em>, or the variables that you want to become key-value pairs. Another way to put this is which columns do you want to become rows (lengthening the data)?</p>
<p>If you don’t name any columns, it will select all of them. The syntax for this part works similarly to <code>select()</code>. You can name a series of variables, like <code>agreeableness_t1:openness_t4</code> , or name each column individually separated by a comma <code>agreeabeleness_t1, conscientiousness, ..., openness_t4</code>, or you can say which columns you <em>do not</em> want with a minus sign in front of the column name. Since we want to include all of our columns except participant id (<code>pid</code>), we’ll use the minus sign to tell <code>gather()</code> include everything but <code>pid</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_wide %&gt;%
<span class="st">  </span><span class="kw">gather</span>(variable, score, -pid)</code></pre></div>
<pre><code>## # A tibble: 2,000 x 3
##      pid         variable    score
##    &lt;dbl&gt;            &lt;chr&gt;    &lt;dbl&gt;
##  1     1 agreeableness_t1 3.272170
##  2     2 agreeableness_t1 4.437896
##  3     3 agreeableness_t1 2.637504
##  4     4 agreeableness_t1 3.565533
##  5     5 agreeableness_t1 3.420215
##  6     6 agreeableness_t1 3.055457
##  7     7 agreeableness_t1 3.601571
##  8     8 agreeableness_t1 2.721202
##  9     9 agreeableness_t1 2.235776
## 10    10 agreeableness_t1 4.018627
## # ... with 1,990 more rows</code></pre>
<p>Okay, so this brings us to our first issue when trying to lengthen a dataset. The key column (what we called variable) contains the trait that was measured and the time point. That is, this column contains 2 pieces of information that we probably want kept separately. We want these to be in separate columns, so that we can select certain traits or time points, or model slopes across time points.</p>
<p>Thankfully, the authors of tidyr anticipated this problem, and created a useful function called <code>separate()</code>, which basically takes data within a single column, and splits it into multiple columns. Let’s add that into the pipeline on the variable column. We’re going to throw a pipe on the end of gather into separate. This will put the dataset above as the first argument in the separate function. We then tell it the columns we want to separate (variable in this case) and provide it the names of the new columns, which we’ll call trait and time, for Big Five trait and time point.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_wide %&gt;%
<span class="st">  </span><span class="kw">gather</span>(variable, score, -pid) %&gt;%
<span class="st">  </span><span class="kw">separate</span>(variable, <span class="kw">c</span>(<span class="st">&quot;trait&quot;</span>, <span class="st">&quot;time&quot;</span>))</code></pre></div>
<pre><code>## # A tibble: 2,000 x 4
##      pid         trait  time    score
##  * &lt;dbl&gt;         &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1     1 agreeableness    t1 3.272170
##  2     2 agreeableness    t1 4.437896
##  3     3 agreeableness    t1 2.637504
##  4     4 agreeableness    t1 3.565533
##  5     5 agreeableness    t1 3.420215
##  6     6 agreeableness    t1 3.055457
##  7     7 agreeableness    t1 3.601571
##  8     8 agreeableness    t1 2.721202
##  9     9 agreeableness    t1 2.235776
## 10    10 agreeableness    t1 4.018627
## # ... with 1,990 more rows</code></pre>
<p>You’ll notice we didn’t tell separate anything other than the column we wanted separated (<code>variable</code>) and the name of two new columns (<code>trait</code> and <code>time</code>). How did it know how to separate that column?</p>
<p>Well, basically, separate looks for something called <em>regular expressions</em>. We’ll get into more detail about regular expressions later on, but one regular expression is the underscore for separating things. So it recognized that every string in the variable column contained a underscore. Then, it put the character string on the left hand side of the underscore into the first column name we gave it (trait) and put the character string on the right hand side of the underscore into the second column name we gave it (time). If we wanted to be more explicit, we could specify the <code>sep=</code> argument like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We&#39;re going to save this to an object called sample_b5_data_long</span>
sample_b5_data_long&lt;-<span class="st"> </span>sample_b5_data_wide %&gt;%
<span class="st">  </span><span class="kw">gather</span>(variable, score, -pid) %&gt;%
<span class="st">  </span><span class="kw">separate</span>(variable, <span class="kw">c</span>(<span class="st">&quot;trait&quot;</span>, <span class="st">&quot;time&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)
sample_b5_data_long</code></pre></div>
<pre><code>## # A tibble: 2,000 x 4
##      pid         trait  time    score
##  * &lt;dbl&gt;         &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;
##  1     1 agreeableness    t1 3.272170
##  2     2 agreeableness    t1 4.437896
##  3     3 agreeableness    t1 2.637504
##  4     4 agreeableness    t1 3.565533
##  5     5 agreeableness    t1 3.420215
##  6     6 agreeableness    t1 3.055457
##  7     7 agreeableness    t1 3.601571
##  8     8 agreeableness    t1 2.721202
##  9     9 agreeableness    t1 2.235776
## 10    10 agreeableness    t1 4.018627
## # ... with 1,990 more rows</code></pre>
<p>See, that did the same thing. Now, let’s save this long data, and see what we have to do to get it wide again.</p>
</div>
<div id="long-to-wide" class="section level3">
<h3><span class="header-section-number">5.5.2</span> Long to wide</h3>
<p>I will say, that my one mild frustration with <code>tidyr()</code>, with all due respect, is that it seems to be optimized to getting data into long format. I take it, from reading R for Data Science &lt;r4ds.had.co.nz&gt; , that Hadley Wickham and company prefer long data (my sense is that they consider data <em>tidy</em> when its in its longest format, though perhaps I misread).</p>
<p>Long data is great and all, but sometimes we need wide data. Specifically, we need wide data for <strong>SEM</strong> and <strong>Path Analysis</strong>, which we use pretty regularly in psychology.</p>
<p>All of that said, you can use <code>spread()</code> from tidyr to widen your data. There is also the <code>reshape()</code> function from base R, which I sometimes find makes widening data a little easier than <code>spread()</code>. Let’s go over each in turn.</p>
<div id="spread" class="section level4">
<h4><span class="header-section-number">5.5.2.1</span> Spread</h4>
<p>Spread is part of the <code>tidyr()</code> package, and is the function from that package for reshaping data from long to wide format. It’s syntactically pretty similar to <code>spread()</code> making it pretty easy to go between the two, which is nice. Spread requires 3 arguments, which you’ll see mirror gather:</p>
<ul>
<li>Data
<ul>
<li>The data that you want to widen</li>
</ul></li>
<li>key
<ul>
<li>The column that contains the values that you want to be columns. This would be either the variable or time column from our above example dataset.</li>
</ul></li>
<li>value
<ul>
<li>The column that contains the values you want to fill the cells beneath the new columns with. This would be the score column from above.</li>
</ul></li>
</ul>
<p>Let’s say we’re starting with our data in a long format like the one above, and we wanted to get it to a wide format, like the one we started with (where each row was a participant, and each column was a trait at a particular time, like <code>agreeableness_t1</code>). We might start with this</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_long2 &lt;-<span class="st"> </span>sample_b5_data_long %&gt;%
<span class="st">  </span><span class="kw">spread</span>(trait, score)

sample_b5_data_long2 </code></pre></div>
<pre><code>## # A tibble: 400 x 7
##      pid  time agreeableness conscientiousness extraversion neuroticism
##  * &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1     1    t1      3.272170          2.910066   4.05151416    1.930431
##  2     1    t2      3.908980          3.155975   4.72821482    2.274380
##  3     1    t3      4.630217          3.651040   5.24490921    2.861416
##  4     1    t4      4.879904          4.169724   5.65135039    2.935181
##  5     2    t1      4.437896          5.077282   3.03995468    3.426696
##  6     2    t2      5.069580          4.948804   3.36266652    3.975431
##  7     2    t3      5.269524          5.410024   3.66931986    4.769191
##  8     2    t4      5.648835          5.568569   4.25892682    5.559122
##  9     3    t1      2.637504          1.142518   0.06342994    3.235054
## 10     3    t2      2.866149          1.671569   0.82641445    3.782311
## # ... with 390 more rows, and 1 more variables: openness &lt;dbl&gt;</code></pre>
<p>Okay, that got us about halfway there. We now have a separate column for each trait, but time is still row-wise. Maybe we could try spreading time, but what would be the value column? We currently have 5. Let’s try passing it all of them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_long %&gt;%
<span class="st">  </span><span class="kw">spread</span>(time, score) %&gt;%
<span class="st">  </span><span class="kw">spread</span>(trait, agreeableness:openness) <span class="co"># note that if you pass it a vector of names like c(&quot;agreeableness&quot;, etc.) it also won&#39;t work</span></code></pre></div>
<p>We can’t do that; we can only give exactly <strong>one</strong> column for the value argument in spread. Herein lies my frustration with spread. Now there is a workaround.</p>
<p>If you’re data is in the longer format from above (where each row was a participant X trait X time combo), then you can first use <code>unite()</code> (the complement to separate). <code>unite()</code> requires an argument for data and the column name you want it to add (once it unites the columns you tell it to unite). You’ll probably also want to name specific columns, which can be done just like other tidyr functions, by listing their unquoted names (or if you have a range of columns, you can use column_name_at_start_of_range:column_name_at_end_of_range).</p>
<p>So, we’ll add in a unite before we get to spread, and see if that fixes it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_long %&gt;%
<span class="st">  </span><span class="kw">unite</span>(variable, trait, time) %&gt;%
<span class="st">  </span><span class="kw">spread</span>(variable, score)</code></pre></div>
<pre><code>## # A tibble: 100 x 21
##      pid agreeableness_t1 agreeableness_t2 agreeableness_t3
##  * &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1     1         3.272170         3.908980         4.630217
##  2     2         4.437896         5.069580         5.269524
##  3     3         2.637504         2.866149         3.128495
##  4     4         3.565533         4.177458         4.271881
##  5     5         3.420215         3.820150         4.393501
##  6     6         3.055457         3.747260         4.227234
##  7     7         3.601571         4.371170         4.811993
##  8     8         2.721202         3.031440         3.471654
##  9     9         2.235776         2.799455         3.149776
## 10    10         4.018627         4.818018         5.552746
## # ... with 90 more rows, and 17 more variables: agreeableness_t4 &lt;dbl&gt;,
## #   conscientiousness_t1 &lt;dbl&gt;, conscientiousness_t2 &lt;dbl&gt;,
## #   conscientiousness_t3 &lt;dbl&gt;, conscientiousness_t4 &lt;dbl&gt;,
## #   extraversion_t1 &lt;dbl&gt;, extraversion_t2 &lt;dbl&gt;, extraversion_t3 &lt;dbl&gt;,
## #   extraversion_t4 &lt;dbl&gt;, neuroticism_t1 &lt;dbl&gt;, neuroticism_t2 &lt;dbl&gt;,
## #   neuroticism_t3 &lt;dbl&gt;, neuroticism_t4 &lt;dbl&gt;, openness_t1 &lt;dbl&gt;,
## #   openness_t2 &lt;dbl&gt;, openness_t3 &lt;dbl&gt;, openness_t4 &lt;dbl&gt;</code></pre>
<p>Okay, that got our data into the right format. So, spread isn’t <em>that</em> bad, but you typically need to start with data in (just about) the longest format possible, and to use <code>unite()</code> function as well.</p>
<p>But, sometimes our data are in between the longest format possible and the wide format that we want. Sometimes we get data like we accidentally got above, where each row is a participant X time point and each column is trait. Like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_long2</code></pre></div>
<pre><code>## # A tibble: 400 x 7
##      pid  time agreeableness conscientiousness extraversion neuroticism
##  * &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1     1    t1      3.272170          2.910066   4.05151416    1.930431
##  2     1    t2      3.908980          3.155975   4.72821482    2.274380
##  3     1    t3      4.630217          3.651040   5.24490921    2.861416
##  4     1    t4      4.879904          4.169724   5.65135039    2.935181
##  5     2    t1      4.437896          5.077282   3.03995468    3.426696
##  6     2    t2      5.069580          4.948804   3.36266652    3.975431
##  7     2    t3      5.269524          5.410024   3.66931986    4.769191
##  8     2    t4      5.648835          5.568569   4.25892682    5.559122
##  9     3    t1      2.637504          1.142518   0.06342994    3.235054
## 10     3    t2      2.866149          1.671569   0.82641445    3.782311
## # ... with 390 more rows, and 1 more variables: openness &lt;dbl&gt;</code></pre>
<p>What do we do here? Well, if we want to use gather, we’ll have to first lengthen the data, and unite the columns that we need to unite, and then spread. So it will something like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_long2 %&gt;%
<span class="st">  </span><span class="co"># first gather (you&#39;ll have to remember to not gather pid AND time)</span>
<span class="st">  </span><span class="kw">gather</span>(trait, score, -pid, -time) %&gt;%
<span class="st">  </span><span class="co"># Then unite trait and time into a column called variable</span>
<span class="st">  </span><span class="kw">unite</span>(variable, trait, time) %&gt;%
<span class="st">  </span><span class="co"># then spread it</span>
<span class="st">  </span><span class="kw">spread</span>(variable, score)</code></pre></div>
<pre><code>## # A tibble: 100 x 21
##      pid agreeableness_t1 agreeableness_t2 agreeableness_t3
##  * &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;
##  1     1         3.272170         3.908980         4.630217
##  2     2         4.437896         5.069580         5.269524
##  3     3         2.637504         2.866149         3.128495
##  4     4         3.565533         4.177458         4.271881
##  5     5         3.420215         3.820150         4.393501
##  6     6         3.055457         3.747260         4.227234
##  7     7         3.601571         4.371170         4.811993
##  8     8         2.721202         3.031440         3.471654
##  9     9         2.235776         2.799455         3.149776
## 10    10         4.018627         4.818018         5.552746
## # ... with 90 more rows, and 17 more variables: agreeableness_t4 &lt;dbl&gt;,
## #   conscientiousness_t1 &lt;dbl&gt;, conscientiousness_t2 &lt;dbl&gt;,
## #   conscientiousness_t3 &lt;dbl&gt;, conscientiousness_t4 &lt;dbl&gt;,
## #   extraversion_t1 &lt;dbl&gt;, extraversion_t2 &lt;dbl&gt;, extraversion_t3 &lt;dbl&gt;,
## #   extraversion_t4 &lt;dbl&gt;, neuroticism_t1 &lt;dbl&gt;, neuroticism_t2 &lt;dbl&gt;,
## #   neuroticism_t3 &lt;dbl&gt;, neuroticism_t4 &lt;dbl&gt;, openness_t1 &lt;dbl&gt;,
## #   openness_t2 &lt;dbl&gt;, openness_t3 &lt;dbl&gt;, openness_t4 &lt;dbl&gt;</code></pre>
<p>So that isn’t sooooo bad. But, it can be a little cumbersome, because you’re using several different functions together. So to do this right, you have to remember a pretty complex sequence (or look it up each time). Plus, when your data is more complicated than this data (which was intentionally made pretty simple), it becomes pretty easy to make a mistake in one of these steps (not remembering which columns not to gather in step 2 above, remembering to unite the right columns, etc.). So, <code>reshape()</code> from base R is sometimes a little easier in these cases. Let’s talk about that now.</p>
</div>
<div id="using-reshape-long-to-wide" class="section level4">
<h4><span class="header-section-number">5.5.2.2</span> Using reshape(): long to wide</h4>
<p>In general, <code>reshape()</code> is a little more complicated. It has more arguments, and more of the arguments are required. But, like I said, it is sometimes a little easier for widening data than <code>spread()</code>. One thing to keep in mind is, unlike <code>spread()</code> and <code>gather()</code>, <code>reshape()</code> is used for widening or lengthening data, and you have to specify the direction in the function.</p>
<p>Let’s say our data look like the intermediate data we’ve used before. I mean this data shape:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_long2</code></pre></div>
<pre><code>## # A tibble: 400 x 7
##      pid  time agreeableness conscientiousness extraversion neuroticism
##  * &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1     1    t1      3.272170          2.910066   4.05151416    1.930431
##  2     1    t2      3.908980          3.155975   4.72821482    2.274380
##  3     1    t3      4.630217          3.651040   5.24490921    2.861416
##  4     1    t4      4.879904          4.169724   5.65135039    2.935181
##  5     2    t1      4.437896          5.077282   3.03995468    3.426696
##  6     2    t2      5.069580          4.948804   3.36266652    3.975431
##  7     2    t3      5.269524          5.410024   3.66931986    4.769191
##  8     2    t4      5.648835          5.568569   4.25892682    5.559122
##  9     3    t1      2.637504          1.142518   0.06342994    3.235054
## 10     3    t2      2.866149          1.671569   0.82641445    3.782311
## # ... with 390 more rows, and 1 more variables: openness &lt;dbl&gt;</code></pre>
<p>And we wanted it to look like our dataset above, where each row is a unique participant. We could use reshape like so</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">reshape</span>(sample_b5_data_long2,
        <span class="co"># This one is straight forward; just the column with participant id&#39;s</span>
        <span class="dt">idvar =</span> <span class="st">&quot;pid&quot;</span>,
        <span class="co"># This won&#39;t always be time. timevar is the variable you want to move from rows into column names.</span>
        <span class="co"># It&#39;s equivalen to key in the spread() function</span>
        <span class="dt">timevar =</span> <span class="st">&quot;time&quot;</span>,
        <span class="co"># Gotta tell it what direction to go.</span>
        <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span>,
        <span class="co"># Note, this is fully optional, but the defailt is &quot;.&quot;, and I wanted it to look like the above, with a &quot;_&quot;</span>
        <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)</code></pre></div>
<pre><code>## # A tibble: 100 x 6
##      pid `agreeableness_c(&quot;t1&quot;, &quot;t2&quot;, &quot;t3&quot;, &quot;t4&quot;)`
##    &lt;dbl&gt;                                     &lt;dbl&gt;
##  1     1                                        NA
##  2     2                                        NA
##  3     3                                        NA
##  4     4                                        NA
##  5     5                                        NA
##  6     6                                        NA
##  7     7                                        NA
##  8     8                                        NA
##  9     9                                        NA
## 10    10                                        NA
## # ... with 90 more rows, and 4 more variables: `conscientiousness_c(&quot;t1&quot;,
## #   &quot;t2&quot;, &quot;t3&quot;, &quot;t4&quot;)` &lt;dbl&gt;, `extraversion_c(&quot;t1&quot;, &quot;t2&quot;, &quot;t3&quot;,
## #   &quot;t4&quot;)` &lt;dbl&gt;, `neuroticism_c(&quot;t1&quot;, &quot;t2&quot;, &quot;t3&quot;, &quot;t4&quot;)` &lt;dbl&gt;,
## #   `openness_c(&quot;t1&quot;, &quot;t2&quot;, &quot;t3&quot;, &quot;t4&quot;)` &lt;dbl&gt;</code></pre>
<p>Holy sh**, what happened!?!?! What did I do</p>
<p>This brings us to what has got to be the most common mistake made with <code>reshape()</code> in modern times (post tidyverse times, that is). The reason we got that hot mess above is beecause reshape <em>only</em> works with data.frames <strong>NOT</strong> tibbles. Now our data set <code>sample_b5_data_long2</code> is probably a tibble. Let’s check that out with the structure function <code>str()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(sample_b5_data_long2)</code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    400 obs. of  7 variables:
##  $ pid              : num  1 1 1 1 2 2 2 2 3 3 ...
##  $ time             : chr  &quot;t1&quot; &quot;t2&quot; &quot;t3&quot; &quot;t4&quot; ...
##  $ agreeableness    : num  3.27 3.91 4.63 4.88 4.44 ...
##  $ conscientiousness: num  2.91 3.16 3.65 4.17 5.08 ...
##  $ extraversion     : num  4.05 4.73 5.24 5.65 3.04 ...
##  $ neuroticism      : num  1.93 2.27 2.86 2.94 3.43 ...
##  $ openness         : num  5.32 5.86 6.53 7.17 5.07 ...</code></pre>
<p>Yep, it looks like it’s class is tbl_df, tbl, and data.frame, which means its a tibble. Thankfully, this is an easy fix, you just need to turn the tibble into a data.frame with <code>as.data.frame()</code>. So let’s add that into the pipeline.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_long2 %&gt;%
<span class="st">  </span><span class="kw">as.data.frame</span>() %&gt;%
<span class="st">  </span><span class="co"># Note, because we&#39;re piping things, we start with &#39;idvar=&#39; instead of the name of the data</span>
<span class="st">  </span><span class="kw">reshape</span>(<span class="dt">idvar =</span> <span class="st">&quot;pid&quot;</span>,
          <span class="dt">timevar =</span> <span class="st">&quot;time&quot;</span>,
          <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span>,
          <span class="co"># Note, this is fully optional, but the defailt is &quot;.&quot;, and I wanted it to look like the above, with a &quot;_&quot;</span>
          <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>) %&gt;%
<span class="st">  </span><span class="co"># Turning it back into a tibble, because they print a little nicer</span>
<span class="st">  </span><span class="kw">as_tibble</span>()</code></pre></div>
<pre><code>## # A tibble: 100 x 21
##      pid agreeableness_t1 conscientiousness_t1 extraversion_t1
##  * &lt;dbl&gt;            &lt;dbl&gt;                &lt;dbl&gt;           &lt;dbl&gt;
##  1     1         3.272170             2.910066      4.05151416
##  2     2         4.437896             5.077282      3.03995468
##  3     3         2.637504             1.142518      0.06342994
##  4     4         3.565533             3.592956      3.38212519
##  5     5         3.420215             1.192690      3.18794360
##  6     6         3.055457             2.939600      3.92343116
##  7     7         3.601571             4.568350      4.59795403
##  8     8         2.721202             2.324931      2.92162762
##  9     9         2.235776             3.469522      0.63861271
## 10    10         4.018627             2.210176      3.40134279
## # ... with 90 more rows, and 17 more variables: neuroticism_t1 &lt;dbl&gt;,
## #   openness_t1 &lt;dbl&gt;, agreeableness_t2 &lt;dbl&gt;, conscientiousness_t2 &lt;dbl&gt;,
## #   extraversion_t2 &lt;dbl&gt;, neuroticism_t2 &lt;dbl&gt;, openness_t2 &lt;dbl&gt;,
## #   agreeableness_t3 &lt;dbl&gt;, conscientiousness_t3 &lt;dbl&gt;,
## #   extraversion_t3 &lt;dbl&gt;, neuroticism_t3 &lt;dbl&gt;, openness_t3 &lt;dbl&gt;,
## #   agreeableness_t4 &lt;dbl&gt;, conscientiousness_t4 &lt;dbl&gt;,
## #   extraversion_t4 &lt;dbl&gt;, neuroticism_t4 &lt;dbl&gt;, openness_t4 &lt;dbl&gt;</code></pre>
<p>Whew, it worked! By learning this limitation of <code>reshape()</code>, you’re avoiding a very confusing rabbit hole that I spent almost a full week in!</p>
<p>Side note: tidyverse functions will turn your data into tibbles, so be aware (the one exception is pipes; they don’t do that).</p>
</div>
<div id="using-reshape-wide-to-long" class="section level4">
<h4><span class="header-section-number">5.5.2.3</span> Using reshape(): wide to long</h4>
<p>Now, you can use <code>reshape()</code> to go from wide to long too. I’d recommend using <code>gather()</code> from tidyr for that instead, but for the sake of completeness, this is how it would work:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sample_b5_data_wide %&gt;%
<span class="st">    </span><span class="co">#never forget to make it a data.frame!</span>
<span class="st">    </span><span class="kw">as.data.frame</span>() %&gt;%
<span class="st">    </span><span class="co"># when going from wide to long, you have to tell it the varying variables.</span>
<span class="st">    </span><span class="co"># These are the columns that contain the information you want in rows.</span>
<span class="st">    </span><span class="co"># This is a little confusing, but basically, you give it a list, with vectors for each thing that shares that information.</span>
<span class="st">    </span><span class="co"># So, all the t1 variables go into the same vector</span>
<span class="st">    </span><span class="co"># then, all the t2 variables go into the same vector, etc.</span>
<span class="st">    </span><span class="kw">reshape</span>(<span class="dt">varying =</span> <span class="kw">c</span>(<span class="kw">c</span>(<span class="st">&quot;agreeableness_t1&quot;</span>, <span class="st">&quot;conscientiousness_t1&quot;</span>, <span class="st">&quot;extraversion_t1&quot;</span>, <span class="st">&quot;neuroticism_t1&quot;</span>, <span class="st">&quot;openness_t1&quot;</span>),
                        <span class="kw">c</span>(<span class="st">&quot;agreeableness_t2&quot;</span>, <span class="st">&quot;conscientiousness_t2&quot;</span>, <span class="st">&quot;extraversion_t2&quot;</span>, <span class="st">&quot;neuroticism_t2&quot;</span>, <span class="st">&quot;openness_t2&quot;</span>),
                        <span class="kw">c</span>(<span class="st">&quot;agreeableness_t3&quot;</span>, <span class="st">&quot;conscientiousness_t3&quot;</span>, <span class="st">&quot;extraversion_t3&quot;</span>, <span class="st">&quot;neuroticism_t3&quot;</span>, <span class="st">&quot;openness_t3&quot;</span>),
                        <span class="kw">c</span>(<span class="st">&quot;agreeableness_t4&quot;</span>, <span class="st">&quot;conscientiousness_t4&quot;</span>, <span class="st">&quot;extraversion_t4&quot;</span>, <span class="st">&quot;neuroticism_t4&quot;</span>, <span class="st">&quot;openness_t4&quot;</span>)),
            <span class="co"># sep is really important here, because it tells it where to split the columns</span>
            <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>,
            <span class="co"># and of course, tell it the direction</span>
            <span class="dt">direction =</span> <span class="st">&quot;long&quot;</span>) %&gt;%
<span class="st">    </span><span class="co"># Turning it back into a tibble, because they print a little nicer</span>
<span class="st">    </span><span class="kw">as_tibble</span>()</code></pre></div>
<pre><code>## # A tibble: 400 x 8
##      pid  time agreeableness conscientiousness extraversion neuroticism
##  * &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt;             &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
##  1     1    t1      3.272170          2.910066   4.05151416    1.930431
##  2     2    t1      4.437896          5.077282   3.03995468    3.426696
##  3     3    t1      2.637504          1.142518   0.06342994    3.235054
##  4     4    t1      3.565533          3.592956   3.38212519    4.294807
##  5     5    t1      3.420215          1.192690   3.18794360    3.625460
##  6     6    t1      3.055457          2.939600   3.92343116    2.746538
##  7     7    t1      3.601571          4.568350   4.59795403    3.656175
##  8     8    t1      2.721202          2.324931   2.92162762    3.278157
##  9     9    t1      2.235776          3.469522   0.63861271    2.424450
## 10    10    t1      4.018627          2.210176   3.40134279    4.517837
## # ... with 390 more rows, and 2 more variables: openness &lt;dbl&gt;, id &lt;int&gt;</code></pre>
<p>There, that worked, but it was a little inefficient compared to <code>gather()</code> I think.</p>
</div>
</div>
<div id="final-note-on-reshaping-data" class="section level3">
<h3><span class="header-section-number">5.5.3</span> Final note on reshaping data</h3>
<p>So now you how to reshape your data. Some general tips to keep in mind:</p>
<ul>
<li><code>gather()</code> is great for lengthening data; I would recommend it over <code>reshape()</code> everytime.</li>
<li><code>separate()</code> can be used to separate a column that really contains multiple pieces of information</li>
<li><code>spread()</code> works for getting widening your data, but it can require some in between steps.</li>
<li><code>gather()</code> can be used to combine information kept in two separate columns
<ul>
<li>remember, this is a big one for getting data into wide format with tidyr and <code>spread()</code></li>
</ul></li>
<li><code>reshape()</code> works really well for widening your data; I recommend it over <code>spread()</code> in most cases.
<ul>
<li>the exception being when your dataset is already in a long (and really, the longest reasonable) format.</li>
</ul></li>
<li><code>reshape()</code> can be used to lengthen your data, but it’s syntax is a little wonky</li>
</ul>
</div>
<div id="section" class="section level3">
<h3><span class="header-section-number">5.5.4</span> </h3>
<p>Things left for manipulating</p>
<ul>
<li>Manipulating
<ul>
<li>creating new variables with mutate()</li>
<li>creating summary/aggregate datasets with summarize()
<ul>
<li>combining group_by() with summarize, which is where summarize gets powerful.</li>
</ul></li>
<li>reordering (incl. reordering factor levels, talking abt factors)</li>
<li>combining dataframes (if this makes sense to do/there’s time to do it) (see relational data in r4ds)</li>
</ul></li>
<li>Annoyances
<ul>
<li>dealing with <code>NaN</code>s</li>
<li>typing your data (mainly to cover factors, ordered v. unordered)</li>
</ul></li>
</ul>
</div>
<div id="resources" class="section level3">
<h3><span class="header-section-number">5.5.5</span> Resources</h3>
<ul>
<li>R Data Import/Export Manual: <a href="https://cran.r-project.org/doc/manuals/R-data.pdf" class="uri">https://cran.r-project.org/doc/manuals/R-data.pdf</a></li>
<li><a href="http://zoonek2.free.fr/UNIX/48_R/02.html#6" class="uri">http://zoonek2.free.fr/UNIX/48_R/02.html#6</a></li>
<li><a href="https://www.statmethods.net/interface/io.html" class="uri">https://www.statmethods.net/interface/io.html</a></li>
<li><a href="http://adv-r.had.co.nz/Subsetting.html#applications" class="uri">http://adv-r.had.co.nz/Subsetting.html#applications</a></li>
<li><a href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf</a></li>
</ul>
<pre><code>## [1] TRUE</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre><code>## [1] TRUE</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="objects-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
