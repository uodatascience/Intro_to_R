<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R Guide Index</title>
  <meta name="description" content="R Guide Index">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="R Guide Index" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="<a href="https://github.com/uodatascience/R_Guide" class="uri">https://github.com/uodatascience/R_Guide</a>" />
  
  
  <meta name="github-repo" content="uodatascience/R_Guide" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Guide Index" />
  
  
  

<meta name="author" content="UO Data Science">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data.html">
<link rel="next" href="functions-1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Lessons</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#installing-r-and-r-studio"><i class="fa fa-check"></i><b>2.1</b> Installing R and R Studio</a></li>
<li class="chapter" data-level="2.2" data-path="introduction.html"><a href="introduction.html#how-do-i-r"><i class="fa fa-check"></i><b>2.2</b> How do I R?!</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction.html"><a href="introduction.html#using-rstudio"><i class="fa fa-check"></i><b>2.2.1</b> Using RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction.html"><a href="introduction.html#getting-help"><i class="fa fa-check"></i><b>2.3</b> Getting help</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="what-is-r.html"><a href="what-is-r.html"><i class="fa fa-check"></i><b>3</b> What is R?</a><ul>
<li class="chapter" data-level="3.1" data-path="what-is-r.html"><a href="what-is-r.html#objects"><i class="fa fa-check"></i><b>3.1</b> Objects</a></li>
<li class="chapter" data-level="3.2" data-path="what-is-r.html"><a href="what-is-r.html#functions"><i class="fa fa-check"></i><b>3.2</b> Functions</a></li>
<li class="chapter" data-level="3.3" data-path="what-is-r.html"><a href="what-is-r.html#packages"><i class="fa fa-check"></i><b>3.3</b> Packages</a></li>
<li class="chapter" data-level="3.4" data-path="what-is-r.html"><a href="what-is-r.html#some-useful-basic-syntax"><i class="fa fa-check"></i><b>3.4</b> Some useful basic syntax</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="objects-1.html"><a href="objects-1.html"><i class="fa fa-check"></i><b>4</b> Objects</a><ul>
<li class="chapter" data-level="4.1" data-path="objects-1.html"><a href="objects-1.html#what-are-objects"><i class="fa fa-check"></i><b>4.1</b> What are Objects?</a><ul>
<li class="chapter" data-level="4.1.1" data-path="objects-1.html"><a href="objects-1.html#object-terminology"><i class="fa fa-check"></i><b>4.1.1</b> Object terminology</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="objects-1.html"><a href="objects-1.html#objects-in-r"><i class="fa fa-check"></i><b>4.2</b> Objects in R</a><ul>
<li class="chapter" data-level="4.2.1" data-path="objects-1.html"><a href="objects-1.html#object-systems"><i class="fa fa-check"></i><b>4.2.1</b> Object Systems</a></li>
<li class="chapter" data-level="4.2.2" data-path="objects-1.html"><a href="objects-1.html#attributes"><i class="fa fa-check"></i><b>4.2.2</b> Attributes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="objects-1.html"><a href="objects-1.html#base-types"><i class="fa fa-check"></i><b>4.3</b> Base Types</a><ul>
<li class="chapter" data-level="4.3.1" data-path="objects-1.html"><a href="objects-1.html#vectors"><i class="fa fa-check"></i><b>4.3.1</b> Vectors</a></li>
<li class="chapter" data-level="4.3.2" data-path="objects-1.html"><a href="objects-1.html#matrices-arrays"><i class="fa fa-check"></i><b>4.3.2</b> Matrices &amp; Arrays</a></li>
<li class="chapter" data-level="4.3.3" data-path="objects-1.html"><a href="objects-1.html#data-frames"><i class="fa fa-check"></i><b>4.3.3</b> Data Frames</a></li>
<li class="chapter" data-level="4.3.4" data-path="objects-1.html"><a href="objects-1.html#etc."><i class="fa fa-check"></i><b>4.3.4</b> Etc.</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="objects-1.html"><a href="objects-1.html#s3-objects"><i class="fa fa-check"></i><b>4.4</b> S3 Objects</a><ul>
<li class="chapter" data-level="4.4.1" data-path="objects-1.html"><a href="objects-1.html#example-extending-s3-objects"><i class="fa fa-check"></i><b>4.4.1</b> Example: Extending S3 Objects</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="objects-1.html"><a href="objects-1.html#s4-objects"><i class="fa fa-check"></i><b>4.5</b> S4 Objects</a></li>
<li class="chapter" data-level="4.6" data-path="objects-1.html"><a href="objects-1.html#reference-classes"><i class="fa fa-check"></i><b>4.6</b> Reference Classes</a></li>
<li class="chapter" data-level="4.7" data-path="objects-1.html"><a href="objects-1.html#references"><i class="fa fa-check"></i><b>4.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>5</b> Data</a><ul>
<li class="chapter" data-level="5.1" data-path="data.html"><a href="data.html#loading"><i class="fa fa-check"></i><b>5.1</b> Loading</a><ul>
<li class="chapter" data-level="5.1.1" data-path="data.html"><a href="data.html#one-day-we-will-have-a-summary-table-here"><i class="fa fa-check"></i><b>5.1.1</b> One day we will have a summary table here</a></li>
<li class="chapter" data-level="5.1.2" data-path="data.html"><a href="data.html#csv-files"><i class="fa fa-check"></i><b>5.1.2</b> .csv files</a></li>
<li class="chapter" data-level="5.1.3" data-path="data.html"><a href="data.html#defaults"><i class="fa fa-check"></i><b>5.1.3</b> Defaults</a></li>
<li class="chapter" data-level="5.1.4" data-path="data.html"><a href="data.html#a-brief-interlude-into-formats-for-data-in-r"><i class="fa fa-check"></i><b>5.1.4</b> A brief interlude into formats for data in R</a></li>
<li class="chapter" data-level="5.1.5" data-path="data.html"><a href="data.html#format-issues"><i class="fa fa-check"></i><b>5.1.5</b> Format issues?</a></li>
<li class="chapter" data-level="5.1.6" data-path="data.html"><a href="data.html#sav-files"><i class="fa fa-check"></i><b>5.1.6</b> .sav files</a></li>
<li class="chapter" data-level="5.1.7" data-path="data.html"><a href="data.html#rio-for-general-import"><i class="fa fa-check"></i><b>5.1.7</b> <code>rio</code> for general import</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="data.html"><a href="data.html#saving"><i class="fa fa-check"></i><b>5.2</b> Saving</a><ul>
<li class="chapter" data-level="5.2.1" data-path="data.html"><a href="data.html#rdata-files"><i class="fa fa-check"></i><b>5.2.1</b> .RData files</a></li>
<li class="chapter" data-level="5.2.2" data-path="data.html"><a href="data.html#sink"><i class="fa fa-check"></i><b>5.2.2</b> <code>sink</code></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="data.html"><a href="data.html#indexing"><i class="fa fa-check"></i><b>5.3</b> Indexing</a><ul>
<li class="chapter" data-level="5.3.1" data-path="data.html"><a href="data.html#logical-indexing"><i class="fa fa-check"></i><b>5.3.1</b> Logical indexing</a></li>
<li class="chapter" data-level="5.3.2" data-path="data.html"><a href="data.html#assignment-with-indexing"><i class="fa fa-check"></i><b>5.3.2</b> Assignment with Indexing</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="data.html"><a href="data.html#piping-syntax"><i class="fa fa-check"></i><b>5.4</b> Piping Syntax</a><ul>
<li class="chapter" data-level="5.4.1" data-path="data.html"><a href="data.html#why-use-pipes"><i class="fa fa-check"></i><b>5.4.1</b> Why use pipes?</a></li>
<li class="chapter" data-level="5.4.2" data-path="data.html"><a href="data.html#saving-the-output-of-your-pipe"><i class="fa fa-check"></i><b>5.4.2</b> Saving the output of your pipe</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data.html"><a href="data.html#reshaping"><i class="fa fa-check"></i><b>5.5</b> Reshaping</a><ul>
<li class="chapter" data-level="5.5.1" data-path="data.html"><a href="data.html#wide-vs.long-data"><i class="fa fa-check"></i><b>5.5.1</b> Wide vs. Long Data</a></li>
<li class="chapter" data-level="5.5.2" data-path="data.html"><a href="data.html#wide-to-long"><i class="fa fa-check"></i><b>5.5.2</b> Wide to Long</a></li>
<li class="chapter" data-level="5.5.3" data-path="data.html"><a href="data.html#long-to-wide"><i class="fa fa-check"></i><b>5.5.3</b> Long to wide</a></li>
<li class="chapter" data-level="5.5.4" data-path="data.html"><a href="data.html#final-note-on-reshaping-data"><i class="fa fa-check"></i><b>5.5.4</b> Final note on reshaping data</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="data.html"><a href="data.html#summarizing"><i class="fa fa-check"></i><b>5.6</b> Summarizing</a><ul>
<li class="chapter" data-level="5.6.1" data-path="data.html"><a href="data.html#basic-summarization"><i class="fa fa-check"></i><b>5.6.1</b> Basic Summarization</a></li>
<li class="chapter" data-level="5.6.2" data-path="data.html"><a href="data.html#grouped-summarization"><i class="fa fa-check"></i><b>5.6.2</b> Grouped Summarization</a></li>
<li class="chapter" data-level="5.6.3" data-path="data.html"><a href="data.html#mutation"><i class="fa fa-check"></i><b>5.6.3</b> Mutation</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data.html"><a href="data.html#resources"><i class="fa fa-check"></i><b>5.7</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>6</b> Plotting</a><ul>
<li class="chapter" data-level="6.1" data-path="plotting.html"><a href="plotting.html#r-graphics-structure"><i class="fa fa-check"></i><b>6.1</b> R Graphics Structure</a></li>
<li class="chapter" data-level="6.2" data-path="plotting.html"><a href="plotting.html#base-graphics"><i class="fa fa-check"></i><b>6.2</b> Base graphics</a></li>
<li class="chapter" data-level="6.3" data-path="plotting.html"><a href="plotting.html#ggplot2"><i class="fa fa-check"></i><b>6.3</b> ggplot2</a><ul>
<li class="chapter" data-level="6.3.1" data-path="plotting.html"><a href="plotting.html#layers"><i class="fa fa-check"></i><b>6.3.1</b> Layers</a></li>
<li class="chapter" data-level="6.3.2" data-path="plotting.html"><a href="plotting.html#aesthetic-mappings"><i class="fa fa-check"></i><b>6.3.2</b> (aes)thetic mappings</a></li>
<li class="chapter" data-level="6.3.3" data-path="plotting.html"><a href="plotting.html#geoms-stats"><i class="fa fa-check"></i><b>6.3.3</b> Geoms &amp; Stats</a></li>
<li class="chapter" data-level="6.3.4" data-path="plotting.html"><a href="plotting.html#position"><i class="fa fa-check"></i><b>6.3.4</b> Position</a></li>
<li class="chapter" data-level="6.3.5" data-path="plotting.html"><a href="plotting.html#scales"><i class="fa fa-check"></i><b>6.3.5</b> Scales</a></li>
<li class="chapter" data-level="6.3.6" data-path="plotting.html"><a href="plotting.html#facets"><i class="fa fa-check"></i><b>6.3.6</b> Facets</a></li>
<li class="chapter" data-level="6.3.7" data-path="plotting.html"><a href="plotting.html#coordinate-systems"><i class="fa fa-check"></i><b>6.3.7</b> Coordinate Systems</a></li>
<li class="chapter" data-level="6.3.8" data-path="plotting.html"><a href="plotting.html#themes"><i class="fa fa-check"></i><b>6.3.8</b> Themes</a></li>
<li class="chapter" data-level="6.3.9" data-path="plotting.html"><a href="plotting.html#extensions"><i class="fa fa-check"></i><b>6.3.9</b> Extensions</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="plotting.html"><a href="plotting.html#lattice"><i class="fa fa-check"></i><b>6.4</b> Lattice</a></li>
<li class="chapter" data-level="6.5" data-path="plotting.html"><a href="plotting.html#rendering"><i class="fa fa-check"></i><b>6.5</b> Rendering</a><ul>
<li class="chapter" data-level="6.5.1" data-path="plotting.html"><a href="plotting.html#using-graphics-engines"><i class="fa fa-check"></i><b>6.5.1</b> Using Graphics Engines</a></li>
<li class="chapter" data-level="6.5.2" data-path="plotting.html"><a href="plotting.html#ggsave"><i class="fa fa-check"></i><b>6.5.2</b> ggsave</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="plotting.html"><a href="plotting.html#grid"><i class="fa fa-check"></i><b>6.6</b> Grid</a></li>
<li class="chapter" data-level="6.7" data-path="plotting.html"><a href="plotting.html#references-1"><i class="fa fa-check"></i><b>6.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functions-1.html"><a href="functions-1.html"><i class="fa fa-check"></i><b>7</b> Functions</a></li>
<li class="chapter" data-level="8" data-path="useful-functions.html"><a href="useful-functions.html"><i class="fa fa-check"></i><b>8</b> Useful Functions</a><ul>
<li class="chapter" data-level="8.1" data-path="useful-functions.html"><a href="useful-functions.html#workspace"><i class="fa fa-check"></i><b>8.1</b> Workspace</a></li>
<li class="chapter" data-level="8.2" data-path="useful-functions.html"><a href="useful-functions.html#objects-2"><i class="fa fa-check"></i><b>8.2</b> Objects</a></li>
<li class="chapter" data-level="8.3" data-path="useful-functions.html"><a href="useful-functions.html#iteration"><i class="fa fa-check"></i><b>8.3</b> Iteration</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="style-tips.html"><a href="style-tips.html"><i class="fa fa-check"></i><b>9</b> Style Tips</a><ul>
<li class="chapter" data-level="9.1" data-path="style-tips.html"><a href="style-tips.html#nothing-here-except-a-reminder-to-jonny-that-they-should-make-this-page"><i class="fa fa-check"></i><b>9.1</b> NOTHING HERE EXCEPT A REMINDER TO JONNY THAT THEY SHOULD MAKE THIS PAGE</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="how-do-i.html"><a href="how-do-i.html"><i class="fa fa-check"></i><b>10</b> How do I…</a><ul>
<li class="chapter" data-level="10.1" data-path="how-do-i.html"><a href="how-do-i.html#yeeeeeeep-same-thing-here-nothing-but-a-slim-breeze-whistling-through-yer-earwells-the-tickle-tells-ya-it-dont-exist-yet"><i class="fa fa-check"></i><b>10.1</b> YEEEEEEEP SAME THING HERE NOTHING BUT A SLIM BREEZE WHISTLING THROUGH YER EARWELLS, THE TICKLE TELLS YA IT DONT EXIST YET</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Guide Index</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting" class="section level1">
<h1><span class="header-section-number">6</span> Plotting</h1>
<div id="r-graphics-structure" class="section level2">
<h2><span class="header-section-number">6.1</span> R Graphics Structure</h2>
<p>Plotting packages like <code>ggplot2</code> are only the top of four “layers” in R’s graphics structure:</p>
<div class="figure">
<img src="guide_files/RGraphics.png" />

</div>
<table style="width:96%;">
<colgroup>
<col width="8%" />
<col width="75%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th>Layer</th>
<th>Function</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Graphics Packages</td>
<td>High-level, user-facing plotting systems</td>
<td><code>ggplot2</code>, <code>lattice</code></td>
</tr>
<tr class="even">
<td>Graphics Systems</td>
<td>Maintaining plotting state, coordinating the construction of graphical objects using instructions from plotting packages</td>
<td><code>grid</code>, <code>graphics</code></td>
</tr>
<tr class="odd">
<td>Graphics Engines</td>
<td>Interface between graphics systems and graphics devices, handle resizing and displaying plots, maintaining “display lists” - record of function calls used to make plot, maintain an array of graphics devices</td>
<td><code>grDevices</code></td>
</tr>
<tr class="even">
<td>Graphics Devices</td>
<td>Maintain a plotting window, implement a series of “graphical primitives” like circles, lines, colors, etc.</td>
<td><code>X11</code>, <code>pdf</code>, <code>png</code></td>
</tr>
</tbody>
</table>
<p>While most, if not all programming languages and data manipulation software allow plotting, this system makes R graphics particularly <a href="https://www.stat.auckland.ac.nz/~paul/Talks/CSIRO2011/rgraphics.pdf"><strong>permissive</strong></a> – if the system can’t already make the plot you want, it is possible to code it yourself.</p>
<p>It is possible to get away with just knowing the top-level graphics packages, but understanding the full system is critical for making publication-quality figures. Without understanding <code>grid</code>, one cannot add custom labels or layouts to <code>ggplot2</code> plots; without understanding graphics devices, it may be unclear why saving as a <code>pdf</code> allows one to edit individual plot elements in Illustrator while <code>png</code> does not.</p>
</div>
<div id="base-graphics" class="section level2">
<h2><span class="header-section-number">6.2</span> Base graphics</h2>
<p>Base R graphics are made with a series of function calls, typically starting with a function that ‘creates’ the plot (like, say, <code>plot()</code>), and subsequent functions that modify that same plot. <code>par()</code> is used to set graphical parameters. <a href="https://www.stat.auckland.ac.nz/~paul/R/parMemnonics.html">Paul Murrell has compiled a mnemonic table</a> to help remember the different parameters of <code>par()</code>.</p>
<p>We won’t discuss base graphics in much detail, as I haven’t seen a situation where using <code>ggplot2</code> isn’t a better idea.</p>
<p>(An example from <a href="https://www.stat.auckland.ac.nz/~paul/RG2e/examples-stdplots.R" class="uri">https://www.stat.auckland.ac.nz/~paul/RG2e/examples-stdplots.R</a>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scatterplot</span>

<span class="co"># make data</span>
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">16</span>)
y1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.3</span>, <span class="fl">1.9</span>, <span class="fl">3.4</span>, <span class="fl">3.9</span>, <span class="fl">4.8</span>)
y2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, .<span class="dv">8</span>, .<span class="dv">5</span>, .<span class="dv">45</span>, .<span class="dv">4</span>, .<span class="dv">3</span>)

<span class="co"># Set axis label style (las), (mar)gins, text size (cex)</span>
<span class="kw">par</span>(<span class="dt">las=</span><span class="dv">1</span>, <span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="dt">cex=</span>.<span class="dv">7</span>)

<span class="co"># Create the plot and add objects</span>
<span class="kw">plot.new</span>()
<span class="kw">plot.window</span>(<span class="kw">range</span>(x), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">6</span>))
<span class="kw">lines</span>(x, y1)
<span class="kw">lines</span>(x, y2)
<span class="kw">points</span>(x, y1, <span class="dt">pch=</span><span class="dv">16</span>, <span class="dt">cex=</span><span class="dv">2</span>)
<span class="kw">points</span>(x, y2, <span class="dt">pch=</span><span class="dv">21</span>, <span class="dt">bg=</span><span class="st">&quot;white&quot;</span>, <span class="dt">cex=</span><span class="dv">2</span>)

<span class="co"># Further parameter adjustments</span>
<span class="kw">par</span>(<span class="dt">col=</span><span class="st">&quot;gray50&quot;</span>, <span class="dt">fg=</span><span class="st">&quot;gray50&quot;</span>, <span class="dt">col.axis=</span><span class="st">&quot;gray50&quot;</span>)
<span class="kw">axis</span>(<span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">16</span>, <span class="dv">4</span>))
<span class="kw">axis</span>(<span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">2</span>))
<span class="kw">axis</span>(<span class="dv">4</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">2</span>))
<span class="kw">box</span>(<span class="dt">bty=</span><span class="st">&quot;u&quot;</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Travel Time (s)&quot;</span>, <span class="dt">side=</span><span class="dv">1</span>, <span class="dt">line=</span><span class="dv">2</span>, <span class="dt">cex=</span><span class="fl">0.8</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Responses per Travel&quot;</span>, <span class="dt">side=</span><span class="dv">2</span>, <span class="dt">line=</span><span class="dv">2</span>, <span class="dt">las=</span><span class="dv">0</span>, <span class="dt">cex=</span><span class="fl">0.8</span>)
<span class="kw">mtext</span>(<span class="st">&quot;Responses per Second&quot;</span>, <span class="dt">side=</span><span class="dv">4</span>, <span class="dt">line=</span><span class="dv">2</span>, <span class="dt">las=</span><span class="dv">0</span>, <span class="dt">cex=</span><span class="fl">0.8</span>)
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>), <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fg=</span><span class="st">&quot;black&quot;</span>, <span class="dt">col.axis=</span><span class="st">&quot;black&quot;</span>)
<span class="kw">text</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="st">&quot;Bird 131&quot;</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
</div>
<div id="ggplot2" class="section level2">
<h2><span class="header-section-number">6.3</span> ggplot2</h2>
<p>For a more complete guide see <a href="https://github.com/hadley/ggplot2-book">the book</a> and for a more complete reference see <a href="http://ggplot2.tidyverse.org/reference/">the documentation</a>.</p>
<p>To get started, the only thing your data needs to be is a) be, b) a dataframe, c) “long”, and d) properly classed. By properly classed I don’t mean it needs to be the diamonds dataset, I mean that each column in your dataframe should be explicitly cast as the datatype you intend it to be - as.factor() your factors and as.numeric() your numbers.</p>
<p>But we are gonna use diamonds because we are properly classed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
pander::<span class="kw">pander</span>(
  <span class="kw">head</span>(diamonds)
)</code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="9%" />
<col width="14%" />
<col width="9%" />
<col width="12%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">carat</th>
<th align="center">cut</th>
<th align="center">color</th>
<th align="center">clarity</th>
<th align="center">depth</th>
<th align="center">table</th>
<th align="center">price</th>
<th align="center">x</th>
<th align="center">y</th>
<th align="center">z</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.23</td>
<td align="center">Ideal</td>
<td align="center">E</td>
<td align="center">SI2</td>
<td align="center">61.5</td>
<td align="center">55</td>
<td align="center">326</td>
<td align="center">3.95</td>
<td align="center">3.98</td>
<td align="center">2.43</td>
</tr>
<tr class="even">
<td align="center">0.21</td>
<td align="center">Premium</td>
<td align="center">E</td>
<td align="center">SI1</td>
<td align="center">59.8</td>
<td align="center">61</td>
<td align="center">326</td>
<td align="center">3.89</td>
<td align="center">3.84</td>
<td align="center">2.31</td>
</tr>
<tr class="odd">
<td align="center">0.23</td>
<td align="center">Good</td>
<td align="center">E</td>
<td align="center">VS1</td>
<td align="center">56.9</td>
<td align="center">65</td>
<td align="center">327</td>
<td align="center">4.05</td>
<td align="center">4.07</td>
<td align="center">2.31</td>
</tr>
<tr class="even">
<td align="center">0.29</td>
<td align="center">Premium</td>
<td align="center">I</td>
<td align="center">VS2</td>
<td align="center">62.4</td>
<td align="center">58</td>
<td align="center">334</td>
<td align="center">4.2</td>
<td align="center">4.23</td>
<td align="center">2.63</td>
</tr>
<tr class="odd">
<td align="center">0.31</td>
<td align="center">Good</td>
<td align="center">J</td>
<td align="center">SI2</td>
<td align="center">63.3</td>
<td align="center">58</td>
<td align="center">335</td>
<td align="center">4.34</td>
<td align="center">4.35</td>
<td align="center">2.75</td>
</tr>
<tr class="even">
<td align="center">0.24</td>
<td align="center">Very Good</td>
<td align="center">J</td>
<td align="center">VVS2</td>
<td align="center">62.8</td>
<td align="center">57</td>
<td align="center">336</td>
<td align="center">3.94</td>
<td align="center">3.96</td>
<td align="center">2.48</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># But we don&#39;t want to plot 50000 points every time so</span>
diamond_sub &lt;-<span class="st"> </span>diamonds[<span class="kw">sample</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(diamonds), <span class="dv">500</span>, <span class="dt">replace=</span><span class="ot">FALSE</span>),]</code></pre></div>
<div id="layers" class="section level3">
<h3><span class="header-section-number">6.3.1</span> Layers</h3>
<p>What is a statistical graphic? The good ole boys <a href="http://www.springer.com/us/book/9780387245447">Wilkinson</a> and <a href="http://www.tandfonline.com/doi/abs/10.1198/jcgs.2009.07098">Wickham</a> tell us that they are</p>
<ul>
<li><strong>Mappings</strong> from data to aesthetic attributes (colour, shape, size)</li>
<li>Of <strong>geometric objects</strong> (points, lines bars)</li>
<li>On a particular <strong>coordinate system</strong></li>
<li>Perhaps after a statistical <strong>transformation</strong></li>
</ul>
<p>We’ll follow their lead. In ggplot, that combination of things forms a layer. The terminology in ggplot is</p>
<ul>
<li><strong>aes</strong> - aesthetic mappings</li>
<li><strong>geom</strong> - geometric objects</li>
<li><strong>scale</strong> - …scales</li>
<li><strong>stat</strong> - statistical transformations</li>
</ul>
<p>Reordered, the flow of information in ggplot2 is:</p>
<ul>
<li><strong>data</strong> is attached to the ggplot call,</li>
<li>mapped by <strong>aes</strong>, and</li>
<li>transformed by <strong>stat</strong> before being passed to a</li>
<li><strong>geom</strong>,</li>
<li>which is placed, sized, and colored according to its relevant <strong>scales</strong></li>
<li>then ta-da! rendered plot.</li>
</ul>
</div>
<div id="aesthetic-mappings" class="section level3">
<h3><span class="header-section-number">6.3.2</span> (aes)thetic mappings</h3>
<p>Lets get ahead of ourselves and make a plot because we haven’t made one yet and our console is whining in the backseat.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>()
g</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>We made a ggplot object named “g” that is attached to the dataframe “diamond_sub” <code>g &lt;- ggplot(diamond_sub,</code> and has the aesthetic parameters “x” and “y” mapped to the columns “carat” and “price,” respectively <code>aes(x=carat, y=price))</code>. Then we added <code>+</code> another element to our plot, <code>geom_point()</code> which tells us that we want our aesthetic mapping represented geometrically as points. Note that we have to add parentheses to tell R that we want that function evaluated even if we don’t pass any arguments. We then rendered the plot by calling the variable name <code>g</code>.</p>
<p>Each geom (or more precisely, each stat, but we’ll get to that in a bit) has a certain subset of aes’s that apply to it (don’t we all).</p>
<p>You can list all aes’s with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggplot2:::.all_aesthetics</code></pre></div>
<pre><code>##  [1] &quot;adj&quot;        &quot;alpha&quot;      &quot;angle&quot;      &quot;bg&quot;         &quot;cex&quot;       
##  [6] &quot;col&quot;        &quot;color&quot;      &quot;colour&quot;     &quot;fg&quot;         &quot;fill&quot;      
## [11] &quot;group&quot;      &quot;hjust&quot;      &quot;label&quot;      &quot;linetype&quot;   &quot;lower&quot;     
## [16] &quot;lty&quot;        &quot;lwd&quot;        &quot;max&quot;        &quot;middle&quot;     &quot;min&quot;       
## [21] &quot;pch&quot;        &quot;radius&quot;     &quot;sample&quot;     &quot;shape&quot;      &quot;size&quot;      
## [26] &quot;srt&quot;        &quot;upper&quot;      &quot;vjust&quot;      &quot;weight&quot;     &quot;width&quot;     
## [31] &quot;x&quot;          &quot;xend&quot;       &quot;xmax&quot;       &quot;xmin&quot;       &quot;xintercept&quot;
## [36] &quot;y&quot;          &quot;yend&quot;       &quot;ymax&quot;       &quot;ymin&quot;       &quot;yintercept&quot;
## [41] &quot;z&quot;</code></pre>
<p>or by doing the same on the proto version of any geom, like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ggplot2:::GeomPoint</code></pre></div>
<pre><code>## &lt;ggproto object: Class GeomPoint, Geom&gt;
##     aesthetics: function
##     default_aes: uneval
##     draw_group: function
##     draw_key: function
##     draw_layer: function
##     draw_panel: function
##     extra_params: na.rm
##     handle_na: function
##     non_missing_aes: size shape colour
##     optional_aes: 
##     parameters: function
##     required_aes: x y
##     setup_data: function
##     use_defaults: function
##     super:  &lt;ggproto object: Class Geom&gt;</code></pre>
<p>Note the “required_aes” and “non_missing_aes” for required and optional aes, respectively.</p>
<p>In general, you’ll always be able to map color (or colour, color is just an alias), x, and y. Commonly you’ll also be able to map fill for things that take up area.</p>
<p>Aesthetics declared in the original call to <code>ggplot</code>, unless otherwise specified, apply to each added element. Within a given element, you can add, override, or remove aesthetics, like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add coloring by ... color ... to the points</span>
<span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_line</span>()+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color=</span>color))</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>You can make the same plot (except for order) in a worse way by specifying color in the base ggplot call and removing it with NULL from the lines.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">color=</span>color))+
<span class="st">  </span><span class="kw">geom_point</span>()+
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span><span class="ot">NULL</span>))</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Damn those are some ugly graphs, but this guide is about “can” not “should.” Notice how the order in which you add elements matters - the points are ‘on top of’ the lines in the first plot because the <code>geom_point</code> call came second, and vice-versa in the second plot.</p>
<p>You can also perform operations within the aes(), say if you want to fatten out a ribbon without it being a big goofy line</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The economics dataset with an added &#39;epoch&#39; factor to recolor every 100 points.</span>
economics_epoch &lt;-<span class="st"> </span>economics
economics_epoch$epoch &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">100</span>),
                                     <span class="kw">rep</span>(<span class="dv">2</span>,<span class="dv">100</span>),
                                     <span class="kw">rep</span>(<span class="dv">3</span>,<span class="dv">100</span>),
                                     <span class="kw">rep</span>(<span class="dv">4</span>,<span class="dv">274</span>)))
<span class="kw">ggplot</span>(economics_epoch, <span class="kw">aes</span>(<span class="dt">x=</span>date,<span class="dt">color=</span>epoch))+
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>unemploy), <span class="dt">size=</span><span class="dv">10</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>So goofy. Compared to…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(economics_epoch, <span class="kw">aes</span>(<span class="dt">x=</span>date,<span class="dt">fill=</span>epoch))+
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymax=</span>unemploy,<span class="dt">ymin=</span>unemploy<span class="dv">-1000</span>))</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Also, it’s common to confuse “fill” and “color.” You can see the difference:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(economics_epoch, <span class="kw">aes</span>(<span class="dt">x=</span>date,<span class="dt">color=</span>epoch))+
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymax=</span>unemploy,<span class="dt">ymin=</span>unemploy<span class="dv">-1000</span>))</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>And if you wanted to use both for different reasons because you’re a maniac</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(economics_epoch, <span class="kw">aes</span>(<span class="dt">x=</span>date,<span class="dt">color=</span>epoch, <span class="dt">fill=</span><span class="kw">rev</span>(epoch)))+
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymax=</span>unemploy,<span class="dt">ymin=</span>unemploy<span class="dv">-1000</span>))</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>You can also assign single values to an aes, though as we’ll see, it’s usually better to do that in a scale. You can give colors using <a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf">color names</a> or <a href="https://coolors.co">RGB hex values</a> passed outside the aes argument - remember the aes is a mapping from the data to the geom! Assigning a <code>fill</code> within the <code>aes</code> argument assumes you mean that your hex value is a level in a factor (and who could blame it), but assigning it outside the <code>aes</code> argument means that you are sending that color to the geom directly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(economics_epoch, <span class="kw">aes</span>(<span class="dt">x=</span>date))+
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymax=</span>unemploy,<span class="dt">ymin=</span>unemploy<span class="dv">-1000</span>), <span class="dt">fill=</span><span class="st">&quot;#F0A125&quot;</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>ggplot will do its best to figure out how to split your data when combining multiple aesthetics, but here is one extra trick:</p>
<p>Say you want to split your data by two factors but don’t want to make a new column in your dataframe or color them. You can use the <code>interaction()</code> function like (ignore the use of theme(), we’ll get to that):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># we have two factors, cut and color, with the levels...</span>
<span class="kw">levels</span>(diamond_sub$cut)</code></pre></div>
<pre><code>## [1] &quot;Fair&quot;      &quot;Good&quot;      &quot;Very Good&quot; &quot;Premium&quot;   &quot;Ideal&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(diamond_sub$color)</code></pre></div>
<pre><code>## [1] &quot;D&quot; &quot;E&quot; &quot;F&quot; &quot;G&quot; &quot;H&quot; &quot;I&quot; &quot;J&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># and we want to make a plot with all their permutations:</span>
<span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">interaction</span>(cut,color)))+
<span class="st">  </span><span class="kw">geom_bar</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>)
  )</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>I’ll give ya a list of all the aesthetics by shapes once we know what a stat is.</p>
</div>
<div id="geoms-stats" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Geoms &amp; Stats</h3>
<p>I’ve already thrown a lot of geoms your way, but there are a lot more where that came from. I’m not going to do a complete runthrough of all of them here because most of their use is relatively obvious once you know how to manipulate aesthetics, but if you’re hungry for it someone put together a nice graphical summary of the available geoms:</p>
<div class="figure">
<img src="guide_files/ggplot2_geoms.png" />

</div>
<p>This section is more concerned with the relationship between geoms and stats. Behind every great geom there’s a great stat. Stats act as intermediary functions between the incoming data and the geom - put another way, they relate the aes to the geom. Most common geoms just use the <code>stat_identity</code> that returns the number, but many can accept a <code>stat=&quot;stat_as_string&quot;</code> argument. Below is a table of geoms, their default stats, and their related aesthetic options (from page 57 of the ggplot book)</p>
<div class="figure">
<img src="guide_files/geoms_stat_aes.png" />

</div>
<p>A few examples of how to represent frequency data by manipulating stat:</p>
<p>A classic histogram</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price))+
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>This is equivalent to the call</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price))+
<span class="st">  </span><span class="kw">stat_bin</span>(<span class="dt">geom=</span><span class="st">&quot;bar&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>But calling it this way allows us to use whatever geom we’d like</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price))+
<span class="st">  </span><span class="kw">stat_bin</span>(<span class="dt">geom=</span><span class="st">&quot;step&quot;</span>, <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)+
<span class="st">  </span><span class="kw">stat_bin</span>(<span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>If instead one wants the scale as a density,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price))+
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Other stats can be accessed by calling another geom that uses it as their default. We can estimate a density kernel like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price))+
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)+
<span class="st">  </span><span class="kw">geom_density</span>()</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Yikes, our kernel is a little soft. We can adjust the bandwidth of the kernel (as its standard deviation)…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price))+
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">bins =</span> <span class="dv">20</span>)+
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">bw=</span><span class="dv">300</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>How about some two dimensional data? I need lines. thankfully we can directly perform linear models in ggplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>table, <span class="dt">y=</span>depth))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>)+
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>And if you want your confidence intervals right there with ya too</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>depth, <span class="dt">y=</span>table))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>)+
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">level=</span><span class="fl">0.99</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>We can also perform a few other smoothing/estimation operations, for example</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>table, <span class="dt">y=</span>depth))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>)+
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>And with a bit of convincing, ggplot will even do logistic regression for us</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(midwest, <span class="kw">aes</span>(<span class="dt">x=</span>percbelowpoverty, <span class="dt">y=</span>inmetro))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.1</span>)+
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;glm&quot;</span>, <span class="dt">method.args=</span><span class="kw">list</span>(<span class="dt">family=</span><span class="st">&quot;binomial&quot;</span>), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>As we saw before, most geoms can be controlled directly by calling their related stat. When doing so, we can select which geom we’d like to plot our error bars with.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(economics, <span class="kw">aes</span>(<span class="dt">x=</span>date, <span class="dt">y=</span>unemploy))+
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">color=</span><span class="st">&quot;gray&quot;</span>)+
<span class="st">  </span><span class="kw">stat_smooth</span>(<span class="dt">geom=</span><span class="st">&quot;linerange&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>, <span class="dt">method=</span><span class="st">&quot;loess&quot;</span>, <span class="dt">level=</span><span class="fl">0.99</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>How about some denser data. Remember our very first plot? There’s a whole lot more data that we randomly ignored. What if we weren’t some fraudulators and didn’t conveniently “lose our data?”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.02</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Wow that’s cool and smoky and all, but is it a good representation of the data?. If we summarize it with some hexagons …</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_hex</span>(<span class="dt">bins=</span><span class="dv">50</span>)</code></pre></div>
<pre><code>## Loading required package: methods</code></pre>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<p>Turns out it’s really easy to misrepresent your data if it’s not presented in a quantitatively meaningful way. Most of the density of our plot is in the lowest left section. Let’s try one more visualization method. Notice the <code>..density..</code> notation. Since density is a computed function, it is wrapped in a sorta weird half ellipse to make sure it doesn’t conflict with the dataframe in case it has a variable called density.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">scale_color_distiller</span>(<span class="dt">palette=</span><span class="st">&quot;Spectral&quot;</span>)+
<span class="st">  </span><span class="kw">stat_density_2d</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="kw">aes</span>(<span class="dt">size =</span> ..density.., <span class="dt">color=</span> ..density..), <span class="dt">alpha=</span><span class="fl">0.6</span>, <span class="dt">n=</span><span class="dv">75</span>, <span class="dt">contour =</span> F)+
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;#000000&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">scale_color_distiller</span>(<span class="dt">palette=</span><span class="st">&quot;Spectral&quot;</span>)+
<span class="st">  </span><span class="kw">stat_density_2d</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="kw">aes</span>(<span class="dt">size =</span> ..density.., <span class="dt">color=</span> ..density.., <span class="dt">alpha=</span> ..density..), <span class="dt">n=</span><span class="dv">75</span>, <span class="dt">contour =</span> F)+
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;#000000&quot;</span>),
        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),
        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="position" class="section level3">
<h3><span class="header-section-number">6.3.4</span> Position</h3>
<p>Is also important but I’m not covering it formally right now. ve most deel vis it.</p>
<p>Until I do, if your bar charts aren’t looking right just monkey around on google with the phrase <code>dodge</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_histogram</span>()</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<p>and maybe jitter</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>cut, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>cut, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitter</span>(<span class="dt">width=</span><span class="fl">0.25</span>))</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
<p>and maybe one more with <code>fill</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">50</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">50</span>, <span class="dt">position=</span><span class="st">&quot;fill&quot;</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="scales" class="section level3">
<h3><span class="header-section-number">6.3.5</span> Scales</h3>
<p>We have led our little geometric lambs to water, but what good is it if we don’t own the land?</p>
<p>Every aesthetic component, including axes, is a scale. There are two types of scales, continuous and discrete. With scales, we control things like</p>
<ul>
<li><strong>Color</strong></li>
<li><strong>Breaks</strong> - if it’s an axis, where do we have ticks, if it’s a legend, what is marked in the legend?</li>
<li><strong>Labels</strong> - what do we call our breaks?</li>
<li><strong>Limits</strong></li>
<li><strong>Expand</strong> - how much extra room we leave on the edges</li>
<li><strong>Transformations</strong> - log scales &amp; arbitrary transformations</li>
<li><strong>Position</strong> - If an axis, reposition top, bottom, left, or right depending on whether it’s an x or y axis.</li>
</ul>
<p>The general syntax to modify your scale is <code>scale_aesthetic_continuous</code> or <code>scale_aesthetic_discrete</code>, for example <code>scale_x_continuous</code> or <code>scale_fill_discrete</code>.</p>
<p>For now, not going to spend much time on this because they are relatively self explanatory, but a few specific useful examples</p>
<div id="axis-limits" class="section level4">
<h4><span class="header-section-number">6.3.5.1</span> Axis limits</h4>
<p>If you want to set axis limits manually, rather than allowing ggplot to figure them out for you…</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>table, <span class="dt">y=</span>depth))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.8</span>, <span class="dt">position=</span><span class="kw">position_jitter</span>(<span class="dt">width=</span>.<span class="dv">25</span>))+
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>)+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">56</span>, <span class="dv">60</span>))</code></pre></div>
<pre><code>## Warning: Removed 137 rows containing non-finite values (stat_smooth).</code></pre>
<pre><code>## Warning: Removed 204 rows containing missing values (geom_point).</code></pre>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
<div id="color-brewer" class="section level4">
<h4><span class="header-section-number">6.3.5.2</span> Color Brewer</h4>
<p>If you don’t want to manually input colors and want to just follow best principles, color brewer is a godsend. Visit the <a href="http://colorbrewer2.org">color brewer website</a> to see available color palettes. Or we can use a tool from RColorBrewer (to be covered in extensions):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">brewplot &lt;-<span class="st"> </span>RColorBrewer::<span class="kw">display.brewer.all</span>()</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>To simply drop it in to any plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(economics_epoch, <span class="kw">aes</span>(<span class="dt">x=</span>date,<span class="dt">fill=</span>epoch))+
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymax=</span>unemploy,<span class="dt">ymin=</span>unemploy<span class="dv">-1000</span>))+
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>And the continuous variant is called “Distiller”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat,<span class="dt">y=</span>price,<span class="dt">color=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>()+
<span class="st">  </span><span class="kw">scale_color_distiller</span>(<span class="dt">palette=</span><span class="st">&quot;RdPu&quot;</span>)+
<span class="st">  </span><span class="kw">theme_dark</span>()</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="manual-colors" class="section level4">
<h4><span class="header-section-number">6.3.5.3</span> Manual Colors</h4>
<p>To use your own colors, use <code>scale_color_manual</code> or <code>scale_fill_manual</code> (todo, trying to get some actually cool stuff in here)</p>
</div>
</div>
<div id="facets" class="section level3">
<h3><span class="header-section-number">6.3.6</span> Facets</h3>
<p>(Skipping detailed description for now… but)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">stat_density_2d</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="kw">aes</span>(<span class="dt">size =</span> ..density.., <span class="dt">color =</span> ..density..), 
                  <span class="dt">n=</span><span class="dv">10</span>, <span class="dt">contour =</span> F)+
<span class="st">  </span><span class="kw">scale_color_distiller</span>(<span class="dt">palette=</span><span class="st">&quot;RdPu&quot;</span>)+
<span class="st">  </span><span class="kw">facet_grid</span>(cut~color)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
</div>
<div id="coordinate-systems" class="section level3">
<h3><span class="header-section-number">6.3.7</span> Coordinate Systems</h3>
<p>(skipping for now)</p>
</div>
<div id="themes" class="section level3">
<h3><span class="header-section-number">6.3.8</span> Themes</h3>
<p>The <code>theme()</code> command allows you fine control over each plot element. There are a few general types of plot elements:</p>
<ul>
<li>line</li>
<li>rect</li>
<li>text</li>
</ul>
<p>That are grouped by where they are used, for example in</p>
<ul>
<li>axis</li>
<li>legend</li>
<li>panel - individual plotting areas, for example each facet in a facet grid</li>
<li>plot - the entire plotting area</li>
<li>strip - titles on facets</li>
</ul>
<p>Settings are inherited hierarchically. For example, one can set the size of all text, the size of all axis titles, or just the x axis title. Reference to each is straightforward:</p>
<p><code>text = element_text(),</code> <code>axis.title = element_text(),</code> <code>axis.title.x = element_text()</code></p>
<p>ggplot comes with a few built-in themes:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat,<span class="dt">y=</span>price,<span class="dt">color=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>()+
<span class="st">  </span><span class="kw">theme_minimal</span>()</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat,<span class="dt">y=</span>price,<span class="dt">color=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>()+
<span class="st">  </span><span class="kw">theme_void</span>()</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<div id="removing-elements" class="section level4">
<h4><span class="header-section-number">6.3.8.1</span> Removing elements</h4>
<p>Sometimes you want to be all draped in pearls and roses, and other times you just need your black turtleneck. To remove items, replace them with a blank element:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat,<span class="dt">y=</span>price,<span class="dt">color=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),
    <span class="dt">panel.grid       =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.text        =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.ticks       =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.title       =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.line        =</span> <span class="kw">element_line</span>(),
    <span class="dt">legend.position  =</span> <span class="st">&quot;none&quot;</span>
  )</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>And sometimes you just want to make a mockery of your audience’s eyes like you’ve got your hands in the MS paint bucket again. Notice how since we are in a “g” rammar of “g” raphics (“plot”) (“2”) things work as we expect them to</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat,<span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;pink&quot;</span>)+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">panel.background=</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;yellow&quot;</span>),
    <span class="dt">panel.grid      =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.text       =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.ticks      =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.title      =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.line       =</span> <span class="kw">element_line</span>(),
    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>
  )</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>A useful tool here is the direct specification of sizes with units. The general syntax for units are unit(number, “unit_type”), for example if you are trying to shout about how big those numbers are and dont understand what axis ticks are for</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat,<span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">panel.background=</span> <span class="kw">element_blank</span>(),
    <span class="dt">panel.grid      =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.text       =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="kw">unit</span>(<span class="dv">24</span>,<span class="st">&quot;pt&quot;</span>)),
    <span class="dt">axis.ticks      =</span> <span class="kw">element_line</span>(<span class="dt">arrow=</span><span class="kw">arrow</span>(<span class="dt">type=</span><span class="st">&quot;closed&quot;</span>)),
    <span class="dt">axis.title      =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.line       =</span> <span class="kw">element_line</span>(),
    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>
  )</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<p>Uh oh, who is screwing with our medicine? Our text is now hopelessly buried beneath our arrows. We can fix that by adjusting our margins. The margins are set in the order top, right, bottom, left. Since that doesn’t really make sense, they advise you to remember the phrase “trouble” and that actually works. Notice the inheritance. Even though we make settings for the x and y axis text specifically, it still retains our 24 point mistake. Margins can also be used with the plot.background to eliminate excess space, and can be set to negative numbers.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat,<span class="dt">y=</span>price))+
<span class="st">  </span><span class="kw">geom_point</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">panel.background=</span> <span class="kw">element_blank</span>(),
    <span class="dt">panel.grid      =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.text       =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="kw">unit</span>(<span class="dv">24</span>,<span class="st">&quot;pt&quot;</span>)),
    <span class="dt">axis.text.x    =</span> <span class="kw">element_text</span>(<span class="dt">margin=</span> <span class="kw">margin</span>(<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dt">unit=</span><span class="st">&quot;pt&quot;</span>)),
    <span class="dt">axis.text.y     =</span> <span class="kw">element_text</span>(<span class="dt">margin=</span> <span class="kw">margin</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dt">unit=</span><span class="st">&quot;pt&quot;</span>)),
    <span class="dt">axis.ticks      =</span> <span class="kw">element_line</span>(<span class="dt">arrow=</span><span class="kw">arrow</span>(<span class="dt">type=</span><span class="st">&quot;closed&quot;</span>)),
    <span class="dt">axis.title      =</span> <span class="kw">element_blank</span>(),
    <span class="dt">axis.line       =</span> <span class="kw">element_line</span>(),
    <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>
  )</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
</div>
</div>
<div id="extensions" class="section level3">
<h3><span class="header-section-number">6.3.9</span> Extensions</h3>
<p>ggplot has lots of extensions. But we’ll leave it at that for now….</p>
</div>
</div>
<div id="lattice" class="section level2">
<h2><span class="header-section-number">6.4</span> Lattice</h2>
<ul>
<li>lattice stuff here</li>
</ul>
</div>
<div id="rendering" class="section level2">
<h2><span class="header-section-number">6.5</span> Rendering</h2>
<p>Having plots in your R environment is one thing, but getting them out into the world or stuffed into your papers is quite another. Without explicitly specifying certain parameters like sizes and positions, your figure will end up with text crowded across the screen or nonevident without microscopy. It’s always a good idea to make those specifications explicit with the theme() function, but some things require that ggplot has knowledge about the rendering environment.</p>
<div id="using-graphics-engines" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Using Graphics Engines</h3>
<ul>
<li>bring over from Data chapter</li>
</ul>
</div>
<div id="ggsave" class="section level3">
<h3><span class="header-section-number">6.5.2</span> ggsave</h3>
<p>What happens when we just try to export our figure window?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scales lets us change the y axis numbers from scientific notation to decimal notation</span>
<span class="kw">library</span>(scales)

g.price_density &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">y=</span>..density.., <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>)+
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>, <span class="dt">guide=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Cut&quot;</span>))+
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Density&quot;</span>, <span class="dt">labels=</span>comma)+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Price&quot;</span>)+
<span class="st">  </span><span class="kw">theme_minimal</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(),
    <span class="dt">legend.position  =</span> <span class="kw">c</span>(.<span class="dv">8</span>,.<span class="dv">65</span>)
  )

<span class="co"># Saving figure by clicking &quot;export&quot; from figure window</span></code></pre></div>
<div class="figure">
<img src="guide_files/Rplot01.png" />

</div>
<p>Good god what have you done to the boy. Since the rendering is dependeng on the size of the plotting environment ggplot has rendered it into, our plot comes out looking very sad indeed.</p>
<p>The basic tool for exporting ggplot figures is the function ggsave. It allows us to explicitly specify the size, resolution, rendering engine, etc. Ggplot has many saving “devices,” or rendering engines, the basic categories of which are raster engines (like png) - which convert your plot into a series of pixels and color values, and vector engines (like pdf or svg) that leave the plot as a set of logical instructions. You should preserve your plots as vectors as long as you possibly can, as they are lossless representations of the image, and allow you to edit it by element in another program.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggsave</span>(<span class="st">&quot;price_density_plot.png&quot;</span>, g.price_density,
       <span class="dt">path=</span><span class="st">&quot;guide_files&quot;</span>, <span class="co"># you can use relative or absolute paths</span>
       <span class="dt">device=</span><span class="st">&quot;png&quot;</span>,
       <span class="dt">width=</span><span class="kw">unit</span>(<span class="dv">6</span>,<span class="st">&quot;in&quot;</span>), <span class="dt">height=</span><span class="kw">unit</span>(<span class="dv">4</span>,<span class="st">&quot;in&quot;</span>),
       <span class="dt">dpi=</span><span class="dv">300</span>
)</code></pre></div>
<p><img src="guide_files/price_density_plot.png" /> Much better.</p>
</div>
</div>
<div id="grid" class="section level2">
<h2><span class="header-section-number">6.6</span> Grid</h2>
<p>Ok, we might know what a statistical plot is, but what is a ggplot? Ggplot follows the <a href="https://www.stat.auckland.ac.nz/~paul/RGraphics/chapter5.pdf">grid graphics model</a>, which is a set of primitive graphical elements like circles, lines, rectangles, that have some notion of their position within a “viewport” (ggplot’s panels). GRaphical OBjects in grid are called “grobs,” and we can convert our plot to be able to directly manipulate its grobs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g.grob &lt;-<span class="st"> </span><span class="kw">ggplotGrob</span>(g.price_density)</code></pre></div>
<p>Your plot’s layout information is in its <code>layout</code>, <code>heights</code>, and <code>widths</code> attributes. Each of the numbers in the layout matrix corresponds to a width (for the “t”(op), and “b”(ottom) columns), or height (for the “l” and “r”). Each grob has its outer extent specified by these values, so the background has its top at position 1, left at position 1, bottom at 10 and right at 7 - the largest values of each, predictably. By default, heights and widths of undeclared elements are “null” or “grobheight” units that depend on the size of the viewport. You can set them explicitly as you might expect with <code>g.grob$heights[5] &lt;- unit(5,&quot;in&quot;)</code> or whatever. This becomes critical for ensuring axes across multiple plots are the same size.</p>
<p>The “children” or “grobs” of the main grob object contain each of the literal graphical objects, and they behave just like the parent.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g.grob$layout</code></pre></div>
<pre><code>##    t l  b r  z clip       name
## 18 1 1 10 7  0   on background
## 1  5 3  5 3  5  off     spacer
## 2  6 3  6 3  7  off     axis-l
## 3  7 3  7 3  3  off     spacer
## 4  5 4  5 4  6  off     axis-t
## 5  6 4  6 4  1   on      panel
## 6  7 4  7 4  9  off     axis-b
## 7  5 5  5 5  4  off     spacer
## 8  6 5  6 5  8  off     axis-r
## 9  7 5  7 5  2  off     spacer
## 10 4 4  4 4 10  off     xlab-t
## 11 8 4  8 4 11  off     xlab-b
## 12 6 2  6 2 12  off     ylab-l
## 13 6 6  6 6 13  off     ylab-r
## 14 6 4  6 4 14  off  guide-box
## 15 3 4  3 4 15  off   subtitle
## 16 2 4  2 4 16  off      title
## 17 9 4  9 4 17  off    caption</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g.grob$heights</code></pre></div>
<pre><code>##  [1] 5.5pt                    0cm                     
##  [3] 0cm                      0cm                     
##  [5] 0cm                      1null                   
##  [7] sum(2.75pt, 1grobheight) 1grobheight             
##  [9] 0cm                      5.5pt</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g.grob$widths</code></pre></div>
<pre><code>## [1] 5.5pt                   1grobwidth              sum(1grobwidth, 2.75pt)
## [4] 1null                   0cm                     0cm                    
## [7] 5.5pt</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g.grob$grobs</code></pre></div>
<pre><code>## [[1]]
## zeroGrob[plot.background..zeroGrob.2978] 
## 
## [[2]]
## zeroGrob[NULL] 
## 
## [[3]]
## absoluteGrob[GRID.absoluteGrob.2951] 
## 
## [[4]]
## zeroGrob[NULL] 
## 
## [[5]]
## zeroGrob[NULL] 
## 
## [[6]]
## gTree[panel-1.gTree.2933] 
## 
## [[7]]
## absoluteGrob[GRID.absoluteGrob.2945] 
## 
## [[8]]
## zeroGrob[NULL] 
## 
## [[9]]
## zeroGrob[NULL] 
## 
## [[10]]
## zeroGrob[NULL] 
## 
## [[11]]
## zeroGrob[NULL] 
## 
## [[12]]
## titleGrob[axis.title.x..titleGrob.2936] 
## 
## [[13]]
## titleGrob[axis.title.y..titleGrob.2939] 
## 
## [[14]]
## zeroGrob[NULL] 
## 
## [[15]]
## TableGrob (3 x 3) &quot;guide-box&quot;: 2 grobs
##                                     z     cells                  name
## 99_281d9cc4e523da50b6c36763eedff87c 1 (2-2,2-2)                guides
##                                     0 (1-3,1-3) legend.box.background
##                                               grob
## 99_281d9cc4e523da50b6c36763eedff87c gtable[layout]
##                                     zeroGrob[NULL]
## 
## [[16]]
## zeroGrob[plot.subtitle..zeroGrob.2976] 
## 
## [[17]]
## zeroGrob[plot.title..zeroGrob.2975] 
## 
## [[18]]
## zeroGrob[plot.caption..zeroGrob.2977]</code></pre>
<p>We can see that deep down at the core of our plot is just a bunch of polygons. I arrived at these numbers by just listing them recursively (calling <code>g.grob$grobs</code>, seeing which one I needed, etc.). We can directly edit the graphical properties of these polygons (<code>gp</code>) as you might expect. We then</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We have to load the grid library to do some commands, might as well load it now</span>
<span class="kw">library</span>(grid)

g.grob$grobs[[<span class="dv">6</span>]]$children[[<span class="dv">3</span>]]$children</code></pre></div>
<pre><code>## (polygon[geom_ribbon.polygon.2911], polygon[geom_ribbon.polygon.2913], polygon[geom_ribbon.polygon.2915], polygon[geom_ribbon.polygon.2917], polygon[geom_ribbon.polygon.2919])</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">g.grob$grobs[[<span class="dv">6</span>]]$children[[<span class="dv">3</span>]]$children[[<span class="dv">1</span>]]$gp$lwd &lt;-<span class="st"> </span><span class="dv">10</span>
g.grob$grobs[[<span class="dv">6</span>]]$children[[<span class="dv">3</span>]]$children[[<span class="dv">1</span>]]$gp$fill &lt;-<span class="st"> &quot;#FF51FD&quot;</span>
g.grob$grobs[[<span class="dv">6</span>]]$children[[<span class="dv">3</span>]]$children[[<span class="dv">1</span>]]$gp$col &lt;-<span class="st"> &quot;yellow&quot;</span>

<span class="co"># grid.newpage() clears the current viewport (so your plots don&#39;t just keep stacking up)</span>
<span class="co"># grid.draw() redraws our grob in the current viewport</span>

<span class="kw">grid.newpage</span>()
<span class="kw">grid.draw</span>(g.grob)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>I have no idea why you keep wanting to do this to your plots. Lets try to use grid to arrange two plots that we couldn’t using ggplot alone. Let’s try to get density plots next to our scatterplot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We&#39;ll need &quot;gtable&quot; to tread the grids like a table</span>
<span class="kw">library</span>(gtable)

g.scatter &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">color=</span>cut))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="fl">0.5</span>)+
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>, <span class="dt">guide=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Cut&quot;</span>))+
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Price&quot;</span>)+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Carat&quot;</span>)+
<span class="st">  </span><span class="kw">theme_minimal</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.8</span>),
    <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;#EFEFEF&quot;</span>)
  )

g.density_x &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>..density.., <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>)+
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>)+
<span class="st">  </span><span class="co">#scale_x_continuous(expand=c(0,0))+</span>
<span class="st">  </span><span class="kw">theme_void</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>
  )

g.density_y &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">y=</span>..density.., <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>)+
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>)+
<span class="st">  </span><span class="co">#scale_x_continuous(expand=c(0,0))+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()+<span class="st"> </span><span class="co"># Flip the coordinates so x is y, y i x</span>
<span class="st">  </span><span class="kw">theme_void</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>
  )

<span class="co"># Make our grobs</span>
g.scatter_grob   &lt;-<span class="st"> </span><span class="kw">ggplotGrob</span>(g.scatter)
g.density_x_grob &lt;-<span class="st"> </span><span class="kw">ggplotGrob</span>(g.density_x)
g.density_y_grob &lt;-<span class="st"> </span><span class="kw">ggplotGrob</span>(g.density_y)

<span class="co"># Add a row and a column to the scatterplot where we&#39;ll add our density plots</span>
g.scatter_grob &lt;-<span class="st"> </span><span class="kw">gtable_add_rows</span>(g.scatter_grob,
                                  <span class="kw">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;npc&quot;</span>), <span class="co"># npc is a unit that&#39;s defined by the viewport</span>
                                  <span class="dv">0</span>) <span class="co"># position - we add to the top</span>
g.scatter_grob &lt;-<span class="st"> </span><span class="kw">gtable_add_cols</span>(g.scatter_grob,
                                  <span class="kw">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;npc&quot;</span>), <span class="co"># npc is a unit that&#39;s defined by the viewport</span>
                                  -<span class="dv">1</span>) <span class="co"># position - we add on the right</span>

<span class="co"># Let&#39;s check our layout</span>
g.scatter_grob$layout</code></pre></div>
<pre><code>##     t l  b r  z clip       name
## 18  2 1 11 7  0   on background
## 1   6 3  6 3  5  off     spacer
## 2   7 3  7 3  7  off     axis-l
## 3   8 3  8 3  3  off     spacer
## 4   6 4  6 4  6  off     axis-t
## 5   7 4  7 4  1   on      panel
## 6   8 4  8 4  9  off     axis-b
## 7   6 5  6 5  4  off     spacer
## 8   7 5  7 5  8  off     axis-r
## 9   8 5  8 5  2  off     spacer
## 10  5 4  5 4 10  off     xlab-t
## 11  9 4  9 4 11  off     xlab-b
## 12  7 2  7 2 12  off     ylab-l
## 13  7 6  7 6 13  off     ylab-r
## 14  7 4  7 4 14  off  guide-box
## 15  4 4  4 4 15  off   subtitle
## 16  3 4  3 4 16  off      title
## 17 10 4 10 4 17  off    caption</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Now we add the density grobs</span>
g.scatter_grob &lt;-<span class="st"> </span><span class="kw">gtable_add_grob</span>(g.scatter_grob, g.density_x_grob, 
                                  <span class="dt">t =</span> <span class="dv">1</span>, <span class="dt">l =</span> <span class="dv">4</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">7</span>)
g.scatter_grob &lt;-<span class="st"> </span><span class="kw">gtable_add_grob</span>(g.scatter_grob, g.density_y_grob, 
                                  <span class="dt">t =</span> <span class="dv">4</span>, <span class="dt">l =</span> <span class="dv">8</span>, <span class="dt">b =</span> <span class="dv">7</span>, <span class="dt">r =</span> <span class="dv">8</span>)

<span class="kw">grid.newpage</span>()
<span class="kw">grid.draw</span>(g.scatter_grob)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Uh oh, we’re a little misaligned. We can expand our x-axes to make the density plots fill the entire space</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We&#39;ll need &quot;gtable&quot; to tread the grids like a table</span>

g.scatter &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>price, <span class="dt">color=</span>cut))+
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="fl">0.5</span>)+
<span class="st">  </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>, <span class="dt">guide=</span><span class="kw">guide_legend</span>(<span class="dt">title=</span><span class="st">&quot;Cut&quot;</span>))+
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Price&quot;</span>)+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Carat&quot;</span>)+
<span class="st">  </span><span class="kw">theme_minimal</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position=</span><span class="kw">c</span>(<span class="fl">0.15</span>,<span class="fl">0.8</span>),
    <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;#EFEFEF&quot;</span>)
  )

g.density_x &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>carat, <span class="dt">y=</span>..density.., <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>)+
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>)+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))+
<span class="st">  </span><span class="kw">theme_void</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>
  )

g.density_y &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamond_sub, <span class="kw">aes</span>(<span class="dt">x=</span>price, <span class="dt">y=</span>..density.., <span class="dt">fill=</span>cut))+
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">position=</span><span class="st">&quot;stack&quot;</span>)+
<span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Set1&quot;</span>)+
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))+
<span class="st">  </span><span class="kw">coord_flip</span>()+<span class="st"> </span><span class="co"># Flip the coordinates so x is y, y i x</span>
<span class="st">  </span><span class="kw">theme_void</span>()+
<span class="st">  </span><span class="kw">theme</span>(
    <span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>
  )

<span class="co"># Make our grobs</span>
g.scatter_grob   &lt;-<span class="st"> </span><span class="kw">ggplotGrob</span>(g.scatter)
g.density_x_grob &lt;-<span class="st"> </span><span class="kw">ggplotGrob</span>(g.density_x)
g.density_y_grob &lt;-<span class="st"> </span><span class="kw">ggplotGrob</span>(g.density_y)

<span class="co"># Add a row and a column to the scatterplot where we&#39;ll add our density plots</span>
g.scatter_grob &lt;-<span class="st"> </span><span class="kw">gtable_add_rows</span>(g.scatter_grob,
                                  <span class="kw">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;npc&quot;</span>), <span class="co"># npc is a unit that&#39;s defined by the viewport</span>
                                  <span class="dv">0</span>) <span class="co"># position - we add to the top</span>
g.scatter_grob &lt;-<span class="st"> </span><span class="kw">gtable_add_cols</span>(g.scatter_grob,
                                  <span class="kw">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;npc&quot;</span>), <span class="co"># npc is a unit that&#39;s defined by the viewport</span>
                                  -<span class="dv">1</span>) <span class="co"># position - we add on the right</span>

<span class="co"># Let&#39;s check our layout</span>
g.scatter_grob$layout</code></pre></div>
<pre><code>##     t l  b r  z clip       name
## 18  2 1 11 7  0   on background
## 1   6 3  6 3  5  off     spacer
## 2   7 3  7 3  7  off     axis-l
## 3   8 3  8 3  3  off     spacer
## 4   6 4  6 4  6  off     axis-t
## 5   7 4  7 4  1   on      panel
## 6   8 4  8 4  9  off     axis-b
## 7   6 5  6 5  4  off     spacer
## 8   7 5  7 5  8  off     axis-r
## 9   8 5  8 5  2  off     spacer
## 10  5 4  5 4 10  off     xlab-t
## 11  9 4  9 4 11  off     xlab-b
## 12  7 2  7 2 12  off     ylab-l
## 13  7 6  7 6 13  off     ylab-r
## 14  7 4  7 4 14  off  guide-box
## 15  4 4  4 4 15  off   subtitle
## 16  3 4  3 4 16  off      title
## 17 10 4 10 4 17  off    caption</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Now we add the density grobs</span>
g.scatter_grob &lt;-<span class="st"> </span><span class="kw">gtable_add_grob</span>(g.scatter_grob, g.density_x_grob, 
                                  <span class="dt">t =</span> <span class="dv">1</span>, <span class="dt">l =</span> <span class="dv">4</span>, <span class="dt">b =</span> <span class="dv">1</span>, <span class="dt">r =</span> <span class="dv">7</span>)
g.scatter_grob &lt;-<span class="st"> </span><span class="kw">gtable_add_grob</span>(g.scatter_grob, g.density_y_grob, 
                                  <span class="dt">t =</span> <span class="dv">4</span>, <span class="dt">l =</span> <span class="dv">8</span>, <span class="dt">b =</span> <span class="dv">7</span>, <span class="dt">r =</span> <span class="dv">8</span>)

<span class="kw">grid.newpage</span>()
<span class="kw">grid.draw</span>(g.scatter_grob)</code></pre></div>
<p><img src="04-Plotting_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>Todo: adding raw grobs</p>
</div>
<div id="references-1" class="section level2">
<h2><span class="header-section-number">6.7</span> References</h2>
<ul>
<li><a href="https://www.stat.auckland.ac.nz/~paul/grid/grid.html" class="uri">https://www.stat.auckland.ac.nz/~paul/grid/grid.html</a></li>
<li><a href="https://www.stat.auckland.ac.nz/~paul/grid/doc/plotexample.pdf" class="uri">https://www.stat.auckland.ac.nz/~paul/grid/doc/plotexample.pdf</a></li>
<li><a href="https://www.stat.auckland.ac.nz/~paul/Talks/CSIRO2011/rgraphics.pdf" class="uri">https://www.stat.auckland.ac.nz/~paul/Talks/CSIRO2011/rgraphics.pdf</a></li>
<li><a href="https://www.stat.auckland.ac.nz/~paul/Talks/JSM2013/grid.html" class="uri">https://www.stat.auckland.ac.nz/~paul/Talks/JSM2013/grid.html</a></li>
<li><a href="https://www.stat.auckland.ac.nz/~paul/Talks/Rgraphics.pdf" class="uri">https://www.stat.auckland.ac.nz/~paul/Talks/Rgraphics.pdf</a></li>
<li><a href="https://www.stat.auckland.ac.nz/~paul/grid/doc/interactive.pdf" class="uri">https://www.stat.auckland.ac.nz/~paul/grid/doc/interactive.pdf</a></li>
<li><a href="http://bxhorn.com/structure-of-r-graphs/" class="uri">http://bxhorn.com/structure-of-r-graphs/</a></li>
<li><a href="https://www.slideshare.net/dataspora/a-survey-of-r-graphics" class="uri">https://www.slideshare.net/dataspora/a-survey-of-r-graphics</a></li>
</ul>
<!-- # Some DoPlots To Tittilate -->
<!-- Here we see the plot in its native habitat, with its code fragmented from hours of drinking at your desk while trying to figure out what the hell a null unit is. -->
<!-- ## Segments & Border Whiskers -->
<!-- ```{r} -->
<!-- library(grid) -->
<!-- library(gtable) -->
<!-- library(gridExtra) -->
<!-- load("data/gendat_mouse_rs.R", .GlobalEnv) -->
<!-- load("data/gendat_mouse.R", .GlobalEnv) -->
<!-- # Set some colors -->
<!-- scat_cols <- c("GT2_LINE"="#A54601","GT3_LINE"="#196B52") -->
<!-- # Generalization Type Scatter/Regression plot -->
<!-- g.genscat_scat <- ggplot(gendat.mouse.rs,aes(x=gt1)) +  -->
<!--   geom_point(aes(y=gt2),col="#FF6B02",alpha=0.8,size=2) + -->
<!--   geom_smooth(aes(y=gt2,colour="GT2_LINE"),method=lm,se=TRUE,size=0.75) + -->
<!--   geom_point(aes(y=gt3),col="#1b9e77",alpha=0.8,size=2) + -->
<!--   geom_smooth(aes(y=gt3,colour="GT3_LINE"),method=lm,se=TRUE,size=0.75) + -->
<!--   scale_x_continuous(expand = c(0, 0), -->
<!--                      breaks=c(0.65,0.7,0.75,0.8,0.85),labels=c("65","70","75","80","85")) +  -->
<!--   scale_y_continuous(expand = c(0, 0), -->
<!--                      breaks=c(0.5,0.55,0.6,0.65,0.7,0.75),labels=c("50","55","60","65","70","75")) +  -->
<!--   expand_limits(x=c(0.62,0.86),y=c(0.5,0.80))+ -->
<!--   ylab("Generalization Accuracy (%)") + -->
<!--   xlab("Learned Token Accuracy (%)") + -->
<!--   scale_colour_manual(values=scat_cols, -->
<!--                       labels=c(expression(paste("Type 2 -  ",beta,": 0.52,  ", R^{2},":0.70")),  -->
<!--                                expression(paste("Type 3 -  ",beta,": 0.65,  ", R^{2},":0.58"))))+ -->
<!--   guides(colour=guide_legend(override.aes=list(size=5)))+ -->
<!--   theme(panel.background  = element_rect(fill="#F5F5F5"),  -->
<!--         panel.grid.major  = element_blank(), -->
<!--         panel.grid.minor  = element_blank(), -->
<!--         plot.background   = element_rect(fill="transparent",colour=NA), -->
<!--         axis.title.y      = element_text(size=rel(1),margin=margin(2,7,2,10,unit="pt")), -->
<!--         axis.text.y       = element_text(size=rel(1),margin=margin(1,3,1,1,unit="pt")), -->
<!--         axis.text.x       = element_text(size=rel(1),margin=margin(7,1,1,1,unit="pt")), -->
<!--         axis.title.x      = element_text(size=rel(1),margin=margin(7,2,10,2,unit="pt")), -->
<!--         legend.position   = c(.7,.2), -->
<!--         legend.text       = element_text(size=rel(.8)), -->
<!--         legend.title      = element_blank(), -->
<!--         legend.background = element_blank(), -->
<!--         legend.key        = element_blank(), -->
<!--         plot.margin       = unit(c(0,0,0,0),"lines")) -->
<!-- g.genscat_boxhorz <- ggplot(gendat.mouse.rs,aes(x=factor(1),y=gt1))+ -->
<!--   geom_boxplot()+ -->
<!--   geom_point(size=1) +  -->
<!--   scale_y_continuous(expand = c(0, 0)) +  -->
<!--   #expand_limits(y=c(0.62,0.86))+ -->
<!--   coord_flip()+ -->
<!--   theme(panel.background = element_blank(),  -->
<!--         panel.grid.major = element_blank(), -->
<!--         panel.grid.minor = element_blank(), -->
<!--         plot.background  = element_rect(fill="transparent",colour=NA), -->
<!--         axis.title.y     = element_blank(), -->
<!--         axis.text.y      = element_blank(), -->
<!--         axis.title.x     = element_blank(), -->
<!--         axis.text.x      = element_blank(), -->
<!--         axis.ticks.x     = element_blank(), -->
<!--         axis.ticks.y     = element_blank(), -->
<!--         legend.position  = "none", -->
<!--         plot.margin      = unit(c(1,0,0,0),"lines")) -->
<!-- g.genscat_boxvert <- ggplot(gendat.mouse.rs,aes(x=factor(1))) + -->
<!--   geom_boxplot(aes(y=gt2),col="#A54601") + -->
<!--   geom_point(aes(y=gt2),col="#FF6B02",size=1) + -->
<!--   geom_boxplot(aes(x=factor(2),y=gt3),col="#196B52") + -->
<!--   geom_point(aes(x=factor(2),y=gt3),col="#1b9e77",size=1) + -->
<!--   scale_y_continuous(expand = c(0, 0)) +  -->
<!--   expand_limits(y=c(0.45,0.80))+ -->
<!--   theme(panel.background = element_blank(),  -->
<!--         panel.grid.major = element_blank(), -->
<!--         panel.grid.minor = element_blank(), -->
<!--         plot.background  = element_rect(fill="transparent",colour=NA), -->
<!--         axis.title.y     = element_blank(), -->
<!--         axis.text.y      = element_blank(), -->
<!--         axis.title.x     = element_blank(), -->
<!--         axis.text.x      = element_blank(), -->
<!--         axis.ticks.x     = element_blank(), -->
<!--         axis.ticks.y     = element_blank(), -->
<!--         legend.position  = "none", -->
<!--         plot.margin = unit(c(0,0,0,0),"lines")) -->
<!-- # Combine plots, see https://www.r-bloggers.com/scatterplot-with-marginal-boxplots/ -->
<!-- g.genscat_gtabscat <- ggplotGrob(g.genscat_scat) -->
<!-- g.genscat_gtabhorz <- ggplotGrob(g.genscat_boxhorz) -->
<!-- g.genscat_gtabvert <- ggplotGrob(g.genscat_boxvert) -->
<!-- maxW <- unit.pmax(g.genscat_gtabscat$widths[2:3],g.genscat_gtabhorz$widths[2:3]) -->
<!-- maxH <- unit.pmax(g.genscat_gtabscat$heights[4:5],g.genscat_gtabvert$heights[4:5]) -->
<!-- g.genscat_gtabscat$widths[2:3] <- as.list(maxW) -->
<!-- g.genscat_gtabhorz$widths[2:3] <- as.list(maxW) -->
<!-- g.genscat_gtabscat$heights[4:5] <- as.list(maxH) -->
<!-- g.genscat_gtabvert$heights[4:5] <- as.list(maxH) -->
<!-- g.genscat_gtab <- gtable(widths=unit(c(7,1),"null"),height=unit(c(1,7),"null")) -->
<!-- g.genscat_gtab <- gtable_add_grob(g.genscat_gtab,g.genscat_gtabscat,2,1) -->
<!-- g.genscat_gtab <- gtable_add_grob(g.genscat_gtab,g.genscat_gtabhorz,1,1) -->
<!-- g.genscat_gtab <- gtable_add_grob(g.genscat_gtab,g.genscat_gtabvert,2,2) -->
<!-- # Generalization type scatter/line combined plot -->
<!-- g.gensl <- ggplot(gendat.mouse,aes(x=as.factor(gentype),y=meancx,group=as.factor(mouse)))+ -->
<!--   geom_point(size=1)+ -->
<!--   geom_line(size=0.3)+ -->
<!--   xlab("Generalization Type")+ -->
<!--   ylab("Mean Accuracy (%)")+ -->
<!--   scale_x_discrete(expand=c(0.1,0.1))+ -->
<!--   scale_y_continuous(expand=c(0,0), -->
<!--                      limits=c(0.5,0.86), -->
<!--                      breaks=c(0.5,0.55,0.6,0.65,0.7,0.75,0.8,0.85), -->
<!--                      labels=c("50","55","60","65","70","75","80","85"))+ -->
<!--   theme(panel.background = element_blank(),  -->
<!--         panel.grid.major = element_blank(), -->
<!--         panel.grid.minor = element_blank(), -->
<!--         axis.text.x      = element_text(size=rel(1),margin=margin(7,1,1,1,unit="pt")), -->
<!--         axis.title.x     = element_text(size=rel(1),margin=margin(7,2,10,2,unit="pt")), -->
<!--         plot.background  = element_rect(fill="transparent",colour=NA), -->
<!--         legend.position  = "none", -->
<!--         plot.margin      = unit(c(1,0,0,0),"lines")) -->
<!-- #Combination plot of above two -->
<!-- g.gensl.gt <- ggplotGrob(g.gensl) -->
<!-- g.combo <- grid.arrange(g.gensl.gt,g.genscat_gtab,widths=c(2,5)) -->
<!-- grid.newpage() -->
<!-- grid.draw(g.combo) -->
<!-- ``` -->
<!-- ## Heatmap & PCs -->
<!-- ```{r, fig.width=3.6,fig.height=7.5} -->
<!-- load("data/gendat_vowmus.R", .GlobalEnv) -->
<!-- load("data/klust_wseg.R", .GlobalEnv) -->
<!-- load("data/pmc_melt.R", .GlobalEnv) -->
<!-- load("data/pmc_x.R", .GlobalEnv) -->
<!--   # Make dendrogram -->
<!--   g.dendro <- ggplot(klust.w_seg)+ -->
<!--     geom_segment(aes(x=x,y=y,xend=xend,yend=yend,color=cols))+ -->
<!--     scale_color_manual(values=c("#000000","#E21D1D","#3B4aEF","#FC7A00"))+ -->
<!--     scale_y_reverse(expand=c(0,0))+ -->
<!--     scale_x_discrete(expand=c(0.04,0))+ -->
<!--     theme_void()+ -->
<!--     theme(legend.position = "none", -->
<!--           panel.background  = element_blank(),  -->
<!--           panel.grid.major  = element_blank(), -->
<!--           panel.grid.minor  = element_blank(), -->
<!--           plot.background   = element_blank(), -->
<!--           plot.margin       = margin(0,0,0,0,unit="npc"), -->
<!--           axis.text         = element_blank(), -->
<!--           axis.title.x      = element_blank(), -->
<!--           axis.title.y      = element_blank()) -->
<!--   # Split into /g/ and /b/ -->
<!--   gendat.vowmus_g <- gendat.vowmus[gendat.vowmus$consonant==1,]  -->
<!--   gendat.vowmus_b <- gendat.vowmus[gendat.vowmus$consonant==2,] -->
<!--   # Factor & reorder so the vowels are in the right order... -->
<!--   gendat.vowmus_g$vowel <- factor(gendat.vowmus_g$vowel,ordered=TRUE) -->
<!--   gendat.vowmus_g$vowel <- factor(gendat.vowmus_g$vowel,levels(gendat.vowmus_g$vowel)[c(6,5,4,3,2,1)]) -->
<!--   gendat.vowmus_b$vowel <- factor(gendat.vowmus_b$vowel,ordered=TRUE) -->
<!--   gendat.vowmus_b$vowel <- factor(gendat.vowmus_b$vowel,levels(gendat.vowmus_b$vowel)[c(6,5,4,3,2,1)]) -->
<!--   # Split (& set ID's separately so the x-axis is right) -->
<!--   pmc.melt_g <- pmc.melt[pmc.melt$consonant==1,] -->
<!--   pmc.melt_g$ID <- factor(paste(pmc.melt_g$consonant,pmc.melt_g$speaker,pmc.melt_g$vowel),ordered=TRUE) -->
<!--   pmc.melt_b <- pmc.melt[pmc.melt$consonant==2,] -->
<!--   pmc.melt_b$ID <- factor(paste(pmc.melt_b$consonant,pmc.melt_b$speaker,pmc.melt_b$vowel),ordered=TRUE) -->
<!--   g.tok_g <- ggplot(gendat.vowmus_g,aes(x=mouse,y=vowel,fill=meancx)) +  -->
<!--     geom_tile() +  -->
<!--     ylab("Vowel") +  -->
<!--     scale_y_discrete(labels=c("/u/","/e/","/ae/","/a/","/o/","/I/"), -->
<!--                      position="right") + # reverse order to make the plot work -->
<!--     scale_fill_distiller(type   = "div", palette="RdGy", limits=c(0,1), -->
<!--                          breaks = c(0,0.5,1), labels=c("0%","50%","100%"), -->
<!--                          name   = "Accuracy")+ -->
<!--     facet_grid(speaker ~ .,scales="free_y",space="free_y") + -->
<!--     theme(panel.spacing     = unit(0,"npc"), -->
<!--           panel.background  = element_blank(),  -->
<!--           panel.grid.major  = element_blank(), -->
<!--           panel.grid.minor  = element_blank(), -->
<!--           plot.background   = element_blank(), -->
<!--           axis.line         = element_blank(), -->
<!--           axis.title.x      = element_blank(), -->
<!--           axis.text.x       = element_blank(), -->
<!--           axis.ticks.x      = element_blank(), -->
<!--           axis.title.y      = element_blank(), -->
<!--           axis.text.y       = element_text(size=rel(0.5)), -->
<!--           legend.position   = "none", -->
<!--           legend.text       = element_text(size=rel(0.5)), -->
<!--           legend.title      = element_blank(), -->
<!--           legend.key.height = unit(0.01,"npc"), -->
<!--           legend.background = element_blank(), -->
<!--           strip.text        = element_text(size=rel(0.6)), -->
<!--           plot.margin       = margin(0.04,0,0,0,unit="npc")) -->
<!--   g.tok_b <- ggplot(gendat.vowmus_b,aes(x=mouse,y=vowel,fill=meancx)) +  -->
<!--     geom_tile() +  -->
<!--     ylab("Vowel") +  -->
<!--     scale_y_discrete(labels=c("/u/","/e/","/ae/","/a/","/o/","/I/"), -->
<!--                      position="right") + -->
<!--     scale_fill_distiller(type="div", palette="RdGy", limits=c(0,1))+ -->
<!--     xlab("Mouse") + -->
<!--     facet_grid(speaker ~ .,scales="free_y",space="free_y") + -->
<!--     theme(panel.spacing.y  = unit(0,"npc"), -->
<!--           panel.spacing.x  = unit(0,"npc"), -->
<!--           panel.background = element_blank(),  -->
<!--           panel.grid.major = element_blank(), -->
<!--           panel.grid.minor = element_blank(), -->
<!--           plot.background  = element_blank(), -->
<!--           axis.line        = element_blank(), -->
<!--           axis.ticks.x     = element_blank(), -->
<!--           axis.text.x      = element_blank(), -->
<!--           axis.title.y     = element_blank(), -->
<!--           axis.text.y      = element_text(size=rel(0.5)), -->
<!--           axis.title.x     = element_blank(), -->
<!--           legend.position  = "none", -->
<!--           strip.text       = element_text(size=rel(0.6)), -->
<!--           plot.margin      = margin(0,0,0.04,0,unit="npc")) -->
<!--   # Add panels on right for consonants -->
<!--   g.tok_gtab <- ggplotGrob(g.tok_g) -->
<!--   g.tok_gtab <- gtable_add_cols(g.tok_gtab, unit(g.tok_gtab$widths[[5]],'cm'), 7) -->
<!--   g.tok_gtab <- gtable_add_grob(g.tok_gtab, -->
<!--                                 rectGrob(gp=gpar(col=NA, fill=gray(0.5))), -->
<!--                                 6,8,14, name="glab") -->
<!--   g.tok_gtab <- gtable_add_grob(g.tok_gtab, -->
<!--                                 textGrob("/g/", rot=-90, gp=gpar(col=gray(1))), -->
<!--                                 6,8,14, name="gtext") -->
<!--   g.tok_btab <- ggplotGrob(g.tok_b)  -->
<!--   # Add dendrogram first -->
<!--   g.dend_tab <- ggplotGrob(g.dendro) -->
<!--   g.dend_tab$heights[8] <- unit(0,"cm") -->
<!--   g.dend_tab$widths[3] <- unit(0,"cm") -->
<!--   g.tok_btab <- gtable_add_rows(g.tok_btab, unit(0.3, "inches"), 17) -->
<!--   g.tok_btab <- gtable_add_grob(g.tok_btab, g.dend_tab, -->
<!--                                 17,4,19,4,name="dendro") -->
<!--   g.tok_btab <- gtable_add_cols(g.tok_btab, unit(g.tok_btab$widths[[5]], 'cm'),7) -->
<!--   g.tok_btab <- gtable_add_grob(g.tok_btab, -->
<!--                                 rectGrob(gp=gpar(col=NA, fill=gray(0.5))), -->
<!--                                 4,8,14, name="blab") -->
<!--   g.tok_btab <- gtable_add_grob(g.tok_btab, -->
<!--                                 textGrob("/b/",rot=-90,gp=gpar(col=gray(1))), -->
<!--                                 4,8,14,name="btext") -->
<!--   ###### PC plots -->
<!--   # Calculate limits for bar -->
<!--   pc_lim <- max(abs(pmc.melt$mean.val)) -->
<!--   pc_lim <- c(-pc_lim,pc_lim) -->
<!--   g.pcw_g <- ggplot(data=pmc.melt_g,aes(x=ID,y=mean.val,fill=as.factor(speaker)))+ -->
<!--     scale_fill_manual(values=c("#000000","#757575","#000000","#757575","#000000"))+ -->
<!--     geom_bar(stat='identity')+ -->
<!--     coord_flip()+ -->
<!--     scale_x_discrete(limits=rev(levels(pmc.melt_g$ID)))+ -->
<!--     scale_y_continuous(limits=pc_lim)+ -->
<!--     facet_wrap(~X2)+ -->
<!--     theme( -->
<!--       panel.background = element_blank(),  -->
<!--       panel.grid.major = element_blank(), -->
<!--       panel.grid.minor = element_blank(), -->
<!--       plot.background  = element_blank(), -->
<!--       axis.text        = element_blank(), -->
<!--       axis.title       = element_blank(), -->
<!--       axis.line        = element_blank(), -->
<!--       axis.ticks       = element_blank(), -->
<!--       strip.text       = element_blank(), -->
<!--       strip.background = element_blank(), -->
<!--       plot.margin      = margin(0,0,0,0,unit="npc"), -->
<!--       panel.spacing.y  = unit(0,"npc"), -->
<!--       legend.position  = "none" -->
<!--     ) -->
<!--   g.pcw_b <- ggplot(data=pmc.melt_b,aes(x=ID,y=mean.val,fill=as.factor(speaker)))+ -->
<!--     scale_fill_manual(values=c("#000000","#757575","#000000","#757575","#000000"))+ -->
<!--     geom_bar(stat='identity')+ -->
<!--     coord_flip()+ -->
<!--     scale_x_discrete(limits=rev(levels(pmc.melt_b$ID)))+ -->
<!--     scale_y_continuous(limits=pc_lim)+ -->
<!--     facet_wrap(~X2)+ -->
<!--     theme( -->
<!--       panel.background = element_blank(),  -->
<!--       panel.grid.major = element_blank(), -->
<!--       panel.grid.minor = element_blank(), -->
<!--       plot.background  = element_blank(), -->
<!--       axis.text        = element_blank(), -->
<!--       legend.position  = "none", -->
<!--       axis.title       = element_blank(), -->
<!--       axis.line        = element_blank(), -->
<!--       axis.ticks       = element_blank(), -->
<!--       strip.text       = element_blank(), -->
<!--       strip.background = element_blank(), -->
<!--       plot.margin      = margin(0,0,0,0,unit="npc"), -->
<!--       panel.spacing.y  = unit(0,"npc") -->
<!--     ) -->
<!--   # Flip values so they align w/ heatmap orientation -->
<!--   pmc.x$genbias <- pmc.x$genbias * -1 -->
<!--   ###### Now the scatter/line plots of PC loadings vs. bias/accuracy. -->
<!--   g.pc1 <- ggplot(data=pmc.x,aes(x=PC1,y=genbias))+ -->
<!--     geom_point(aes(shape=cohort))+ -->
<!--     scale_shape_manual(values=c(16,1))+ -->
<!--     geom_smooth(method=lm,se=FALSE,size=0.75,color="black")+ -->
<!--     labs(x="PC1 Loading",y="Bias")+ -->
<!--     scale_y_continuous(breaks=c(-0.2,-0.1,0,0.1),labels=c("+20% /g/","+10% /g/","0%","+10% /b/"))+ -->
<!--     theme( -->
<!--       panel.background = element_blank(),  -->
<!--       panel.grid.major = element_blank(), -->
<!--       panel.grid.minor = element_blank(), -->
<!--       plot.background  = element_blank(), -->
<!--       legend.position  = "none", -->
<!--       axis.line        = element_blank(), -->
<!--       plot.margin      = margin(0,0,1,3,unit="pt"), -->
<!--       panel.spacing.y  = unit(0,"npc") -->
<!--     ) -->
<!--   g.pc2 <- ggplot(data=pmc.x,aes(x=PC2,y=meancx))+ -->
<!--     geom_point(aes(shape=cohort))+ -->
<!--     scale_shape_manual(values=c(16,1))+ -->
<!--     geom_smooth(method=lm,se=FALSE,size=0.75,color="black")+ -->
<!--     labs(x="PC2 Loading",y="% Correct")+ -->
<!--     scale_y_continuous(limits=c(0.60,0.85),breaks=c(0.65,0.75,0.85),labels=c("65%","75%","85%"))+ -->
<!--     theme( -->
<!--       panel.background = element_blank(),  -->
<!--       panel.grid.major = element_blank(), -->
<!--       panel.grid.minor = element_blank(), -->
<!--       plot.background  = element_blank(), -->
<!--       legend.position  = "none", -->
<!--       axis.line        = element_blank(), -->
<!--       plot.margin      = margin(1,0,0,3,unit="pt"), -->
<!--       panel.spacing.y  = unit(0,"npc") -->
<!--     ) -->
<!--   ## Combine heatmap and PCplots -->
<!--   # Get pc grobs -->
<!--   g.pcw_gtab <- ggplotGrob(g.pcw_g) -->
<!--   g.pcw_btab <- ggplotGrob(g.pcw_b) -->
<!--   g.pc1_tab  <- ggplotGrob(g.pc1) -->
<!--   g.pc2_tab  <- ggplotGrob(g.pc2) -->
<!--   # Add columns to heatmap grids -->
<!--   g.tok_gtab <- gtable_add_cols(g.tok_gtab,rep(unit(0.2,"npc"),2),0) -->
<!--   g.tok_btab <- gtable_add_cols(g.tok_btab,rep(unit(0.2,"npc"),2),0) -->
<!--   # Add PC plots to heatmaps -->
<!--   g.tok_gtab <- gtable_add_grob(g.tok_gtab, -->
<!--                                 g.pcw_gtab, -->
<!--                                 6,1,17,2,name="gtok") -->
<!--   g.tok_btab <- gtable_add_grob(g.tok_btab, -->
<!--                                 g.pcw_btab, -->
<!--                                 4,1,15,2,name="gtok") -->
<!--   # Add labels above PC plots -->
<!--   g.tok_gtab <- gtable_add_rows(g.tok_gtab, unit(0.2,"inches"), 4) -->
<!--   g.tok_gtab <- gtable_add_grob(g.tok_gtab, -->
<!--                                 rectGrob(gp=gpar(col=NA,fill=gray(0.5))), -->
<!--                                 5,1,5,name="pc1box") -->
<!--   g.tok_gtab <- gtable_add_grob(g.tok_gtab, -->
<!--                                 rectGrob(gp=gpar(col=NA,fill=gray(0.5))), -->
<!--                                 5,2,5,name="pc2box") -->
<!--   g.tok_gtab <- gtable_add_grob(g.tok_gtab, -->
<!--                                 textGrob("PC1",gp=gpar(col=gray(1))), -->
<!--                                 5,1,5,name="pc1") -->
<!--   g.tok_gtab <- gtable_add_grob(g.tok_gtab, -->
<!--                                 textGrob("PC2",gp=gpar(col=gray(1))), -->
<!--                                 5,2,5,name="pc2") -->
<!--   # Add scale bar -->
<!--   colvals <- data.frame(xvals=seq(0,1,0.01),yvals=as.factor(rep(0,101))) -->
<!--   g.scale <- ggplot(data=colvals,aes(x=xvals,y=yvals,fill=xvals))+ -->
<!--     scale_fill_distiller(type="div", palette="RdGy", limits=c(0,1))+ -->
<!--     geom_raster(interpolate=TRUE)+ -->
<!--     scale_x_continuous(expand=c(0,0))+ -->
<!--     annotate("text", x=0.1, y=1, label = "0%",colour = "white", size=3.5)+ -->
<!--     annotate("text", x=0.85, y=1, label = "100%", colour= "white", size = 3.5)+ -->
<!--     theme_void()+ -->
<!--     theme(legend.position="none", -->
<!--           plot.margin = margin(0,0,0,0,unit="npc")) -->
<!--   g.scalegrob <- ggplotGrob(g.scale) -->
<!--   g.scalegrob$widths[3] <- unit(0,"npc") -->
<!--   g.scalegrob$heights[7] <- unit(0,"npc") -->
<!--   g.tok_gtab <- gtable_add_grob(g.tok_gtab, -->
<!--                                 g.scalegrob, -->
<!--                                 5,6,5,6,name="scale") -->
<!--   # Combine/Align scatterplots -->
<!--   g.pc2_tab$widths <- g.pc1_tab$widths -->
<!--   g.pcs <- gtable(widths=unit(c(2),"null"),height=unit(c(1,1),"null")) -->
<!--   g.pcs <- gtable_add_grob(g.pcs,g.pc1_tab,1,1) -->
<!--   g.pcs <- gtable_add_grob(g.pcs,g.pc2_tab,2,1) -->
<!--   g.tokpc <- arrangeGrob(g.tok_gtab,g.tok_btab,g.pcs,ncol=1,widths=unit(3.6,"inches"),heights=unit(c(2.45,2.55,2.5),"inches")) -->
<!--   grid.newpage() -->
<!--   grid.draw(g.tokpc) -->
<!-- ``` -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="functions-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
