---
title: "2.2 - Data Wrangling"
author: "Jonny Saunders"
date: "10/2/2017"
output: 
  md_document:
    preserve_yaml: true
    toc: true
    toc_depth: 2
order: 3
---

-   [Loading data](#loading-data)
    -   [One day we will have a summary table
        here](#one-day-we-will-have-a-summary-table-here)
    -   [.csv files](#csv-files)
    -   [.sav files](#sav-files)
    -   [`rio` for general import](#rio-for-general-import)
-   [Saving data](#saving-data)
    -   [.RData files](#rdata-files)
    -   [`sink`](#sink)
-   [Indexing](#indexing)
    -   [Logical indexing](#logical-indexing)
    -   [Assignment with Indexing](#assignment-with-indexing)
-   [Manipulating Data](#manipulating-data)
    -   [Wide vs. Long Data](#wide-vs.-long-data)
    -   [Piping syntax](#piping-syntax)
    -   [Reshaping Data](#reshaping-data)
-   [Resources](#resources)

Loading data
============

One day we will have a summary table here
-----------------------------------------

Most of the time we have a datafile (either on our hard drive or on the
internet) that we want to work with in R. To do that, we can use a
function to read the data into R. For instance, the **`read.table()`**
is a flexible function for reading in data in various formats.

.csv files
----------

In order to use **`read.table()`**, you will typically need to specify
some of the arguments, such as the argument **`sep =`**, which is where
you specify the thing that seperates values in your data file.

For example, if you are working with a data file in the comma seperated
values (csv) format, you would need to specify that commas are the
seperator with **`sep = ","`**.

### Defaults

Thankfully, other people have done this for us, and have created
functions that have the proper defaults to work with common formats like
csv fles. For csv files, To see the defaults, simply check the
documentation with e.g. **`?read.table`**

**`read.csv()`** is basically a version of **`read.table()`** with the
defaults set up to work well with csv files. These defaults include
setting **","** as the seperator, and setting **`header = TRUE`**, which
means that R will read in the first row in the csv file as being a
header row, and treat that row as the row of column names. These
defaults can be changed though, so if you had a file with no header, you
would indicate that with **`header = FALSE`**, like so

`read.csv(file_path/file_name.csv, header = FALSE)`

where file\_path is the full path to the file, and file\_name is the
name of the data file. Take a look at the documentation for `read.csv()`
with `?read.csv()` to see the different arguments and defaults.

### A brief interlude into formats for data in R

There are lots of options for reading data into R, even for a single
format.

For example, we could instead use **`read_csv()`** from the **`readr`**
package. The main difference between **`read.csv()`** and
**`read_csv()`** is that they load the data into different formats in R.
**`read.csv()`** will read your data in as a **`data.frame`**, which is
a common format of data in R.

**`read_csv()`** will read your data in as a **`tibble`**, which is the
data format associated with the tidyverse. There are a couple of
differences between these formats. They have different printing
defaults, there are differences in subsetting, and differences in
recycling. Check out the documentation by running the code
**`vignette("tibble")`** or by checking out the chapter on tibbles in
the R for Data Science Book <http://r4ds.had.co.nz/tibbles.html>.

Outside of these differences, they are mostly interchangeable (for most
purposes), but occassionally a function will only work properly with one
or the other. For example, the **`reshape()`** function only works
properly with *data.frames* (unless that has changed in an update).

### Format issues?

In some rare cases, you may be getting an error due to differences
between how your data is formatted in R and what format the function
you're attempting to use works with.

This will sometimes be spelled out in the documentation (e.g.,
**`reshape`** says it takes data frames as the first argument), but its
not always clear; sometimes, you just need to test it out. If you do
need to go between different formats, that is easy to do in R with a
couple of functions. **`as.data.frame()`** will turn an object that can
be a dataframe into a dataframe. **`as_tibble`** will turn an object
that can be a tibble into a tibble.

.sav files
----------

R can also work with datafiles that are formatted for SPSS, which have
the extension '.sav'.

Like csv's, there are a few options. The one that seems to work the best
is **`read_spss()`** from the haven package (also a part of the
tidyverse). There is also a function called **`read.spss()`** from the
**`foreign`** package, but it is no longer being maintained and may stop
working; it also had some frustrating qualities, so probably best to
stick to **`read_spss()`**. It's worth noting that **`read_spss()`**
will format your data as a **`tibble`**. If you don't want it as a
**`tibble`**, you can always use the **`as.data.frame()`** function to
turn it into a generic **`data.frame`**.

`rio` for general import
------------------------

Another function worth knowing about for reading in data is the
**`import()`** function from the **`rio`** package. The nice thing about
**`import()`** is that it works with lots of different types of
datafiles, and very little has to be changed for each type of datafile.
For example, if our data (let's say its name is 'df') were a .sav file,
we would read it in with the following command:

`import(df.sav)`

If it were instead a csv, we would use the following command:

`import(df.csv)`

Note that virtually nothing changed, just the file extension (which is
part of the name of the file). **`import()`** is able to figure out the
format of the file based on that extension.

**Remember to assign your data to a variable in the environment!**

A pretty common and frustrating mistake people make when starting with R
is not saving their data file as an object. For example, if we were
loading in our datafile called 'df', we may want to run some code like
this:

`import(df.csv)`

However, this is telling R to just read the data. If you run code like
that, it will simply read the data, and print out the data (or some
subset of it) into the console. Then, when you go to work with the data,
it won't be in your global environment. That's because you didn't save
it as an object. You would do that the same way you save anything as an
object, with the assignment operator: `<-`. So instead of the above,
you'd instead want to run something like the following:

`df <- import(df.csv)`

Now R has read our data and stored it as an object called `df`, that we
can start running our models on.

Saving data
===========

Most of the above functions have complementary `write` functions, for
example `write.csv` or `haven::write_sav`. There are two other common
ways you may want to save your data

.RData files
------------

Because all objects in R descend from a precious few C structures, they
can all be easily **serialized**, or converted into a string of bits
that can be written to disk (not always true in other languages, like
Python). These files typically can't be read by anything but R (except
if that thing is another programming language where someone has written
a specific routine to do so!), so if your mom tries to look at your cool
data in openoffice they'll be out of luck.

Saving (and loading) .RData files works with the ... `save` and ...
`load` functions

    cant_forget <- c("you have to stop wiping your nose with just whatever is close at hand",
                     "see you did it just now that was mine")
    save(cant_forget, file="cant_forget.RData")

    # Now delete the object so we know our load is real
    rm(cant_forget)

    # here we load to the .GlobalEnv, don't worry we'll cover environments later
    load("cant_forget.RData")
    cant_forget

    ## [1] "you have to stop wiping your nose with just whatever is close at hand"
    ## [2] "see you did it just now that was mine"

Note: as is true of all files, the extension (ending it with 'RData')
doesn't effect the way that a file is saved or represented on the disk,
it just serves to tell the operating system which programs can open it,
and to tell other programs how they should open it. You could just as
easily save your object like

    save(cant_forget, file="cant_forget.butiwantto")

There is one special .RData file, and that's the file that's just called
".RData" in your user directory (for osx `/Users/Username` -- probably
hidden by default). R automatically loads this file every time it opens
-- this is the file that is made whenever you accept RStudio's frequent
offers to save your workspace image.

`save` is also capable of using a few common compression algorithms.
This is most useful for large objects that have many repeated values --
common with "long" format data.

    save(cant_forget, file="cant_forget.RData",
         compress=TRUE, # or "gzip", "bzip2", "xz"
         compression_level=6) # more is smaller, but slower

If you're curious, check out the `saveRDS` function - it's designed to
save single objects (rather than `save`, which can save arbitrary
numbers of objects by keeping them in an environment). Since `save`
saves the object and its environment, when it is loaded it will have the
same name -- this can be troublesome when you have already used that
name, or when you forget what the name is. Loading objects (`readRDS`)
saved by `saveRDS` works like other loading functions, so you can assign
the loaded object to whatver name you'd like.

    saveRDS(cant_forget, file="cant_forget.rds")

    # We can rewrite our fate.
    sad_news <- readRDS("cant_forget.rds")

`sink`
------

Perhaps common is an overstatement. Consider these the option of last
resort when all you want to do is put what you see in this window in
some other window and ya don't care how ya do it.

Any output that would go to the console (specifically to `stdout` - try
`?stdout` - so it's a bit tricky to open a sink in a code chunk) can be
diverted to a file by using the `sink` function. You must call `sink`
with a filename to start diverting data, and then call `sink` again to
stop.

    # Open the sink
    sink("save-everything-here.txt")

    life_story <- c("what we need at the store 2day guys", "it's always just apples and bananas", "we have severe vitamin deficiencies")
    life_story

    ## [1] "what we need at the store 2day guys"
    ## [2] "it's always just apples and bananas"
    ## [3] "we have severe vitamin deficiencies"

    # turn off the sink
    sink()

    # now see what's in our file
    readLines("save-everything-here.txt")

    ## character(0)

`sink` doesn't work with graphical output, to do that we have to use a
function that dumps to a graphics driver, which then saves it as a file.
We can see our current graphics device by getting that option...

    getOption("device")

    ## function (width = 7, height = 7, ...) 
    ## {
    ##     grDevices::pdf(NULL, width, height, ...)
    ## }
    ## <environment: namespace:knitr>

The devices available in the base package are:

-   `pdf()`
-   `postscript()`
-   `xfig()`
-   `bitmap()`
-   `pictex()`

For example

    # make n save a cool plot to show your friends
    pdf("put-plots-here.pdf")
    plot(seq(1,5))
    dev.off()

    ## png 
    ##   2

    # open the pdf however yer system wants to
    abs_path <- file.path(getwd(), "put-plots-here.pdf")
    system2('open', args=abs_path, wait=FALSE)

Notice how we have to use `dev.off()` rather than calling `pdf()` again
as would be expected from `sink`

Indexing
========

Or, how to get specific pieces of stuff.

We've already seen a bunch of basic indexing

    # try ?seq
    x <- seq(5, 25, 5)
    x

    ## [1]  5 10 15 20 25

    y <- array(1:24, dim=c(3,8))
    y

    ##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8]
    ## [1,]    1    4    7   10   13   16   19   22
    ## [2,]    2    5    8   11   14   17   20   23
    ## [3,]    3    6    9   12   15   18   21   24

    z <- list("scores"=c(1,2,3,4,5), 
              "numbers"=c(6,7,8,9,10))

    # good ole positional indexing
    x[3]

    ## [1] 15

    # indexing with a vector to select multiple positions
    x[c(3,5)]

    ## [1] 15 25

    # higher dimensional objects have more dimensions to index
    y[1,5]

    ## [1] 13

    # both together
    y[3, c(3,4,7)]

    ## [1]  9 12 21

    # leaving a position blank selects all of its indices
    y[2,]

    ## [1]  2  5  8 11 14 17 20 23

    # with names
    names(x) <- c("adam", "steve", "harry", "ted", "watson")
    x["harry"]

    ## harry 
    ##    15

    z["numbers"]

    ## $numbers
    ## [1]  6  7  8  9 10

    # Using double brackets to return a vector instead of a list
    z[["numbers"]]

    ## [1]  6  7  8  9 10

    # and the equivalent dollar sign
    z$scores

    ## [1] 1 2 3 4 5

Negative values deselect

    x[-3]

    ##   adam  steve    ted watson 
    ##      5     10     20     25

    # useful to select starting from the end
    -(1:3) # quick way to construct sequences of negative numbers

    ## [1] -1 -2 -3

    x[-(1:3)] # get the last two

    ##    ted watson 
    ##     20     25

We have also seen chained indexing, think of it like indexing the
product of each successive indexing operation

    x[c(1,3,5)][2]

    ## harry 
    ##    15

    z[["numbers"]][4]

    ## [1] 9

    # one reason why it's important what class is returned from your indexing operation
    # aka knowing why we use double brackets
    z["numbers"][4]

    ## $<NA>
    ## NULL

dplyr has a `select` function and a collection of tools ("select
helpers") to make selecting variables by name a bit more flexible:

-   `starts_with()`
-   `ends_with()`
-   `contains()`
-   `matches()` - variables that match a regular expression
-   `num_range()` - eg `num_range("x",1:5)` to select `x1, x2, ...`
-   `one_of()` - find variables in a list, eg.
    `one_of(c("calcium", "potassium", "magnesium"))`
-   `everything()` - all variables, don't know why you'd use this.

A few examples...

    library(dplyr)

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

    df <- ggplot2::diamonds
    names(df)

    ##  [1] "carat"   "cut"     "color"   "clarity" "depth"   "table"   "price"  
    ##  [8] "x"       "y"       "z"

    head(select(df, starts_with("c")))

    ## # A tibble: 6 x 4
    ##   carat       cut color clarity
    ##   <dbl>     <ord> <ord>   <ord>
    ## 1  0.23     Ideal     E     SI2
    ## 2  0.21   Premium     E     SI1
    ## 3  0.23      Good     E     VS1
    ## 4  0.29   Premium     I     VS2
    ## 5  0.31      Good     J     SI2
    ## 6  0.24 Very Good     J    VVS2

    head(select(df, one_of(c("color", "hue", "luminance", "clarity"))))

    ## Warning: Unknown variables: `hue`, `luminance`

    ## # A tibble: 6 x 2
    ##   color clarity
    ##   <ord>   <ord>
    ## 1     E     SI2
    ## 2     E     SI1
    ## 3     E     VS1
    ## 4     I     VS2
    ## 5     J     SI2
    ## 6     J    VVS2

Logical indexing
----------------

In addition to specifying what we want by position, we can specify what
we want by using a vector of booleans (`TRUE`, `FALSE`) the same length
as the object

    x[3]

    ## harry 
    ##    15

    x[c(FALSE, FALSE, TRUE, FALSE, FALSE)]

    ## harry 
    ##    15

This is useful when combined with logical statements (see
`?base::Logic`) and comparisons (see `?Comparison`). One makes logical
statements or comparisons with these operators:

<table>
<thead>
<tr class="header">
<th>Operator</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>!x</code></td>
<td>not x</td>
</tr>
<tr class="even">
<td><code>x &amp; y</code>, <code>x &amp;&amp; y</code></td>
<td>x and y (vectorized, single comparison)</td>
</tr>
<tr class="odd">
<td><code>x | y</code>, <code>x || y</code></td>
<td>x or y (vectorized, single comparison)</td>
</tr>
<tr class="even">
<td><code>xor(x, y)</code></td>
<td>exclusive or (x or y but not both)</td>
</tr>
<tr class="odd">
<td><code>x &lt; y</code></td>
<td>x less than y</td>
</tr>
<tr class="even">
<td><code>x &lt;= y</code></td>
<td>x less than or equal to y</td>
</tr>
<tr class="odd">
<td><code>x &gt; y</code></td>
<td>x greater than y</td>
</tr>
<tr class="even">
<td><code>x &gt;= y</code></td>
<td>x greater than or equal to y</td>
</tr>
<tr class="odd">
<td><code>x == y</code></td>
<td>x is equal to y</td>
</tr>
<tr class="even">
<td><code>x != y</code></td>
<td>x is not equal to y</td>
</tr>
</tbody>
</table>

These will all output boolean vectors, more examples

    x > 10

    ##   adam  steve  harry    ted watson 
    ##  FALSE  FALSE   TRUE   TRUE   TRUE

    x >= 10

    ##   adam  steve  harry    ted watson 
    ##  FALSE   TRUE   TRUE   TRUE   TRUE

    # logical operators can be combined
    (x > 10) & (x < 20)

    ##   adam  steve  harry    ted watson 
    ##  FALSE  FALSE   TRUE  FALSE  FALSE

    # the single & will compare each element
    cbind((x>10), (x<20),((x>10) & (x<20)))

    ##         [,1]  [,2]  [,3]
    ## adam   FALSE  TRUE FALSE
    ## steve  FALSE  TRUE FALSE
    ## harry   TRUE  TRUE  TRUE
    ## ted     TRUE FALSE FALSE
    ## watson  TRUE FALSE FALSE

    # double &&s will only compare the first element - use it when you are trying to evaluate whether a single thing is true or false, eg. is this value greater than one? are my vectors the same length?
    (max(x) > 20) && (min(x) <= 5)

    ## [1] TRUE

This can be used in indexing, either by explicitly referring to the
object within the indexing operator, or by using the `with` function

    # Get all the rows in diamonds who are Good or Very Good
    # remember the comma at the end, we want to select all columns
    df[df$cut=="Good" | df$cut=="Very Good",]

    ## # A tibble: 16,988 x 10
    ##    carat       cut color clarity depth table price     x     y     z
    ##    <dbl>     <ord> <ord>   <ord> <dbl> <dbl> <int> <dbl> <dbl> <dbl>
    ##  1  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
    ##  2  0.31      Good     J     SI2  63.3    58   335  4.34  4.35  2.75
    ##  3  0.24 Very Good     J    VVS2  62.8    57   336  3.94  3.96  2.48
    ##  4  0.24 Very Good     I    VVS1  62.3    57   336  3.95  3.98  2.47
    ##  5  0.26 Very Good     H     SI1  61.9    55   337  4.07  4.11  2.53
    ##  6  0.23 Very Good     H     VS1  59.4    61   338  4.00  4.05  2.39
    ##  7  0.30      Good     J     SI1  64.0    55   339  4.25  4.28  2.73
    ##  8  0.30      Good     J     SI1  63.4    54   351  4.23  4.29  2.70
    ##  9  0.30      Good     J     SI1  63.8    56   351  4.23  4.26  2.71
    ## 10  0.30 Very Good     J     SI1  62.7    59   351  4.21  4.27  2.66
    ## # ... with 16,978 more rows

    # you can combine boolean vectors arbitrarily

    df[df$cut=="Good" & df$carat>1,]

    ## # A tibble: 1,579 x 10
    ##    carat   cut color clarity depth table price     x     y     z
    ##    <dbl> <ord> <ord>   <ord> <dbl> <dbl> <int> <dbl> <dbl> <dbl>
    ##  1  1.01  Good     I      I1  63.1    57  2844  6.35  6.39  4.02
    ##  2  1.01  Good     H      I1  64.2    61  2846  6.25  6.18  3.99
    ##  3  1.03  Good     J     SI1  63.6    57  2855  6.38  6.29  4.03
    ##  4  1.04  Good     I     SI2  59.9    64  2970  6.51  6.45  3.88
    ##  5  1.01  Good     E      I1  63.8    57  3032  6.40  6.33  4.06
    ##  6  1.02  Good     E      I1  63.1    60  3051  6.31  6.40  4.01
    ##  7  1.01  Good     J     SI2  63.7    60  3088  6.40  6.29  4.05
    ##  8  1.29  Good     I      I1  64.2    54  3098  6.93  6.83  4.42
    ##  9  1.52  Good     E      I1  57.3    58  3105  7.53  7.42  4.28
    ## 10  1.52  Good     E      I1  57.3    58  3105  7.53  7.42  4.28
    ## # ... with 1,569 more rows

    # select columns in the usual way too
    head(df[df$cut=="Good" & df$carat>1, 2])

    ## # A tibble: 6 x 1
    ##     cut
    ##   <ord>
    ## 1  Good
    ## 2  Good
    ## 3  Good
    ## 4  Good
    ## 5  Good
    ## 6  Good

    head(df[df$cut=="Good" & df$carat>1, "color"])

    ## # A tibble: 6 x 1
    ##   color
    ##   <ord>
    ## 1     I
    ## 2     H
    ## 3     J
    ## 4     I
    ## 5     E
    ## 6     E

    head(df[df$cut=="Good" & df$carat>1,]$color)

    ## [1] I H J I E E
    ## Levels: D < E < F < G < H < I < J

    # %in% is a useful way to select multiple levels of a factor
    head(df[df$cut %in% c("Good", "Very Good"),])

    ## # A tibble: 6 x 10
    ##   carat       cut color clarity depth table price     x     y     z
    ##   <dbl>     <ord> <ord>   <ord> <dbl> <dbl> <int> <dbl> <dbl> <dbl>
    ## 1  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
    ## 2  0.31      Good     J     SI2  63.3    58   335  4.34  4.35  2.75
    ## 3  0.24 Very Good     J    VVS2  62.8    57   336  3.94  3.96  2.48
    ## 4  0.24 Very Good     I    VVS1  62.3    57   336  3.95  3.98  2.47
    ## 5  0.26 Very Good     H     SI1  61.9    55   337  4.07  4.11  2.53
    ## 6  0.23 Very Good     H     VS1  59.4    61   338  4.00  4.05  2.39

    # with temporarily attaches our dataframe so we don't have to keep referring to it explicitly
    head(with(df, df[cut %in% c("Good", "Very Good"),]))

    ## # A tibble: 6 x 10
    ##   carat       cut color clarity depth table price     x     y     z
    ##   <dbl>     <ord> <ord>   <ord> <dbl> <dbl> <int> <dbl> <dbl> <dbl>
    ## 1  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
    ## 2  0.31      Good     J     SI2  63.3    58   335  4.34  4.35  2.75
    ## 3  0.24 Very Good     J    VVS2  62.8    57   336  3.94  3.96  2.48
    ## 4  0.24 Very Good     I    VVS1  62.3    57   336  3.95  3.98  2.47
    ## 5  0.26 Very Good     H     SI1  61.9    55   337  4.07  4.11  2.53
    ## 6  0.23 Very Good     H     VS1  59.4    61   338  4.00  4.05  2.39

A boolean vector can be converted back to a numerical position vector
with `which`

    x > 10

    ##   adam  steve  harry    ted watson 
    ##  FALSE  FALSE   TRUE   TRUE   TRUE

    which(x > 10)

    ##  harry    ted watson 
    ##      3      4      5

Assignment with Indexing
------------------------

Sometimes we need to change some values in an existing object, but all
assignments to existing objects have to have the same shape and class.
If you give something too small, it will be repeated Rather than having
to create a new object, we can assign to an indexed subset of an object

    friends <- data.frame(names=c("toothbrush", "vacuum", "blinds"),
                          hobbies=c("brushing", "spinning", "darkening"),
                          favorites=c(1,2,3))

    # too small :(
    friends$favorites <- c(4,5)

    ## Error in `$<-.data.frame`(`*tmp*`, favorites, value = c(4, 5)): replacement has 2 rows, data has 3

    # toothbrush and vacuum get a demotion
    friends[c(1,2),]$favorites <- c(4,5)

Manipulating Data
=================

Now that you have your data in R, and have maybe subsetted it in some
manner, you may want to manipulate the data. In this section, we'll
cover some ways that you might want to manipulate data, including
manipulating the format of the data and creating new variables (both
from combining/splitting existing variables, and creating new ones if
you need to).

Wide vs. Long Data
------------------

Let's start by talking about one of the more common data format issues,
which is whether data are structured in a *long* or *wide* format.
These, like basically all things, exist on a continuum (data is almost
always somewhere in between the extremes of long and wide). So, it's
probably helpful to start with an example.

One common design that leads to data easily represented as wide or long
is longitudinal data. Let's say we administer the Big Five Inventory - 2
(BFI-2; Soto & John, 2016) to a sample of incoming freshman annually for
4 years. To keep things simple, let's say we only have that data
(nothing else was administered). In this case, you may have a dataset
that looks like this:

    ## Loading tidyverse: ggplot2
    ## Loading tidyverse: tibble
    ## Loading tidyverse: tidyr
    ## Loading tidyverse: readr
    ## Loading tidyverse: purrr

    ## Conflicts with tidy packages ----------------------------------------------

    ## filter(): dplyr, stats
    ## lag():    dplyr, stats

    ## # A tibble: 100 x 21
    ##      pid agreeableness_t1 conscientiousness_t1 neuroticism_t1
    ##    <dbl>            <dbl>                <dbl>          <dbl>
    ##  1     1         3.295400             2.501786       1.538106
    ##  2     2         3.348223             3.214239       2.793563
    ##  3     3         3.171709             3.319660       2.703627
    ##  4     4         2.727071             2.010532       1.055255
    ##  5     5         2.313266             3.312556       3.085609
    ##  6     6         3.620608             3.214379       3.977915
    ##  7     7         1.201265             2.988343       2.507895
    ##  8     8         2.666801             3.815197       3.335316
    ##  9     9         2.467433             4.656694       1.964536
    ## 10    10         2.895284             2.388371       2.320890
    ## # ... with 90 more rows, and 17 more variables: extraversion_t1 <dbl>,
    ## #   openness_t1 <dbl>, agreeableness_t2 <dbl>, conscientiousness_t2 <dbl>,
    ## #   neuroticism_t2 <dbl>, extraversion_t2 <dbl>, openness_t2 <dbl>,
    ## #   agreeableness_t3 <dbl>, conscientiousness_t3 <dbl>,
    ## #   neuroticism_t3 <dbl>, extraversion_t3 <dbl>, openness_t3 <dbl>,
    ## #   agreeableness_t4 <dbl>, conscientiousness_t4 <dbl>,
    ## #   neuroticism_t4 <dbl>, extraversion_t4 <dbl>, openness_t4 <dbl>

    ## Classes 'tbl_df', 'tbl' and 'data.frame':    100 obs. of  21 variables:
    ##  $ pid                 : num  1 2 3 4 5 6 7 8 9 10 ...
    ##  $ agreeableness_t1    : num  3.3 3.35 3.17 2.73 2.31 ...
    ##  $ conscientiousness_t1: num  2.5 3.21 3.32 2.01 3.31 ...
    ##  $ neuroticism_t1      : num  1.54 2.79 2.7 1.06 3.09 ...
    ##  $ extraversion_t1     : num  3.85 3.9 1.95 2.1 2.16 ...
    ##  $ openness_t1         : num  2.23 2.63 1.71 3.45 4.66 ...
    ##  $ agreeableness_t2    : num  3.76 4.15 3.65 3.2 2.81 ...
    ##  $ conscientiousness_t2: num  3.01 3.83 3.7 2.41 3.74 ...
    ##  $ neuroticism_t2      : num  2.09 3.67 3.07 1.69 3.9 ...
    ##  $ extraversion_t2     : num  4.14 4.02 2.66 2.85 2.67 ...
    ##  $ openness_t2         : num  2.85 2.92 2.37 3.96 5.15 ...
    ##  $ agreeableness_t3    : num  4.09 4.59 4.33 3.61 3.19 ...
    ##  $ conscientiousness_t3: num  3.61 4.12 4.51 2.55 4.41 ...
    ##  $ neuroticism_t3      : num  2.61 4.15 3.92 2.17 4.51 ...
    ##  $ extraversion_t3     : num  4.79 4.74 3.14 3.32 3.26 ...
    ##  $ openness_t3         : num  3.26 3.56 2.91 4.18 5.59 ...
    ##  $ agreeableness_t4    : num  4.63 5.41 4.6 4.24 3.58 ...
    ##  $ conscientiousness_t4: num  4.27 4.79 4.85 3.07 4.63 ...
    ##  $ neuroticism_t4      : num  2.86 4.24 4.23 2.91 5.17 ...
    ##  $ extraversion_t4     : num  4.99 5.38 3.52 3.7 3.78 ...
    ##  $ openness_t4         : num  3.98 3.9 3.38 4.52 6.15 ...

As you can see in the above, we have a row for each participant, and a
column corresponding to each Big 5 score at each time point. For
example, column 2 contains each participant's score on Agreeableness at
time 1, column 7 contains each participant's score on Agreeableness at
time 2, etc.

This data is in a *wide* format. It's also in basically the widest
format it could be in for any reasonable purpose; the only way to make
it wider would be to have a single row, and a column for each
participant X Big 5 score X time point.

What would make this data *long*? There are two dimensions that we could
lengthen the data on, but the more common one you might see is time.
That is, we'd have a row for each participant X time point combination,
like the following:

So we now have a row for each participant at each time point, and a
column for each of the Big 5. We could also make it a little longer, by
making each row correspond to a score on each Big Five trait for each
participant at each time point, like so:

    sample_b5_data_long %>%
      gather(trait, score, agreeableness:openness)

    ## # A tibble: 2,000 x 4
    ##      pid  time         trait    score
    ##    <dbl> <chr>         <chr>    <dbl>
    ##  1     1    t1 agreeableness 3.295400
    ##  2     1    t2 agreeableness 3.764385
    ##  3     1    t3 agreeableness 4.091583
    ##  4     1    t4 agreeableness 4.629702
    ##  5     2    t1 agreeableness 3.348223
    ##  6     2    t2 agreeableness 4.152176
    ##  7     2    t3 agreeableness 4.594936
    ##  8     2    t4 agreeableness 5.410165
    ##  9     3    t1 agreeableness 3.171709
    ## 10     3    t2 agreeableness 3.649307
    ## # ... with 1,990 more rows

Piping syntax
-------------

Before we get into reshaping data, its importantt we cover a type of
syntax called piping. Piping is not unique to R, but it is highly useful
in R, especially for data wrangling and manipulation. The pipe itself is
this symbol `%>%`, and in R, it comes from the *magrittr* package (this
is a references to the famous painging by Magritte,the treachery of
images). *magrittr* is part of the tidyverse, so it will load when you
call the tidyverse library.

### A quick sidenote about the term pipe

As mentioned above, a pipe in piping syntax is symbolized by `%>%`.
However, another character is sometimes called a pipe, which is the
vertical bar |, and this is used quite a bit in logical/boolean
operations (| means or in logical statements).

### The logic of piping syntax

The general idea of piping syntax, is that we have some function on the
lefthand and righthand side of the pipe. The function on the leftside is
evaluated, and then the **output** of that function is passed to the
function on the righthand side of the pipe as the first argument of that
function. Let's start with a simple example. We'll create a vector of
values and take the mean.

    # first set.seed, because we're going to be sampling values. 
    # this will make it so we always get the same result.
    set.seed(100)
    # first create a vector using rnorm. This is saying give me a random sample of 20 observations, drawn from a normal distribution with a mean of 5 and sd of 1.
    rnorm(n = 20, mean = 5, sd = 1) %>% mean()

    ## [1] 5.107867

As you can see, on the lefthand side of the pipe `%>%`, we have a
function that create a vector of 20 values (sampled from a normal
distribution, with a mean of 5 and an sd of 1). On the righthand side,
we simply have the function mean(), which calculates the mean of a
vector of values. And so what's happening, is first the function on the
righthand side creates a vector; the output of this function is simply
the vector of values:

    set.seed(100)
    rnorm(n=20, mean = 5, sd = 1)

    ##  [1] 4.497808 5.131531 4.921083 5.886785 5.116971 5.318630 4.418209
    ##  [8] 5.714533 4.174741 4.640138 5.089886 5.096274 4.798366 5.739840
    ## [15] 5.123380 4.970683 4.611146 5.510856 4.086186 7.310297

So the output of this fucntion, the vector of 20 values, is then passed
along to the mean function. The mean function requires a vector of
values for its first argument (see for yourself by running `?mean`). So,
we end the pipe with simply `mean()`, and this provides the mean.

#### A quick tip about style

It's typically considered good practice to not have more than one pipe
per line. So what I have above is considered bad coding style. So
instead of

    set.seed(100)
    rnorm(n = 20, mean = 5, sd = 1) %>% mean()

    ## [1] 5.107867

You should instead do this:

    set.seed(100)
    rnorm(n = 20, mean = 5, sd = 1) %>%
      mean()

    ## [1] 5.107867

### Logic of Piping Syntax continued

As we covered above, the function following the pipe takes the output of
the preceding function as its **first** argument. In the preceding
example, we didn't supply another argument, and so the righthand side of
the pipe was simply `mean()`. Let's say, we wanted to specify an
additional argument. One option in `mean()` is trim, which indicates the
proportion of values we want to trim from the vector before calculating
the mean. Let's say we wanted only half the data points; I have no idea
why someone would do something like this, especially with a vector of 20
values, but let's do it anyway.

    set.seed(100)
    # This is the same as before
    rnorm(n = 20, mean = 5, sd = 1) %>%
    # Notice that the mean() function now contains the argument trim = 0.5
        mean(trim = 0.5)

    ## [1] 5.09308

You'll see we got a slightly different value; a value a little closer to
the population mean of 5, since 50% of the values in the tails were
removed from the vectore before calculating the mean.

This can be pretty confusing when you're new to piping, because our
`mean()` function is basically missing an argument, namely, the argument
with the name of the vector of values. Importantly, the argument isn't
missing, it's just sort of hidden under the hood. The `mean()` line
above, to R, is actually looking something like this:
`mean(vector_output_above, trim = 0.5)`, it's just that the first
argument is hidden from view. We could do this in two steps, without
pipes.

    set.seed(100)
    # we could create the vectore, and save it as an object
    vector_from_pipe <- rnorm(n = 20, mean = 5, sd = 1)
    # and then take the mean
    mean(vector_from_pipe, trim = .5)

    ## [1] 5.09308

And we get the same trimmed mean. We could also do this with one step:

    set.seed(100)
    mean(rnorm(n = 20, mean = 5, sd = 1), trim = .5)

    ## [1] 5.09308

And we can see that we get the same result. Some of you may have noticed
that we have three different routes to the same destination. So why use
pipes?

### Why use pipes?

There are probably lots of reasons to use or not use pipes. The most
important and most often mentioned reason to use pipes is *cleanliness*
(which I hear is next to *godliness*). That is, pipes help make two
things clean:

1.  Your code
    -   This is nice, because it helps make your code more readable by
        other humans.
    -   Other humans include your future self, who may return to a code
        file 6 months or a year later, and want to know wtf the code
        is doing.

2.  Your environment
    -   When you use pipes, you have basically no reason to save objects
        from intermediary steps in your data wrangling / analysis
        workflow, because you can just pass output from function to
        function without saving it (recall when we broke apart the pipe
        into two steps above).

A related advantage of pipes:

1.  Efficiency
    -   This is efficiency for you, the person doing the coding (not
        more efficient computing)
    -   This advantage primarily comes from the fact that withhout
        pipes, you have to save objects from intermediary steps. This
        can create ineffencies and/or errors:
        -   Inefficiences stem from having to keep coming up with names
            for objects from intermediary steps.
        -   errors can crop up from re-using names (to be more
            efficient), which can easily lead to calling the wrong
            object in an analysis or over-writing one that you
            need later.

#### Cleaner code

With pipes, its often easier to make code that is cleaner, and easier
for other humans to read. The last part is important, because R doesnt
care if your code is clean (as long as its syntactically correct), but
clean code is easier for your collaborators (including future you) to
understand.

Why do pipes make cleaner code? An example may help with this. Compare
this:

    set.seed(100)

    mean(rnorm(n = 20, mean = 5, sd = 1), trim = .5)

to this:

    set.seed(100)

    rnorm(n = 20, mean = 5, sd = 1) %>%
        mean(trim = 0.5)

The second, piped, example is a little easier to parse. One reason is it
more closely matches the way we tend to think about analysis. In the
former example, we're saying take a mean, and what I want you to take a
mean of is this vector, and this is how I want you to make this vector
(random sample from a normal dist, etc.). In the latter, we're saying
make a vector like this (random sample, etc.), and then take its mean. I
find the latter is more similar to the way I think about the steps in an
analysis.

#### A cleaner environment

This is a smaller and less important advantage, but an advantage none
the less. Not having to save objects from intermediary steps means less
stuff crowding up you environment. Now, you don't have to save those
intermediary steps, but doing so will often make cleaner code. Pipes
maximize cleanliness of both your code and environment, so with pipes
you don't have to make this trade-off. Recall this example:

    set.seed(100)
    # we could create the vectore, and save it as an object
    vector_from_pipe <- rnorm(n = 20, mean = 5, sd = 1)
    # and then take the mean
    mean(vector_from_pipe, trim = .5)

We saved the vector me made with `rnorm()` so that we could pass that
vector to the `mean` function. Now this code is a little easier to read
than this code, that doesn't save the object:

    mean(rnorm(n = 20, mean = 5, sd = 1), trim = .5)

So the first chunk is easier to read, but clutters our environment,
while the second chunk is harder to read but creates less clutter. Which
is better? Who know. Pipes avoid making this tough decision, by making
cleaner code that doesn't clutter up our environment:

    rnorm(n = 20, mean = 5, sd = 1) %>%
      mean()

You may be wondering why a cluttered environment matters. The main thing
is that it can create ineffeciencies in two ways: 1. sometimes you want
to quickly glance over to your environment window to get some
information (like what you named that dataset); this is obviously harder
in a busier visual environment. 2. You can hit tab to autocomplete; the
more objects with similar names you have, the less efficient
autocomplete is.

#### Efficiency

This one is pretty straight forward. By not having to save objects from
intermediary steps, we have to come up with less names and remember less
names. Coming up with names is hard; remembering what names correspond
to what is harder. Both of these things will slow you down.

For example, we had to name the vector when we saved it in the above
example; this added about 2 seconds to my work in preparing this code.
Say we needed a new vector, that was the log transformed values of the
previous vetor. We might name that `log_vector_from_pipe`; this probably
added another 2 seconds. Now obviously, these are small additions of
time, but they add up. Plus, sometimes coming up with unique names gets
tough (when you're on the 5th or 6th or 10th vector that you have to
name)

#### A note about Scaling

One more thing to keep in mind is that gains in cleanliness and
efficiency scale with the complexity of what you're doing. Let's say, we
had a dataset that we wanted to take a subset of cases/rows from (those
where age is &gt; 25), and just a couple of just a couple of columns (a,
b, c, d), then we wanted to log transform that data, and then wanted to
get descriptives for all of the remaining variables.

Without pipes, you'll either end up with some difficult to read code:

    library(psych)
    describe(log(select(filter(data, age > 5), a, b, c, d)))

or some throwaway objects:

    library (psych)
    data_subset_age <- filter(data, age > 5)
    data_subset_age_abcd <- select(data_subset_age, a, b, c, d)
    log_data_subset_age_abcd <- log(data_subset_age_abcd)
    describe(log_data_subset_age_abcd)

With pipes, we can avoid these issues:

    data %>%
      filter(age > 25) %>%
      select(a, b, c, d) %>%
      describe()

See, so much easier to read, and not flooding our enviornment with
clutter and not taxing our already taxed minds with having to come up
with a bunch of damn names.

### Saving the output of your pipe

So far, we've been runing with example where we just ran functions in
pipes without saving the output. Sometimes this is useful, like if we
just wanted to see the descriptives in the above example (and didn't
want to do anything else with those descriptives). But, often we want to
take the output from the pipe and save it to an object so we can do
analyses with it later. For example, instead of just getting
descriptives, maybe we want a dataset that has only people above 25 and
columns a, b, c, d to use in analyses. We just add the assignment and
object name at the top, like so:

    age25plus_abcd <- data %>%
      filter(age > 25) %>%
      select(a, b, c, d)

Reshaping Data
--------------

At the start of the data manipulation section, we talked about long vs
wide data. Now let's talk about how to actually lengthen or widen or
data. We'll use the same dataset we made up for the starting example: 4
year longitudinal study where the Big Five were measured annually.

### Wide to Long

We'll start with lengthening our data. We currently have our data in a
wide format that looks something like this for now:

    sample_b5_data_wide

    ## # A tibble: 100 x 21
    ##      pid agreeableness_t1 conscientiousness_t1 neuroticism_t1
    ##    <dbl>            <dbl>                <dbl>          <dbl>
    ##  1     1         3.295400             2.501786       1.538106
    ##  2     2         3.348223             3.214239       2.793563
    ##  3     3         3.171709             3.319660       2.703627
    ##  4     4         2.727071             2.010532       1.055255
    ##  5     5         2.313266             3.312556       3.085609
    ##  6     6         3.620608             3.214379       3.977915
    ##  7     7         1.201265             2.988343       2.507895
    ##  8     8         2.666801             3.815197       3.335316
    ##  9     9         2.467433             4.656694       1.964536
    ## 10    10         2.895284             2.388371       2.320890
    ## # ... with 90 more rows, and 17 more variables: extraversion_t1 <dbl>,
    ## #   openness_t1 <dbl>, agreeableness_t2 <dbl>, conscientiousness_t2 <dbl>,
    ## #   neuroticism_t2 <dbl>, extraversion_t2 <dbl>, openness_t2 <dbl>,
    ## #   agreeableness_t3 <dbl>, conscientiousness_t3 <dbl>,
    ## #   neuroticism_t3 <dbl>, extraversion_t3 <dbl>, openness_t3 <dbl>,
    ## #   agreeableness_t4 <dbl>, conscientiousness_t4 <dbl>,
    ## #   neuroticism_t4 <dbl>, extraversion_t4 <dbl>, openness_t4 <dbl>

And say we want it to lengthen it to look like this:

    ## # A tibble: 400 x 7
    ##      pid  time agreeableness conscientiousness extraversion neuroticism
    ##  * <dbl> <chr>         <dbl>             <dbl>        <dbl>       <dbl>
    ##  1     1    t1      3.295400          2.501786     3.851280    1.538106
    ##  2     1    t2      3.764385          3.010544     4.137145    2.093680
    ##  3     1    t3      4.091583          3.608969     4.791821    2.607097
    ##  4     1    t4      4.629702          4.273238     4.994428    2.858696
    ##  5     2    t1      3.348223          3.214239     3.901119    2.793563
    ##  6     2    t2      4.152176          3.829460     4.021668    3.670314
    ##  7     2    t3      4.594936          4.123784     4.739197    4.150409
    ##  8     2    t4      5.410165          4.785196     5.376520    4.243513
    ##  9     3    t1      3.171709          3.319660     1.947245    2.703627
    ## 10     3    t2      3.649307          3.698359     2.657443    3.066518
    ## # ... with 390 more rows, and 1 more variables: openness <dbl>

We can use a function called `gather()` from the *tidyr* package
(another package in the tidyverse). `gather()` requires at least three
arguments:

-   data
    -   This one is easy. It is the dataset that we want to lengthen
-   key
    -   This is the name for the new variable (or new column) that will
        contain the information that was previously in the column names.
        In most cases, it will be the name for the new variable that
        contains the name for what used to be variables.
    -   In our example, this column will contain the variables
        agreeableness\_t1, conscientiousness\_t1, etc.
    -   You can give any name you want here.
-   value
    -   this is the name of the new variable (or new column) that will
        contain the scores that used to be spread out across
        different columns.

And that's all that is required.

The most important remaining part of this syntax is the columns that you
want to *gather*, or the variables that you want to become key-value
pairs. Another way to put this is which columns do you want to become
rows (lengthening the data)?

If you don't name any columns, it will select all of them. The syntax
for this part works similarly to `select()`. You can name a series of
variables, like `agreeableness_t1:openness_t4` , or name each column
individually separated by a comma
`agreeabeleness_t1, conscientiousness, ..., openness_t4`, or you can say
which columns you *do not* want with a minus sign in front of the column
name. Since we want to include all of our columns except participant id
(`pid`), we'll use the minus sign to tell `gather()` include everything
but `pid`

    sample_b5_data_wide %>%
      gather(variable, score, -pid)

    ## # A tibble: 2,000 x 3
    ##      pid         variable    score
    ##    <dbl>            <chr>    <dbl>
    ##  1     1 agreeableness_t1 3.295400
    ##  2     2 agreeableness_t1 3.348223
    ##  3     3 agreeableness_t1 3.171709
    ##  4     4 agreeableness_t1 2.727071
    ##  5     5 agreeableness_t1 2.313266
    ##  6     6 agreeableness_t1 3.620608
    ##  7     7 agreeableness_t1 1.201265
    ##  8     8 agreeableness_t1 2.666801
    ##  9     9 agreeableness_t1 2.467433
    ## 10    10 agreeableness_t1 2.895284
    ## # ... with 1,990 more rows

Okay, so this brings us to our first issue when trying to lengthen a
dataset. The key column (what we called variable) contains the trait
that was measured and the time point. That is, this column contains 2
pieces of information that we probably want kept separately. We want
these to be in separate columns, so that we can select certain traits or
time points, or model slopes across time points.

Thankfully, the authors of tidyr anticipated this problem, and created a
useful function called `separate()`, which basically takes data within a
single column, and splits it into multiple columns. Let's add that into
the pipeline on the variable column. We're going to throw a pipe on the
end of gather into separate. This will put the dataset above as the
first argument in the separate function. We then tell it the columns we
want to separate (variable in this case) and provide it the names of the
new columns, which we'll call trait and time, for Big Five trait and
time point.

    sample_b5_data_wide %>%
      gather(variable, score, -pid) %>%
      separate(variable, c("trait", "time"))

    ## # A tibble: 2,000 x 4
    ##      pid         trait  time    score
    ##  * <dbl>         <chr> <chr>    <dbl>
    ##  1     1 agreeableness    t1 3.295400
    ##  2     2 agreeableness    t1 3.348223
    ##  3     3 agreeableness    t1 3.171709
    ##  4     4 agreeableness    t1 2.727071
    ##  5     5 agreeableness    t1 2.313266
    ##  6     6 agreeableness    t1 3.620608
    ##  7     7 agreeableness    t1 1.201265
    ##  8     8 agreeableness    t1 2.666801
    ##  9     9 agreeableness    t1 2.467433
    ## 10    10 agreeableness    t1 2.895284
    ## # ... with 1,990 more rows

You'll notice we didn't tell separate anything other than the column we
wanted separated (`variable`) and the name of two new columns (`trait`
and `time`). How did it know how to separate that column?

Well, basically, separate looks for something called *regular
expressions*. We'll get into more detail about regular expressions later
on, but one regular expression is for separating things. So it
recognized that every string in the variable column contained a
underscore. Then, it put the character string on the left hand side of
the underscore into the first column name we gave it (trait) and put the
character string on the right hand side of the underscore into the
second column name we gave it (time). If we wanted to be more explicit,
we could specify the `sep=` argument like so:

    # We're going to save this to an object called sample_b5_data_long
    sample_b5_data_long<- sample_b5_data_wide %>%
      gather(variable, score, -pid) %>%
      separate(variable, c("trait", "time"), sep = "_")
    sample_b5_data_long

    ## # A tibble: 2,000 x 4
    ##      pid         trait  time    score
    ##  * <dbl>         <chr> <chr>    <dbl>
    ##  1     1 agreeableness    t1 3.295400
    ##  2     2 agreeableness    t1 3.348223
    ##  3     3 agreeableness    t1 3.171709
    ##  4     4 agreeableness    t1 2.727071
    ##  5     5 agreeableness    t1 2.313266
    ##  6     6 agreeableness    t1 3.620608
    ##  7     7 agreeableness    t1 1.201265
    ##  8     8 agreeableness    t1 2.666801
    ##  9     9 agreeableness    t1 2.467433
    ## 10    10 agreeableness    t1 2.895284
    ## # ... with 1,990 more rows

See, that did the same thing. Now, let's save this long data, and see
what we have to do to get it wide again.

### Long to wide

I will say, that my one mild frustration with `tidyr()`, with all due
respect, is that it seems to be optimized to getting data into long
format. I take it, from reading R for Data Science
&lt;r4ds.had.co.nz&gt; , that Hadley Wickham and company prefer long
data (my sense is that they consider data *tidy* when its in its longest
format, though perhaps I misread).

Long data is great and all, but sometimes we need wide data.
Specifically, we need wide data for **SEM** and **Path Analysis**, which
we use pretty regularly in psychology.

All of that said, you can use `spread()` from tidyr to widen your data.
There is also the `reshape()` function from base R, which I sometimes
find makes widening data a little easier than `spread()`. Let's go over
each in turn.

#### Spread

Spread is part of the `tidyr()` package, and is the function from that
package for reshaping data from long to wide format. It's syntactically
pretty similar to `spread()` making it pretty easy to go between the
two, which is nice. Spread requires 3 arguments, which you'll see mirror
gather:

-   Data
    -   The data that you want to widen
-   key
    -   The column that contains the values that you want to be columns.
        This would be either the variable or time column from our above
        example dataset.
-   value
    -   The column that contains the values you want to fill the cells
        beneath the new columns with. This would be the score column
        from above.

Let's say we're starting with our data in a long format like the one
above, and we wanted to get it to a wide format, like the one we started
with (where each row was a participant, and each column was a trait at a
particular time, like `agreeableness_t1`). We might start with this

    sample_b5_data_long2 <- sample_b5_data_long %>%
      spread(trait, score)

    sample_b5_data_long2 

    ## # A tibble: 400 x 7
    ##      pid  time agreeableness conscientiousness extraversion neuroticism
    ##  * <dbl> <chr>         <dbl>             <dbl>        <dbl>       <dbl>
    ##  1     1    t1      3.295400          2.501786     3.851280    1.538106
    ##  2     1    t2      3.764385          3.010544     4.137145    2.093680
    ##  3     1    t3      4.091583          3.608969     4.791821    2.607097
    ##  4     1    t4      4.629702          4.273238     4.994428    2.858696
    ##  5     2    t1      3.348223          3.214239     3.901119    2.793563
    ##  6     2    t2      4.152176          3.829460     4.021668    3.670314
    ##  7     2    t3      4.594936          4.123784     4.739197    4.150409
    ##  8     2    t4      5.410165          4.785196     5.376520    4.243513
    ##  9     3    t1      3.171709          3.319660     1.947245    2.703627
    ## 10     3    t2      3.649307          3.698359     2.657443    3.066518
    ## # ... with 390 more rows, and 1 more variables: openness <dbl>

Okay, that got us about halfway there. We now have a separate column for
each trait, but time is still row-wise. Maybe we could try spreading
time, but what would be the value column? We currently have 5. Let's try
passing it all of them.

    sample_b5_data_long %>%
      spread(time, score) %>%
      spread(trait, agreeableness:openness) # note that if you pass it a vector of names like c("agreeableness", etc.) it also won't work

We can't do that; we can only give exactly **one** column for the value
argument in spread. Herein lies my frustration with spread. Now there is
a workaround.

If you're data is in the longer format from above (where each row was a
participant X trait X time combo), then you can first use `unite()` (the
complement to separate). `unite()` requires an argument for data and the
column name you want it to add (once it unites the columns you tell it
to unite). You'll probably also want to name specific columns, which can
be done just like other tidyr functions, by listing their unquoted names
(or if you have a range of columns, you can use
column\_name\_at\_start\_of\_range:column\_name\_at\_end\_of\_range).

So, we'll add in a unite before we get to spread, and see if that fixes
it:

    sample_b5_data_long %>%
      unite(variable, trait, time) %>%
      spread(variable, score)

    ## # A tibble: 100 x 21
    ##      pid agreeableness_t1 agreeableness_t2 agreeableness_t3
    ##  * <dbl>            <dbl>            <dbl>            <dbl>
    ##  1     1         3.295400         3.764385         4.091583
    ##  2     2         3.348223         4.152176         4.594936
    ##  3     3         3.171709         3.649307         4.328907
    ##  4     4         2.727071         3.201055         3.607791
    ##  5     5         2.313266         2.812214         3.188017
    ##  6     6         3.620608         3.948514         4.530235
    ##  7     7         1.201265         1.492733         1.823545
    ##  8     8         2.666801         3.032801         3.320180
    ##  9     9         2.467433         2.918958         3.252996
    ## 10    10         2.895284         3.500747         3.582742
    ## # ... with 90 more rows, and 17 more variables: agreeableness_t4 <dbl>,
    ## #   conscientiousness_t1 <dbl>, conscientiousness_t2 <dbl>,
    ## #   conscientiousness_t3 <dbl>, conscientiousness_t4 <dbl>,
    ## #   extraversion_t1 <dbl>, extraversion_t2 <dbl>, extraversion_t3 <dbl>,
    ## #   extraversion_t4 <dbl>, neuroticism_t1 <dbl>, neuroticism_t2 <dbl>,
    ## #   neuroticism_t3 <dbl>, neuroticism_t4 <dbl>, openness_t1 <dbl>,
    ## #   openness_t2 <dbl>, openness_t3 <dbl>, openness_t4 <dbl>

Okay, that got our data into the right format. So, spread isn't *that*
bad, but you typically need to start with data in (just about) the
longest format possible, and to use `unite()` function as well.

But, sometimes our data are in between the longest format possible and
the wide format that we want. Sometimes we get data like we accidentally
got above, where each row is a participant X time point and each column
is trait. Like this:

    sample_b5_data_long2

    ## # A tibble: 400 x 7
    ##      pid  time agreeableness conscientiousness extraversion neuroticism
    ##  * <dbl> <chr>         <dbl>             <dbl>        <dbl>       <dbl>
    ##  1     1    t1      3.295400          2.501786     3.851280    1.538106
    ##  2     1    t2      3.764385          3.010544     4.137145    2.093680
    ##  3     1    t3      4.091583          3.608969     4.791821    2.607097
    ##  4     1    t4      4.629702          4.273238     4.994428    2.858696
    ##  5     2    t1      3.348223          3.214239     3.901119    2.793563
    ##  6     2    t2      4.152176          3.829460     4.021668    3.670314
    ##  7     2    t3      4.594936          4.123784     4.739197    4.150409
    ##  8     2    t4      5.410165          4.785196     5.376520    4.243513
    ##  9     3    t1      3.171709          3.319660     1.947245    2.703627
    ## 10     3    t2      3.649307          3.698359     2.657443    3.066518
    ## # ... with 390 more rows, and 1 more variables: openness <dbl>

What do we do here? Well, if we want to use gather, we'll have to first
lengthen the data, and unite the columns that we need to unite, and then
spread. So it will something like this:

    sample_b5_data_long2 %>%
      # first gather (you'll have to remember to not gather pid AND time)
      gather(trait, score, -pid, -time) %>%
      # Then unite trait and time into a column called variable
      unite(variable, trait, time) %>%
      # then spread it
      spread(variable, score)

    ## # A tibble: 100 x 21
    ##      pid agreeableness_t1 agreeableness_t2 agreeableness_t3
    ##  * <dbl>            <dbl>            <dbl>            <dbl>
    ##  1     1         3.295400         3.764385         4.091583
    ##  2     2         3.348223         4.152176         4.594936
    ##  3     3         3.171709         3.649307         4.328907
    ##  4     4         2.727071         3.201055         3.607791
    ##  5     5         2.313266         2.812214         3.188017
    ##  6     6         3.620608         3.948514         4.530235
    ##  7     7         1.201265         1.492733         1.823545
    ##  8     8         2.666801         3.032801         3.320180
    ##  9     9         2.467433         2.918958         3.252996
    ## 10    10         2.895284         3.500747         3.582742
    ## # ... with 90 more rows, and 17 more variables: agreeableness_t4 <dbl>,
    ## #   conscientiousness_t1 <dbl>, conscientiousness_t2 <dbl>,
    ## #   conscientiousness_t3 <dbl>, conscientiousness_t4 <dbl>,
    ## #   extraversion_t1 <dbl>, extraversion_t2 <dbl>, extraversion_t3 <dbl>,
    ## #   extraversion_t4 <dbl>, neuroticism_t1 <dbl>, neuroticism_t2 <dbl>,
    ## #   neuroticism_t3 <dbl>, neuroticism_t4 <dbl>, openness_t1 <dbl>,
    ## #   openness_t2 <dbl>, openness_t3 <dbl>, openness_t4 <dbl>

So that isn't sooooo bad. But, it can be a little cumbersome, because
you're using several different functions together. So to do this right,
you have to remember a pretty complex sequence (or look it up each
time). Plus, when your data is more complicated than this data (which
was intentionally made pretty simple), it becomes pretty easy to make a
mistake in one of these steps (not remembering which columns not to
gather in step 2 above, remembering to unite the right columns, etc.).
So, `reshape()` from base R is sometimes a little easier in these cases.
Let's talk about that now.

#### Using reshape(): long to wide

In general, `reshape()` is a little more complicated. It has more
arguments, and more of the arguments are required. But, like I said, it
is sometimes a little easier for widening data than `spread()`. One
thing to keep in mind is, unlike `spread()` and `gather()`, `reshape()`
is used for widening or lengthening data, and you have to specify the
direction in the function.

Let's say our data look like the intermediate data we've used before. I
mean this data shape:

    sample_b5_data_long2

    ## # A tibble: 400 x 7
    ##      pid  time agreeableness conscientiousness extraversion neuroticism
    ##  * <dbl> <chr>         <dbl>             <dbl>        <dbl>       <dbl>
    ##  1     1    t1      3.295400          2.501786     3.851280    1.538106
    ##  2     1    t2      3.764385          3.010544     4.137145    2.093680
    ##  3     1    t3      4.091583          3.608969     4.791821    2.607097
    ##  4     1    t4      4.629702          4.273238     4.994428    2.858696
    ##  5     2    t1      3.348223          3.214239     3.901119    2.793563
    ##  6     2    t2      4.152176          3.829460     4.021668    3.670314
    ##  7     2    t3      4.594936          4.123784     4.739197    4.150409
    ##  8     2    t4      5.410165          4.785196     5.376520    4.243513
    ##  9     3    t1      3.171709          3.319660     1.947245    2.703627
    ## 10     3    t2      3.649307          3.698359     2.657443    3.066518
    ## # ... with 390 more rows, and 1 more variables: openness <dbl>

And we wanted it to look like our dataset above, where each row is a
unique participant. We could use reshape like so

    reshape(sample_b5_data_long2,
            # This one is straight forward; just the column with participant id's
            idvar = "pid",
            # This won't always be time. timevar is the variable you want to move from rows into column names.
            # It's equivalen to key in the spread() function
            timevar = "time",
            # Gotta tell it what direction to go.
            direction = "wide",
            # Note, this is fully optional, but the defailt is ".", and I wanted it to look like the above, with a "_"
            sep = "_")

    ## # A tibble: 100 x 6
    ##      pid `agreeableness_c("t1", "t2", "t3", "t4")`
    ##    <dbl>                                     <dbl>
    ##  1     1                                        NA
    ##  2     2                                        NA
    ##  3     3                                        NA
    ##  4     4                                        NA
    ##  5     5                                        NA
    ##  6     6                                        NA
    ##  7     7                                        NA
    ##  8     8                                        NA
    ##  9     9                                        NA
    ## 10    10                                        NA
    ## # ... with 90 more rows, and 4 more variables: `conscientiousness_c("t1",
    ## #   "t2", "t3", "t4")` <dbl>, `extraversion_c("t1", "t2", "t3",
    ## #   "t4")` <dbl>, `neuroticism_c("t1", "t2", "t3", "t4")` <dbl>,
    ## #   `openness_c("t1", "t2", "t3", "t4")` <dbl>

Holy sh\*\*, what happened!?!?! What did I do

This brings us to what has got to be the most common mistake made with
`reshape()` in modern times (post tidyverse times, that is). The reason
we got that hot mess above is beecause reshape *only* works with
data.frames **NOT** tibbles. Now our data set `sample_b5_data_long2` is
probably a tibble. Let's check that out with the structure function
`str()`

    str(sample_b5_data_long2)

    ## Classes 'tbl_df', 'tbl' and 'data.frame':    400 obs. of  7 variables:
    ##  $ pid              : num  1 1 1 1 2 2 2 2 3 3 ...
    ##  $ time             : chr  "t1" "t2" "t3" "t4" ...
    ##  $ agreeableness    : num  3.3 3.76 4.09 4.63 3.35 ...
    ##  $ conscientiousness: num  2.5 3.01 3.61 4.27 3.21 ...
    ##  $ extraversion     : num  3.85 4.14 4.79 4.99 3.9 ...
    ##  $ neuroticism      : num  1.54 2.09 2.61 2.86 2.79 ...
    ##  $ openness         : num  2.23 2.85 3.26 3.98 2.63 ...

Yep, it looks like it's class is tbl\_df, tbl, and data.frame, which
means its a tibble. Thankfully, this is an easy fix, you just need to
turn the tibble into a data.frame with `as.data.frame()`. So let's add
that into the pipeline.

    sample_b5_data_long2 %>%
      as.data.frame() %>%
      # Note, because we're piping things, we start with 'idvar=' instead of the name of the data
      reshape(idvar = "pid",
              timevar = "time",
              direction = "wide",
              # Note, this is fully optional, but the defailt is ".", and I wanted it to look like the above, with a "_"
              sep = "_")

    ##     pid agreeableness_t1 conscientiousness_t1 extraversion_t1
    ## 1     1        3.2954000            2.5017864       3.8512798
    ## 5     2        3.3482229            3.2142390       3.9011192
    ## 9     3        3.1717094            3.3196600       1.9472454
    ## 13    4        2.7270706            2.0105316       2.1005110
    ## 17    5        2.3132660            3.3125555       2.1645307
    ## 21    6        3.6206076            3.2143789       3.4793919
    ## 25    7        1.2012647            2.9883435       4.8593700
    ## 29    8        2.6668007            3.8151968       3.9870667
    ## 33    9        2.4674331            4.6566941       2.5083315
    ## 37   10        2.8952841            2.3883707       1.7332409
    ## 41   11        1.6249801            2.7673578       3.5901150
    ## 45   12        2.7919682            3.1177216       2.3320321
    ## 49   13        1.5245756            3.3441209       3.2230742
    ## 53   14        3.2823041            4.0592797       2.8603830
    ## 57   15        3.3672283            3.8950743       3.4069336
    ## 61   16        2.5065916            1.2808565       0.3076700
    ## 65   17        2.9134956            3.0861547       4.6755192
    ## 69   18        3.3806363            2.7764658       2.7175009
    ## 73   19        2.0703648            1.1211731       3.3402942
    ## 77   20        2.5268204            3.2635021       1.5994480
    ## 81   21        1.6947200            3.6229829       1.4243016
    ## 85   22        2.9859800            3.0591906       3.4768514
    ## 89   23        2.6501808            2.9317918       2.4303685
    ## 93   24        3.6736280            1.2067011       2.8402924
    ## 97   25        3.2105684            0.9368747       2.6511579
    ## 101  26        4.0301373            3.8193931       4.2513412
    ## 105  27        4.4494338            3.6713921       4.1554783
    ## 109  28        5.5996526            1.2219960       3.7255766
    ## 113  29        4.2191526            3.7953330       2.9765463
    ## 117  30        3.2025431            3.8085309       1.4598745
    ## 121  31        3.5158388            3.8011366       2.2458497
    ## 125  32        4.0426877            3.6678598       3.9536184
    ## 129  33        2.8116299            2.9457642       4.3110606
    ## 133  34        3.2963668            3.0308976       2.8190443
    ## 137  35        2.7909891            4.5531627       2.1814712
    ## 141  36        2.2983740            3.8680539       3.3875714
    ## 145  37        0.6284759            4.0918779       3.2613241
    ## 149  38        2.9056731            2.7248518       2.9431099
    ## 153  39        2.6513535            2.4071052       3.4576760
    ## 157  40        3.5692043            3.2860651       3.9080106
    ## 161  41        3.7008406            3.1291082       3.2980887
    ## 165  42        2.2664471            3.9071541       2.7999335
    ## 169  43        3.2109840            3.0975422       2.6656921
    ## 173  44        2.6507549            1.9472246       2.1200442
    ## 177  45        2.7383795            2.1382764       2.7199373
    ## 181  46       -0.1744927            2.6467923       3.9202164
    ## 185  47        2.5613671            3.8774233       1.2082597
    ## 189  48        4.2799202            2.8063763       2.4820714
    ## 193  49        2.5961688            3.4130652       0.7357744
    ## 197  50        3.2877357            4.0863425       3.1992167
    ## 201  51        3.8025852            5.2872556       3.1844096
    ## 205  52        2.5958432            3.7351872       4.1216340
    ## 209  53        4.3456144            1.5948031       3.2585852
    ## 213  54        2.7802797            3.0436040       2.3479640
    ## 217  55        3.0630116            3.5225350       4.4364072
    ## 221  56        3.1510798            2.1655260       2.0600984
    ## 225  57        3.3388199            5.0854625       3.7706738
    ## 229  58        2.7454046            3.1576348       4.5851652
    ## 233  59        5.7607893            0.3899014       4.4013331
    ## 237  60        3.1336034            2.7257041       3.2924594
    ## 241  61        3.1844876            3.1143145       0.9261692
    ## 245  62        2.6592190            5.3357476       2.4661794
    ## 249  63        3.6150115            1.6405263       3.0190275
    ## 253  64        3.9092229            3.1259275       3.7698937
    ## 257  65        0.5061628            3.9452273       3.1297480
    ## 261  66        3.4213350            3.8015920       2.1342429
    ## 265  67        3.7308101            2.6596408       2.5909547
    ## 269  68        2.9077451            3.6299802       1.6447529
    ## 273  69        3.1971150            3.5726130       2.5222873
    ## 277  70        0.9519137            2.4863107       3.0904529
    ## 281  71        2.1465406            2.7216616       2.0309639
    ## 285  72        4.2524246            2.1865989       2.8970252
    ## 289  73        3.9113189            4.3444966       3.1121379
    ## 293  74        4.1011844            1.2785071       4.7769154
    ## 297  75        5.4168115            3.5739480       3.9542850
    ## 301  76        3.5395556            3.8065289       2.7257020
    ## 305  77        2.4518438            2.6937383       3.2548510
    ## 309  78        1.7543503            2.7546002       0.9828005
    ## 313  79        3.0251018            4.8894099       3.2877157
    ## 317  80        3.0158251            3.3940622       3.1942188
    ## 321  81        4.9161163            2.4327979       3.2534210
    ## 325  82        2.5254390            3.9112497       3.0408360
    ## 329  83        3.9084464            1.8478148       3.1840944
    ## 333  84        3.4495315            4.4488740       3.2656253
    ## 337  85        5.6961362            2.0469286       3.2269335
    ## 341  86        2.2258297            3.8725056       1.5521155
    ## 345  87        3.2893489            2.4784463       1.4578145
    ## 349  88        2.8081850            3.4553290       4.6823954
    ## 353  89        3.3223569            3.2352735       2.0912568
    ## 357  90        3.3360814            3.8073497       4.1424406
    ## 361  91        2.7105860            3.4187458       2.7268279
    ## 365  92        3.7543337            2.9387949       4.2478070
    ## 369  93        2.3976580            3.6480297       3.0581480
    ## 373  94        4.3088677            2.0486498       3.4495404
    ## 377  95        3.3638892            1.6034722       4.1662149
    ## 381  96        2.6957136            1.2700378       2.8236312
    ## 385  97        3.7800839            5.3373611       2.8681719
    ## 389  98        2.4799712            3.1666055       3.0166242
    ## 393  99        3.9146337            5.0228209       5.2743622
    ## 397 100        2.5494978            3.0487815       2.4892792
    ##     neuroticism_t1 openness_t1 agreeableness_t2 conscientiousness_t2
    ## 1        1.5381061   2.2275104        3.7643852            3.0105442
    ## 5        2.7935626   2.6271160        4.1521755            3.8294595
    ## 9        2.7036269   1.7077356        3.6493067            3.6983595
    ## 13       1.0552546   3.4514458        3.2010554            2.4076307
    ## 17       3.0856089   4.6565225        2.8122138            3.7406442
    ## 21       3.9779149   3.0110683        3.9485136            3.6690642
    ## 25       2.5078946   3.4700955        1.4927327            3.3651678
    ## 29       3.3353156   1.9233697        3.0328012            4.3341717
    ## 33       1.9645364   2.0706178        2.9189577            4.9985497
    ## 37       2.3208905   3.6506514        3.5007475            2.8622594
    ## 41       1.0888272   2.8139396        1.9799834            3.1870209
    ## 45       2.3427939   2.9160330        3.5930916            3.5697611
    ## 49       4.0540895   4.5261936        1.9730179            3.5423112
    ## 53       5.3202188   2.7836825        3.9601387            4.3806900
    ## 57       3.8657255   3.4708575        3.8525077            4.2392103
    ## 61       1.8037538   2.8030548        3.3631243            1.7223589
    ## 65       3.3351296   3.2352183        3.2694067            3.3975939
    ## 69       1.8511239   3.9873983        3.8979866            3.3093198
    ## 73       3.8140410   3.4378295        2.5407174            1.5651132
    ## 77       4.7625389   3.3222034        3.1331516            3.9123661
    ## 81       3.0923012   2.2506141        2.0672612            4.1381650
    ## 85       3.7835987   2.5434152        3.1606694            3.4074435
    ## 89       2.7717869   4.1149405        3.2082259            3.4618193
    ## 93       2.3714523   4.8815178        4.1639972            1.4892921
    ## 97       2.2536083   2.4123356        3.7518689            1.3656036
    ## 101      3.3261404   2.0637946        4.5556124            4.1957792
    ## 105      2.1033523   2.6072119        4.9371897            3.7998339
    ## 109      3.4914055   1.9280608        6.1298563            1.4904730
    ## 113      2.4578513   3.8537626        4.5981312            4.3504911
    ## 117      3.5904652   1.7413711        3.7195450            4.1700819
    ## 121      2.8074966   3.6664482        4.2601907            4.3285850
    ## 125      4.4029395   1.9001592        4.5993616            3.8830968
    ## 129      2.3958206   2.7063259        3.4878259            3.1858681
    ## 133      3.7591303   4.6491517        4.0122921            3.5182062
    ## 137      3.5861054   3.8109188        3.4098411            4.8228123
    ## 141      3.5395610   3.1876294        2.7038990            4.4104497
    ## 145      1.2099895   3.0153533        1.1429821            4.5923093
    ## 149      3.0431007   2.7089367        3.0816620            2.8825932
    ## 153      3.0739579   3.2795653        3.0842566            3.0829285
    ## 157      1.7579759   1.0499438        3.7582605            3.9173015
    ## 161      2.6953407   2.7435339        4.0236350            3.7428084
    ## 165      2.6300580   3.1383442        2.9072583            4.5010679
    ## 169      2.7567174   4.6102051        4.0589104            3.4238988
    ## 173      3.2436137   4.1778369        3.2785560            2.1429949
    ## 177      3.9894191   3.6891573        3.4764725            2.9313458
    ## 181      3.4616449   3.9154780        0.1440576            3.5294474
    ## 185      1.0839201   3.7071888        3.4107590            4.2768821
    ## 189      2.7195213   1.9815921        4.7103718            3.3960997
    ## 193      1.9936084   3.2420952        2.9449711            3.7601172
    ## 197      2.0225750   3.5040044        3.8005392            4.2131176
    ## 201      1.1248601   2.0313395        4.1458946            6.1193065
    ## 205      2.7540373   4.8515169        2.9785170            4.4544301
    ## 209      3.9989297   2.7781244        4.9214497            2.2678625
    ## 213      4.2936407   1.3316020        2.8839373            3.5181669
    ## 217      2.4114713   2.8335023        3.5353063            4.2553172
    ## 221      4.4492370   3.3508606        3.8797947            2.4846671
    ## 225      2.5181061   2.6015181        3.6164247            5.9028367
    ## 229      2.8573460   2.8699397        3.0138107            3.8099136
    ## 233      2.6901825   3.4568261        6.2412082            0.9116384
    ## 237      3.3446034   4.0054552        3.8201229            3.5807296
    ## 241      2.9788629   3.9542148        3.6955974            3.7314587
    ## 245      0.6110484   4.7876551        2.7900974            5.7672383
    ## 249      3.0550533   2.6158272        4.3358159            1.7015779
    ## 253      1.4667953   4.6912031        4.4210909            3.8015928
    ## 257      1.5116369   4.1881475        1.1985337            4.4441987
    ## 261      3.4499873   1.2202294        3.8032159            4.1111726
    ## 265      1.1050380   3.7321366        4.2966563            3.2092402
    ## 269      4.1404613   4.3899957        3.5718882            4.0172088
    ## 273      2.9873968   3.3148470        3.7515159            4.0797364
    ## 277      1.6276011   2.3181842        1.1899220            3.1973202
    ## 281      2.4447225   3.3416792        2.5768153            3.2274653
    ## 285      2.1391636   2.9610696        4.9107669            2.3352798
    ## 289      3.7289059   3.4544760        4.3187487            4.5952504
    ## 293      1.7686521   3.6772586        4.8863357            1.5217282
    ## 297      1.5339489   2.3921037        6.0326078            4.1150060
    ## 301      3.1633745   2.4362224        3.9456288            4.4010138
    ## 305      2.9804683   2.2875774        3.3676967            3.2821954
    ## 309      4.1379013   3.7134803        2.1437692            3.2106754
    ## 313      1.1756889   4.4230688        3.2730058            5.1829228
    ## 317      1.5439999   3.9705100        3.6850920            3.8451843
    ## 321      3.2556071   0.8857988        5.5177550            3.0854460
    ## 325      2.7131727   2.5179908        2.6687964            4.4170053
    ## 329      1.3134275   1.3565063        4.6510002            2.2807317
    ## 333      2.8234092   4.1596663        4.0730689            4.8476899
    ## 337      2.2259056   4.1162164        6.0663448            2.4669578
    ## 341      4.4768515   3.4725374        3.0660138            4.4173393
    ## 345      1.8312820   2.6683378        4.1493591            3.3000992
    ## 349      4.4043206   2.3776000        3.2137782            3.8711372
    ## 353      2.3862717   2.5991811        3.8122420            3.5775554
    ## 357      3.9327860   3.5477590        3.8304125            4.3712045
    ## 361      3.3748572   2.6695254        3.1224673            3.6655673
    ## 365      3.0741259   2.7511185        4.3569405            3.4324893
    ## 369      4.1237361   3.2199360        2.9343064            4.2136478
    ## 373      4.5413094   2.6809544        4.7482999            2.6768342
    ## 377      3.1105927   2.3082174        3.9305051            2.2196939
    ## 381      1.1221277   3.3051074        3.1249579            1.6322025
    ## 385      3.0044484   2.9841207        3.9891698            5.9213996
    ## 389      3.6358542   1.5368842        2.7400564            3.6983310
    ## 393      3.8162476   2.8529241        4.5585907            5.1970155
    ## 397      2.7361438   2.0238952        2.8144715            3.9293416
    ##     extraversion_t2 neuroticism_t2 openness_t2 agreeableness_t3
    ## 1          4.137145       2.093680    2.850574        4.0915834
    ## 5          4.021668       3.670314    2.922638        4.5949357
    ## 9          2.657443       3.066518    2.365796        4.3289072
    ## 13         2.854062       1.687228    3.959130        3.6077913
    ## 17         2.672013       3.904297    5.150197        3.1880169
    ## 21         4.198887       4.502415    3.380878        4.5302352
    ## 25         5.439138       2.814326    4.045965        1.8235455
    ## 29         4.588607       3.852050    2.439447        3.3201799
    ## 33         2.863505       2.631282    2.409418        3.2529958
    ## 37         2.127363       3.055004    4.450544        3.5827416
    ## 41         4.049104       1.602302    3.410635        2.3282129
    ## 45         2.830674       2.829506    3.090287        3.9679360
    ## 49         3.837437       4.537699    5.149741        2.3761802
    ## 53         3.339992       6.155199    3.429976        4.7057292
    ## 57         3.636556       4.072493    4.139756        4.4593385
    ## 61         1.139544       2.568082    3.082561        4.0729353
    ## 65         5.033199       3.758448    3.972446        3.8788244
    ## 69         3.140964       2.380215    4.811872        4.3359075
    ## 73         3.963328       4.327045    3.984648        3.0339199
    ## 77         1.699136       5.550116    3.665300        3.5895799
    ## 81         1.790684       3.175764    2.779164        2.6512684
    ## 85         3.972265       4.283555    2.934788        3.7549081
    ## 89         3.421443       3.483448    4.863653        3.5715029
    ## 93         3.567814       2.914576    5.530446        4.7917521
    ## 97         3.177749       2.547022    3.162070        4.1705554
    ## 101        4.658196       3.274716    2.278709        4.9427813
    ## 105        4.770520       3.078789    2.758403        5.6904660
    ## 109        4.129111       4.037966    2.397909        6.6586686
    ## 113        3.095262       2.955740    4.643103        5.5603691
    ## 117        2.068938       4.156292    2.037964        4.3048353
    ## 121        2.749876       3.682284    4.159350        5.0585635
    ## 125        4.577563       4.954963    2.118661        5.3333536
    ## 129        4.555280       2.774985    3.516533        3.6410419
    ## 133        3.242068       4.048325    5.298317        4.6430380
    ## 137        2.380511       4.065463    4.562012        3.7472708
    ## 141        3.843330       4.270650    3.688709        2.9961782
    ## 145        3.746349       1.486683    3.778181        1.4946167
    ## 149        3.439283       3.708054    3.320330        3.6739948
    ## 153        3.802756       3.473428    4.011650        3.5827346
    ## 157        4.114756       2.270138    1.742337        4.1092338
    ## 161        3.624212       3.445351    3.106635        4.1814848
    ## 165        3.245792       3.119459    3.469091        3.4217279
    ## 169        3.581523       3.360473    5.387488        4.5843414
    ## 173        3.023741       4.063793    4.653430        3.9627248
    ## 177        3.271460       4.868894    4.161968        3.9943090
    ## 181        4.366005       4.112277    4.224154        0.5895644
    ## 185        1.775198       1.603866    4.219413        4.2726497
    ## 189        2.809086       3.274055    2.461734        5.0010125
    ## 193        1.423860       2.073511    3.523760        3.5256416
    ## 197        3.433346       1.940844    3.976359        4.3328163
    ## 201        3.363113       1.762936    2.701378        4.9363944
    ## 205        4.615893       3.469298    5.165872        3.4424035
    ## 209        3.843922       4.683801    2.788101        5.3117221
    ## 213        3.031606       4.430542    1.832627        3.6197793
    ## 217        5.049286       2.521941    3.265215        4.1435173
    ## 221        2.548001       5.056455    3.572064        4.7085992
    ## 225        4.660775       3.138062    3.079914        3.8065532
    ## 229        4.993657       3.466129    3.437764        3.2193474
    ## 233        4.636476       3.242990    3.831012        6.8958836
    ## 237        4.344031       3.742601    4.640557        4.3550644
    ## 241        1.623578       3.403995    4.184861        4.5319971
    ## 245        3.115209       0.846764    5.367170        3.5575078
    ## 249        3.780756       3.452373    3.102343        4.9241834
    ## 253        4.130908       1.961649    5.050559        4.9285759
    ## 257        3.637533       1.774603    4.713700        2.0016224
    ## 261        2.522578       3.745993    1.845663        3.9964272
    ## 265        2.976312       1.804870    4.268424        4.8043065
    ## 269        2.412774       4.951352    4.860137        4.2135660
    ## 273        3.584459       3.613186    3.808664        4.2248249
    ## 277        3.877402       2.170314    2.688363        1.8398092
    ## 281        2.807641       2.948045    3.767610        3.4071516
    ## 285        3.341938       2.624378    3.368259        5.2049373
    ## 289        3.621076       4.319345    3.872420        4.8658745
    ## 293        5.134492       2.161435    4.153134        5.2235993
    ## 297        4.358871       2.174178    2.777570        6.5887810
    ## 301        3.044266       3.715922    2.946957        4.5875079
    ## 305        3.997214       3.537423    3.028298        3.7705245
    ## 309        1.987409       4.383860    4.309339        2.7391625
    ## 313        3.948626       1.687256    5.136674        3.7115257
    ## 317        3.639569       1.701291    4.622958        3.9053337
    ## 321        3.805232       3.638252    1.457119        6.0184928
    ## 325        3.667765       2.988467    2.839759        2.7734493
    ## 329        3.722011       1.767143    1.927912        5.1794539
    ## 333        3.720935       3.200855    4.766819        4.6362410
    ## 337        3.728399       2.956915    4.406898        6.6347842
    ## 341        2.096570       4.827627    4.207390        3.5747820
    ## 345        1.963246       2.416828    3.726423        4.2243043
    ## 349        5.461245       4.739263    2.714428        3.7690479
    ## 353        2.413534       2.917226    3.230703        4.0443437
    ## 357        4.336928       4.202073    4.268285        4.1662236
    ## 361        3.230918       3.903701    2.841698        3.7960267
    ## 365        4.610763       3.469896    3.534529        5.1998734
    ## 369        3.585496       5.101142    3.500467        3.3264715
    ## 373        3.884934       5.117470    3.062553        5.2658272
    ## 377        4.656271       3.759683    2.925535        4.1066225
    ## 381        3.506278       1.707970    3.640133        3.9357940
    ## 385        3.421847       3.045423    3.775551        4.3145032
    ## 389        3.550217       3.839535    2.494389        3.1141232
    ## 393        5.533801       4.056379    3.095717        5.0902466
    ## 397        2.588036       3.050795    2.362428        3.1526432
    ##     conscientiousness_t3 extraversion_t3 neuroticism_t3 openness_t3
    ## 1               3.608969        4.791821       2.607097    3.260601
    ## 5               4.123784        4.739197       4.150409    3.557143
    ## 9               4.510616        3.140280       3.924732    2.909537
    ## 13              2.547902        3.323345       2.166752    4.178358
    ## 17              4.405853        3.262248       4.508425    5.589938
    ## 21              3.856277        4.329315       5.019447    4.016350
    ## 25              3.404243        5.631577       3.192261    4.603242
    ## 29              4.979933        5.064873       4.903060    2.983260
    ## 33              5.397822        3.806876       3.130076    3.031404
    ## 37              2.961061        2.333824       4.001253    5.032633
    ## 41              3.763864        4.838681       2.081415    4.034268
    ## 45              4.041433        3.361467       3.171868    3.939140
    ## 49              4.306672        4.561410       5.117107    5.678899
    ## 53              5.181191        4.555123       6.520690    3.917495
    ## 57              4.856909        3.895867       4.243778    5.019201
    ## 61              2.277662        1.491113       3.099501    3.706331
    ## 65              3.812790        5.684583       3.909150    4.311574
    ## 69              3.656990        3.905017       3.077695    5.317447
    ## 73              2.153712        4.440346       4.752311    4.456428
    ## 77              4.452791        2.404123       6.092885    3.938273
    ## 81              4.628603        2.446253       3.465109    3.570186
    ## 85              3.616456        4.638306       4.623528    3.663819
    ## 89              3.900845        4.035293       3.757295    5.126463
    ## 93              2.016170        3.821961       3.263891    6.129472
    ## 97              1.896307        3.934201       3.034255    3.862551
    ## 101             4.744812        4.908954       3.750373    2.905414
    ## 105             4.132154        5.260764       3.513814    3.154087
    ## 109             2.062712        4.438233       4.168541    3.081586
    ## 113             5.035355        3.558558       3.264862    5.107000
    ## 117             4.265700        2.699747       4.823540    2.639906
    ## 121             4.977492        3.090735       4.232703    4.907290
    ## 125             4.246946        4.875398       5.597502    2.618607
    ## 129             3.670175        5.039961       3.029793    3.740490
    ## 133             4.106310        3.904908       4.482160    5.917325
    ## 137             5.287898        3.305619       4.408201    4.555221
    ## 141             5.012546        4.319110       4.549547    4.321344
    ## 145             5.142035        4.010285       1.930260    4.193446
    ## 149             3.436997        3.785209       4.330357    3.645354
    ## 153             3.618769        4.178219       4.240781    4.695036
    ## 157             4.693671        4.250810       2.811254    2.183372
    ## 161             4.252659        4.231464       3.798518    3.249277
    ## 165             5.048260        3.921098       3.378555    4.161388
    ## 169             3.460915        3.735395       3.622987    5.804152
    ## 173             3.037476        3.637524       4.511282    5.302863
    ## 177             3.080241        3.621746       5.341522    4.683014
    ## 181             4.066050        4.795628       4.791798    4.766775
    ## 185             4.910923        2.119634       2.074457    4.748788
    ## 189             3.764488        3.601093       3.809379    2.901144
    ## 193             4.363631        1.774336       2.389882    3.955143
    ## 197             4.771840        3.892068       2.209018    4.288238
    ## 201             6.674641        3.756433       2.291208    3.281009
    ## 205             4.807516        5.126651       3.880749    5.690579
    ## 209             2.790483        4.250367       5.410566    3.163477
    ## 213             4.135133        3.388692       4.687396    2.774032
    ## 217             4.752589        5.321034       2.986577    3.841549
    ## 221             2.818871        3.302570       5.868367    4.146663
    ## 225             6.310783        5.190337       3.592842    3.754202
    ## 229             4.194319        5.250787       4.300872    4.345543
    ## 233             1.373410        4.747001       3.398082    4.427384
    ## 237             4.211909        4.840524       3.936736    5.179833
    ## 241             4.591556        2.012543       3.810259    4.612699
    ## 245             6.340802        3.481395       1.441132    5.841350
    ## 249             2.120726        4.253891       4.103591    3.775756
    ## 253             4.359349        4.942071       2.329031    5.260344
    ## 257             5.378340        4.291741       2.260852    5.265344
    ## 261             5.116054        2.754871       4.184457    2.558009
    ## 265             3.919525        3.495521       2.164727    4.744442
    ## 269             4.404578        2.649211       5.274079    5.870000
    ## 273             4.694750        4.223534       4.361117    4.336277
    ## 277             3.583393        4.601224       2.607714    3.014368
    ## 281             3.769882        3.859185       3.948137    3.930947
    ## 285             2.691736        3.449053       3.304300    4.002557
    ## 289             5.193078        4.049905       4.786281    4.237813
    ## 293             1.803214        5.692700       2.571334    4.648958
    ## 297             4.750577        4.878832       2.564538    3.377114
    ## 301             5.009394        3.394255       3.935704    3.740726
    ## 305             3.892960        4.706735       3.922578    3.472411
    ## 309             3.592004        2.715769       4.863622    4.561738
    ## 313             5.539793        4.284773       2.016017    5.444554
    ## 317             4.836146        4.399805       2.069201    5.278304
    ## 321             3.550656        4.107353       4.155959    1.914745
    ## 325             4.817278        4.239377       3.333418    3.252501
    ## 329             2.848388        3.979770       1.869092    2.290597
    ## 333             5.549744        4.099489       3.741079    5.485807
    ## 337             2.731305        4.415606       3.563615    4.822396
    ## 341             4.507403        2.813641       5.231036    4.275597
    ## 345             3.671177        2.429831       2.995273    4.067725
    ## 349             4.195909        5.881994       5.381527    2.891907
    ## 353             3.743148        2.770754       3.627506    4.045204
    ## 357             4.846132        5.102074       5.015688    4.468114
    ## 361             3.981265        3.530234       4.362653    2.997452
    ## 365             3.823335        5.118471       3.992068    4.002692
    ## 369             4.673181        4.448410       5.780882    4.117077
    ## 373             3.284185        4.398267       5.507334    3.913107
    ## 377             2.921396        5.576488       4.247763    3.632259
    ## 381             2.141776        4.171724       1.956649    4.101744
    ## 385             6.545425        3.692926       3.494089    4.000412
    ## 389             4.283791        3.550800       4.303584    2.839925
    ## 393             5.807386        6.314818       4.660333    3.404806
    ## 397             4.340330        2.705876       3.584771    3.109404
    ##     agreeableness_t4 conscientiousness_t4 extraversion_t4 neuroticism_t4
    ## 1          4.6297021             4.273238        4.994428       2.858696
    ## 5          5.4101648             4.785196        5.376520       4.243513
    ## 9          4.5974554             4.853515        3.515587       4.229506
    ## 13         4.2441328             3.068228        3.697775       2.907972
    ## 17         3.5831228             4.633348        3.784345       5.167882
    ## 21         5.1996963             4.393468        5.096247       5.224063
    ## 25         2.1144065             3.503150        6.211178       3.758746
    ## 29         4.0530934             5.124962        5.725013       5.181431
    ## 33         3.6276168             5.776675        4.324042       3.433364
    ## 37         4.0591125             3.812428        2.553107       4.507089
    ## 41         2.7866668             4.469833        5.313726       2.475758
    ## 45         4.5695460             4.731836        3.636735       3.756101
    ## 49         2.9992328             5.109247        5.029294       5.533783
    ## 53         5.0636751             5.639869        4.945028       6.772765
    ## 57         5.0410122             4.962392        4.062288       4.610146
    ## 61         4.5716159             2.964212        1.909278       3.421327
    ## 65         4.4650731             4.128681        6.553257       4.385061
    ## 69         5.1664275             4.188963        4.275194       3.438155
    ## 73         3.6178928             3.058842        5.145844       5.220320
    ## 77         4.3310638             5.014903        3.045225       6.786463
    ## 81         2.9739203             4.859369        3.021262       3.681024
    ## 85         4.4727628             4.124570        5.372830       4.956337
    ## 89         4.0033585             4.302148        4.636450       4.076128
    ## 93         5.1064703             2.458757        4.510525       3.331406
    ## 97         4.7124411             2.514983        4.570423       3.348272
    ## 101        5.6521692             5.197077        5.222563       4.044972
    ## 105        6.4962050             4.697181        5.556290       4.084212
    ## 109        7.0105817             2.650262        5.108186       4.585633
    ## 113        5.9637831             5.361804        4.199594       3.408816
    ## 117        4.6402154             4.861278        3.029783       5.168944
    ## 121        5.7743260             5.642948        3.782703       4.804600
    ## 125        5.6298450             4.841557        5.292515       5.919828
    ## 129        3.9161477             3.991338        5.350024       3.663743
    ## 133        5.3224076             4.622758        4.291097       5.058511
    ## 137        4.1570181             6.003898        3.483900       4.873700
    ## 141        3.9765704             5.722964        4.993496       5.401509
    ## 145        2.5070732             5.606598        4.635494       2.779641
    ## 149        3.7633846             3.838269        3.946485       5.159131
    ## 153        3.7000993             4.098815        4.895679       4.795393
    ## 157        4.6535565             5.206554        4.845266       3.157212
    ## 161        4.7264100             4.548391        4.706351       4.197497
    ## 165        4.2195724             5.341280        4.337601       3.758928
    ## 169        5.2171917             3.923643        4.091223       4.333686
    ## 173        4.8862447             3.703634        4.100397       5.042104
    ## 177        4.4118006             3.533498        4.306021       5.612005
    ## 181        0.8582212             4.697330        4.744599       5.579371
    ## 185        5.0236938             5.381374        2.638047       2.579599
    ## 189        5.5374305             4.144136        4.325552       4.444228
    ## 193        3.5704247             5.119276        2.516457       3.160232
    ## 197        4.7958007             5.431116        3.851372       2.655688
    ## 201        5.4537325             6.980312        4.353104       2.731517
    ## 205        3.9704290             5.192332        5.513201       4.281188
    ## 209        6.1589819             3.714146        4.181476       6.188151
    ## 213        4.0362002             4.311139        3.943115       5.087865
    ## 217        4.4817692             5.271915        5.998053       3.399209
    ## 221        5.3211832             3.256080        3.901131       6.329288
    ## 225        4.3332037             7.187662        5.846716       3.853577
    ## 229        4.0078806             4.622509        5.521288       5.246121
    ## 233        7.2923313             2.031803        5.104672       3.647067
    ## 237        4.6152147             4.780397        5.513139       4.453546
    ## 241        4.8382476             4.911748        2.337416       4.163935
    ## 245        4.4466848             7.029125        4.280307       1.746282
    ## 249        5.3449509             2.801336        4.931002       4.302327
    ## 253        5.4178576             4.788926        5.344092       2.935601
    ## 257        2.5934522             5.841979        4.921220       3.039635
    ## 261        4.5002955             5.376059        3.244673       4.943083
    ## 265        4.9603493             4.538048        3.889380       2.722278
    ## 269        4.4382165             4.827505        3.035159       5.822571
    ## 273        4.6488008             5.175943        4.909720       4.495549
    ## 277        2.2086426             3.907953        4.992076       2.986120
    ## 281        3.8060058             4.012622        4.192029       4.404688
    ## 285        5.5916499             3.413510        3.842215       3.690857
    ## 289        5.4152276             5.928249        4.803164       5.517297
    ## 293        5.9716857             2.279049        6.483124       3.051388
    ## 297        7.3747236             5.496511        5.323553       3.061488
    ## 301        5.2365861             5.826078        3.610101       4.476901
    ## 305        4.4580713             4.428000        5.158603       4.552093
    ## 309        3.5161958             4.088707        3.370786       5.740900
    ## 313        4.2390488             6.340594        4.861847       2.358899
    ## 317        4.2082759             5.155277        4.775831       2.294008
    ## 321        6.5310778             4.224282        4.682147       4.278288
    ## 325        2.8539641             5.431103        4.796095       3.725796
    ## 329        5.7563163             3.428850        4.242516       1.997377
    ## 333        4.8556887             5.898656        4.487540       4.199958
    ## 337        7.1570173             3.550456        4.864331       3.879487
    ## 341        4.0612725             4.830286        3.353218       5.570970
    ## 345        4.7374509             4.293973        3.244406       3.582114
    ## 349        3.8333985             4.582083        6.403276       5.934878
    ## 353        4.4860207             4.697842        3.299284       4.015618
    ## 357        4.4904977             5.127559        5.450383       5.858110
    ## 361        4.3557529             4.503026        3.988795       5.158383
    ## 365        5.7323605             4.601264        5.564071       4.748454
    ## 369        4.1488967             5.169257        5.095086       6.456235
    ## 373        5.6791714             3.859539        4.532258       5.734778
    ## 377        4.2837577             3.318993        6.411840       4.761066
    ## 381        4.2762726             2.534605        4.563430       2.461779
    ## 385        4.7323347             7.004915        4.037597       4.252248
    ## 389        3.3431388             4.968700        4.127508       5.233773
    ## 393        5.2863088             6.409289        7.179271       4.932395
    ## 397        3.4704338             4.698330        3.436845       4.071562
    ##     openness_t4
    ## 1      3.978259
    ## 5      3.901340
    ## 9      3.377854
    ## 13     4.518150
    ## 17     6.146045
    ## 21     4.826835
    ## 25     4.673520
    ## 29     3.257121
    ## 33     3.127249
    ## 37     5.398074
    ## 41     4.222339
    ## 45     4.540672
    ## 49     5.874701
    ## 53     4.149667
    ## 57     5.429929
    ## 61     4.478444
    ## 65     5.178806
    ## 69     5.592409
    ## 73     5.106745
    ## 77     4.297549
    ## 81     4.379564
    ## 85     4.203287
    ## 89     5.641575
    ## 93     6.407032
    ## 97     4.165775
    ## 101    3.667541
    ## 105    3.946275
    ## 109    3.451926
    ## 113    5.677083
    ## 117    3.117372
    ## 121    5.240915
    ## 125    2.985117
    ## 129    4.198548
    ## 133    6.463865
    ## 137    5.113000
    ## 141    4.570097
    ## 145    4.682357
    ## 149    4.005452
    ## 153    5.031407
    ## 157    2.778843
    ## 161    3.844464
    ## 165    4.554471
    ## 169    6.195381
    ## 173    5.628624
    ## 177    5.111613
    ## 181    5.199294
    ## 185    5.281653
    ## 189    3.459528
    ## 193    4.242592
    ## 197    4.661522
    ## 201    3.769799
    ## 205    6.004326
    ## 209    3.832623
    ## 213    3.030117
    ## 217    3.960900
    ## 221    4.522333
    ## 225    4.530001
    ## 229    4.809771
    ## 233    5.311566
    ## 237    5.408697
    ## 241    4.982356
    ## 245    6.416355
    ## 249    4.565640
    ## 253    5.475376
    ## 257    5.950675
    ## 261    3.244652
    ## 265    5.260961
    ## 269    6.264954
    ## 273    5.206001
    ## 277    3.463376
    ## 281    4.595603
    ## 285    4.437876
    ## 289    4.741871
    ## 293    5.277941
    ## 297    3.571144
    ## 301    4.422827
    ## 305    4.276665
    ## 309    5.208885
    ## 313    6.046759
    ## 317    5.747604
    ## 321    2.010656
    ## 325    3.937027
    ## 329    2.532035
    ## 333    6.414751
    ## 337    5.049144
    ## 341    4.987861
    ## 345    4.356449
    ## 349    3.468709
    ## 353    4.618889
    ## 357    4.979438
    ## 361    3.734107
    ## 365    4.699912
    ## 369    4.416915
    ## 373    4.305601
    ## 377    4.220867
    ## 381    4.819919
    ## 385    4.494506
    ## 389    3.125770
    ## 393    3.862872
    ## 397    3.633285

Whew, it worked! By learning this limitation of `reshape()`, you're
avoiding a very confusing rabbit hole that I spent almost a full week
in!

Side note: tidyverse functions will turn your data into tibbles, so be
aware (the one exception is pipes; they don't do that).

#### Using reshape(): wide to long

Now, you can use `reshape()` to go from wide to long too. I'd recommend
using `gather()` from tidyr for that instead, but for the sake of
completeness, this is how it would work:

    sample_b5_data_wide %>%
        #never forget to make it a data.frame!
        as.data.frame() %>%
        # when going from wide to long, you have to tell it the varying variables.
        # These are the columns that contain the information you want in rows.
        # This is a little confusing, but basically, you give it a list, with vectors for each thing that shares that information.
        # So, all the t1 variables go into the same vector
        # then, all the t2 variables go into the same vector, etc.
        reshape(varying = c(c("agreeableness_t1", "conscientiousness_t1", "extraversion_t1", "neuroticism_t1", "openness_t1"),
                            c("agreeableness_t2", "conscientiousness_t2", "extraversion_t2", "neuroticism_t2", "openness_t2"),
                            c("agreeableness_t3", "conscientiousness_t3", "extraversion_t3", "neuroticism_t3", "openness_t3"),
                            c("agreeableness_t4", "conscientiousness_t4", "extraversion_t4", "neuroticism_t4", "openness_t4")),
                # sep is really important here, because it tells it where to split the columns
                sep = "_",
                # and of course, tell it the direction
                direction = "long")

    ##        pid time agreeableness conscientiousness extraversion neuroticism
    ## 1.t1     1   t1     3.2954000         2.5017864    3.8512798   1.5381061
    ## 2.t1     2   t1     3.3482229         3.2142390    3.9011192   2.7935626
    ## 3.t1     3   t1     3.1717094         3.3196600    1.9472454   2.7036269
    ## 4.t1     4   t1     2.7270706         2.0105316    2.1005110   1.0552546
    ## 5.t1     5   t1     2.3132660         3.3125555    2.1645307   3.0856089
    ## 6.t1     6   t1     3.6206076         3.2143789    3.4793919   3.9779149
    ## 7.t1     7   t1     1.2012647         2.9883435    4.8593700   2.5078946
    ## 8.t1     8   t1     2.6668007         3.8151968    3.9870667   3.3353156
    ## 9.t1     9   t1     2.4674331         4.6566941    2.5083315   1.9645364
    ## 10.t1   10   t1     2.8952841         2.3883707    1.7332409   2.3208905
    ## 11.t1   11   t1     1.6249801         2.7673578    3.5901150   1.0888272
    ## 12.t1   12   t1     2.7919682         3.1177216    2.3320321   2.3427939
    ## 13.t1   13   t1     1.5245756         3.3441209    3.2230742   4.0540895
    ## 14.t1   14   t1     3.2823041         4.0592797    2.8603830   5.3202188
    ## 15.t1   15   t1     3.3672283         3.8950743    3.4069336   3.8657255
    ## 16.t1   16   t1     2.5065916         1.2808565    0.3076700   1.8037538
    ## 17.t1   17   t1     2.9134956         3.0861547    4.6755192   3.3351296
    ## 18.t1   18   t1     3.3806363         2.7764658    2.7175009   1.8511239
    ## 19.t1   19   t1     2.0703648         1.1211731    3.3402942   3.8140410
    ## 20.t1   20   t1     2.5268204         3.2635021    1.5994480   4.7625389
    ## 21.t1   21   t1     1.6947200         3.6229829    1.4243016   3.0923012
    ## 22.t1   22   t1     2.9859800         3.0591906    3.4768514   3.7835987
    ## 23.t1   23   t1     2.6501808         2.9317918    2.4303685   2.7717869
    ## 24.t1   24   t1     3.6736280         1.2067011    2.8402924   2.3714523
    ## 25.t1   25   t1     3.2105684         0.9368747    2.6511579   2.2536083
    ## 26.t1   26   t1     4.0301373         3.8193931    4.2513412   3.3261404
    ## 27.t1   27   t1     4.4494338         3.6713921    4.1554783   2.1033523
    ## 28.t1   28   t1     5.5996526         1.2219960    3.7255766   3.4914055
    ## 29.t1   29   t1     4.2191526         3.7953330    2.9765463   2.4578513
    ## 30.t1   30   t1     3.2025431         3.8085309    1.4598745   3.5904652
    ## 31.t1   31   t1     3.5158388         3.8011366    2.2458497   2.8074966
    ## 32.t1   32   t1     4.0426877         3.6678598    3.9536184   4.4029395
    ## 33.t1   33   t1     2.8116299         2.9457642    4.3110606   2.3958206
    ## 34.t1   34   t1     3.2963668         3.0308976    2.8190443   3.7591303
    ## 35.t1   35   t1     2.7909891         4.5531627    2.1814712   3.5861054
    ## 36.t1   36   t1     2.2983740         3.8680539    3.3875714   3.5395610
    ## 37.t1   37   t1     0.6284759         4.0918779    3.2613241   1.2099895
    ## 38.t1   38   t1     2.9056731         2.7248518    2.9431099   3.0431007
    ## 39.t1   39   t1     2.6513535         2.4071052    3.4576760   3.0739579
    ## 40.t1   40   t1     3.5692043         3.2860651    3.9080106   1.7579759
    ## 41.t1   41   t1     3.7008406         3.1291082    3.2980887   2.6953407
    ## 42.t1   42   t1     2.2664471         3.9071541    2.7999335   2.6300580
    ## 43.t1   43   t1     3.2109840         3.0975422    2.6656921   2.7567174
    ## 44.t1   44   t1     2.6507549         1.9472246    2.1200442   3.2436137
    ## 45.t1   45   t1     2.7383795         2.1382764    2.7199373   3.9894191
    ## 46.t1   46   t1    -0.1744927         2.6467923    3.9202164   3.4616449
    ## 47.t1   47   t1     2.5613671         3.8774233    1.2082597   1.0839201
    ## 48.t1   48   t1     4.2799202         2.8063763    2.4820714   2.7195213
    ## 49.t1   49   t1     2.5961688         3.4130652    0.7357744   1.9936084
    ## 50.t1   50   t1     3.2877357         4.0863425    3.1992167   2.0225750
    ## 51.t1   51   t1     3.8025852         5.2872556    3.1844096   1.1248601
    ## 52.t1   52   t1     2.5958432         3.7351872    4.1216340   2.7540373
    ## 53.t1   53   t1     4.3456144         1.5948031    3.2585852   3.9989297
    ## 54.t1   54   t1     2.7802797         3.0436040    2.3479640   4.2936407
    ## 55.t1   55   t1     3.0630116         3.5225350    4.4364072   2.4114713
    ## 56.t1   56   t1     3.1510798         2.1655260    2.0600984   4.4492370
    ## 57.t1   57   t1     3.3388199         5.0854625    3.7706738   2.5181061
    ## 58.t1   58   t1     2.7454046         3.1576348    4.5851652   2.8573460
    ## 59.t1   59   t1     5.7607893         0.3899014    4.4013331   2.6901825
    ## 60.t1   60   t1     3.1336034         2.7257041    3.2924594   3.3446034
    ## 61.t1   61   t1     3.1844876         3.1143145    0.9261692   2.9788629
    ## 62.t1   62   t1     2.6592190         5.3357476    2.4661794   0.6110484
    ## 63.t1   63   t1     3.6150115         1.6405263    3.0190275   3.0550533
    ## 64.t1   64   t1     3.9092229         3.1259275    3.7698937   1.4667953
    ## 65.t1   65   t1     0.5061628         3.9452273    3.1297480   1.5116369
    ## 66.t1   66   t1     3.4213350         3.8015920    2.1342429   3.4499873
    ## 67.t1   67   t1     3.7308101         2.6596408    2.5909547   1.1050380
    ## 68.t1   68   t1     2.9077451         3.6299802    1.6447529   4.1404613
    ## 69.t1   69   t1     3.1971150         3.5726130    2.5222873   2.9873968
    ## 70.t1   70   t1     0.9519137         2.4863107    3.0904529   1.6276011
    ## 71.t1   71   t1     2.1465406         2.7216616    2.0309639   2.4447225
    ## 72.t1   72   t1     4.2524246         2.1865989    2.8970252   2.1391636
    ## 73.t1   73   t1     3.9113189         4.3444966    3.1121379   3.7289059
    ## 74.t1   74   t1     4.1011844         1.2785071    4.7769154   1.7686521
    ## 75.t1   75   t1     5.4168115         3.5739480    3.9542850   1.5339489
    ## 76.t1   76   t1     3.5395556         3.8065289    2.7257020   3.1633745
    ## 77.t1   77   t1     2.4518438         2.6937383    3.2548510   2.9804683
    ## 78.t1   78   t1     1.7543503         2.7546002    0.9828005   4.1379013
    ## 79.t1   79   t1     3.0251018         4.8894099    3.2877157   1.1756889
    ## 80.t1   80   t1     3.0158251         3.3940622    3.1942188   1.5439999
    ## 81.t1   81   t1     4.9161163         2.4327979    3.2534210   3.2556071
    ## 82.t1   82   t1     2.5254390         3.9112497    3.0408360   2.7131727
    ## 83.t1   83   t1     3.9084464         1.8478148    3.1840944   1.3134275
    ## 84.t1   84   t1     3.4495315         4.4488740    3.2656253   2.8234092
    ## 85.t1   85   t1     5.6961362         2.0469286    3.2269335   2.2259056
    ## 86.t1   86   t1     2.2258297         3.8725056    1.5521155   4.4768515
    ## 87.t1   87   t1     3.2893489         2.4784463    1.4578145   1.8312820
    ## 88.t1   88   t1     2.8081850         3.4553290    4.6823954   4.4043206
    ## 89.t1   89   t1     3.3223569         3.2352735    2.0912568   2.3862717
    ## 90.t1   90   t1     3.3360814         3.8073497    4.1424406   3.9327860
    ## 91.t1   91   t1     2.7105860         3.4187458    2.7268279   3.3748572
    ## 92.t1   92   t1     3.7543337         2.9387949    4.2478070   3.0741259
    ## 93.t1   93   t1     2.3976580         3.6480297    3.0581480   4.1237361
    ## 94.t1   94   t1     4.3088677         2.0486498    3.4495404   4.5413094
    ## 95.t1   95   t1     3.3638892         1.6034722    4.1662149   3.1105927
    ## 96.t1   96   t1     2.6957136         1.2700378    2.8236312   1.1221277
    ## 97.t1   97   t1     3.7800839         5.3373611    2.8681719   3.0044484
    ## 98.t1   98   t1     2.4799712         3.1666055    3.0166242   3.6358542
    ## 99.t1   99   t1     3.9146337         5.0228209    5.2743622   3.8162476
    ## 100.t1 100   t1     2.5494978         3.0487815    2.4892792   2.7361438
    ## 1.t2     1   t2     3.7643852         3.0105442    4.1371453   2.0936801
    ## 2.t2     2   t2     4.1521755         3.8294595    4.0216678   3.6703137
    ## 3.t2     3   t2     3.6493067         3.6983595    2.6574425   3.0665175
    ## 4.t2     4   t2     3.2010554         2.4076307    2.8540619   1.6872284
    ## 5.t2     5   t2     2.8122138         3.7406442    2.6720132   3.9042974
    ## 6.t2     6   t2     3.9485136         3.6690642    4.1988865   4.5024149
    ## 7.t2     7   t2     1.4927327         3.3651678    5.4391379   2.8143259
    ## 8.t2     8   t2     3.0328012         4.3341717    4.5886069   3.8520498
    ## 9.t2     9   t2     2.9189577         4.9985497    2.8635050   2.6312824
    ## 10.t2   10   t2     3.5007475         2.8622594    2.1273634   3.0550037
    ## 11.t2   11   t2     1.9799834         3.1870209    4.0491040   1.6023018
    ## 12.t2   12   t2     3.5930916         3.5697611    2.8306742   2.8295065
    ## 13.t2   13   t2     1.9730179         3.5423112    3.8374373   4.5376990
    ## 14.t2   14   t2     3.9601387         4.3806900    3.3399920   6.1551990
    ## 15.t2   15   t2     3.8525077         4.2392103    3.6365558   4.0724933
    ## 16.t2   16   t2     3.3631243         1.7223589    1.1395438   2.5680820
    ## 17.t2   17   t2     3.2694067         3.3975939    5.0331989   3.7584484
    ## 18.t2   18   t2     3.8979866         3.3093198    3.1409638   2.3802152
    ## 19.t2   19   t2     2.5407174         1.5651132    3.9633279   4.3270449
    ## 20.t2   20   t2     3.1331516         3.9123661    1.6991360   5.5501162
    ## 21.t2   21   t2     2.0672612         4.1381650    1.7906837   3.1757640
    ## 22.t2   22   t2     3.1606694         3.4074435    3.9722651   4.2835552
    ## 23.t2   23   t2     3.2082259         3.4618193    3.4214434   3.4834479
    ## 24.t2   24   t2     4.1639972         1.4892921    3.5678141   2.9145763
    ## 25.t2   25   t2     3.7518689         1.3656036    3.1777492   2.5470217
    ## 26.t2   26   t2     4.5556124         4.1957792    4.6581961   3.2747161
    ## 27.t2   27   t2     4.9371897         3.7998339    4.7705199   3.0787892
    ## 28.t2   28   t2     6.1298563         1.4904730    4.1291113   4.0379660
    ## 29.t2   29   t2     4.5981312         4.3504911    3.0952618   2.9557403
    ## 30.t2   30   t2     3.7195450         4.1700819    2.0689383   4.1562925
    ## 31.t2   31   t2     4.2601907         4.3285850    2.7498759   3.6822841
    ## 32.t2   32   t2     4.5993616         3.8830968    4.5775633   4.9549629
    ## 33.t2   33   t2     3.4878259         3.1858681    4.5552804   2.7749850
    ## 34.t2   34   t2     4.0122921         3.5182062    3.2420681   4.0483246
    ## 35.t2   35   t2     3.4098411         4.8228123    2.3805107   4.0654626
    ## 36.t2   36   t2     2.7038990         4.4104497    3.8433300   4.2706499
    ## 37.t2   37   t2     1.1429821         4.5923093    3.7463493   1.4866828
    ## 38.t2   38   t2     3.0816620         2.8825932    3.4392832   3.7080544
    ## 39.t2   39   t2     3.0842566         3.0829285    3.8027556   3.4734280
    ## 40.t2   40   t2     3.7582605         3.9173015    4.1147557   2.2701377
    ## 41.t2   41   t2     4.0236350         3.7428084    3.6242124   3.4453512
    ## 42.t2   42   t2     2.9072583         4.5010679    3.2457924   3.1194590
    ## 43.t2   43   t2     4.0589104         3.4238988    3.5815234   3.3604732
    ## 44.t2   44   t2     3.2785560         2.1429949    3.0237412   4.0637931
    ## 45.t2   45   t2     3.4764725         2.9313458    3.2714597   4.8688939
    ## 46.t2   46   t2     0.1440576         3.5294474    4.3660052   4.1122774
    ## 47.t2   47   t2     3.4107590         4.2768821    1.7751984   1.6038659
    ## 48.t2   48   t2     4.7103718         3.3960997    2.8090859   3.2740552
    ## 49.t2   49   t2     2.9449711         3.7601172    1.4238599   2.0735108
    ## 50.t2   50   t2     3.8005392         4.2131176    3.4333463   1.9408435
    ## 51.t2   51   t2     4.1458946         6.1193065    3.3631134   1.7629360
    ## 52.t2   52   t2     2.9785170         4.4544301    4.6158925   3.4692978
    ## 53.t2   53   t2     4.9214497         2.2678625    3.8439225   4.6838014
    ## 54.t2   54   t2     2.8839373         3.5181669    3.0316061   4.4305416
    ## 55.t2   55   t2     3.5353063         4.2553172    5.0492863   2.5219409
    ## 56.t2   56   t2     3.8797947         2.4846671    2.5480009   5.0564552
    ## 57.t2   57   t2     3.6164247         5.9028367    4.6607751   3.1380623
    ## 58.t2   58   t2     3.0138107         3.8099136    4.9936575   3.4661289
    ## 59.t2   59   t2     6.2412082         0.9116384    4.6364757   3.2429900
    ## 60.t2   60   t2     3.8201229         3.5807296    4.3440313   3.7426009
    ## 61.t2   61   t2     3.6955974         3.7314587    1.6235777   3.4039953
    ## 62.t2   62   t2     2.7900974         5.7672383    3.1152095   0.8467640
    ## 63.t2   63   t2     4.3358159         1.7015779    3.7807555   3.4523726
    ## 64.t2   64   t2     4.4210909         3.8015928    4.1309084   1.9616490
    ## 65.t2   65   t2     1.1985337         4.4441987    3.6375334   1.7746034
    ## 66.t2   66   t2     3.8032159         4.1111726    2.5225784   3.7459934
    ## 67.t2   67   t2     4.2966563         3.2092402    2.9763125   1.8048704
    ## 68.t2   68   t2     3.5718882         4.0172088    2.4127737   4.9513517
    ## 69.t2   69   t2     3.7515159         4.0797364    3.5844586   3.6131861
    ## 70.t2   70   t2     1.1899220         3.1973202    3.8774015   2.1703139
    ## 71.t2   71   t2     2.5768153         3.2274653    2.8076410   2.9480446
    ## 72.t2   72   t2     4.9107669         2.3352798    3.3419382   2.6243778
    ## 73.t2   73   t2     4.3187487         4.5952504    3.6210758   4.3193451
    ## 74.t2   74   t2     4.8863357         1.5217282    5.1344918   2.1614350
    ## 75.t2   75   t2     6.0326078         4.1150060    4.3588705   2.1741782
    ## 76.t2   76   t2     3.9456288         4.4010138    3.0442657   3.7159221
    ## 77.t2   77   t2     3.3676967         3.2821954    3.9972136   3.5374229
    ## 78.t2   78   t2     2.1437692         3.2106754    1.9874092   4.3838600
    ## 79.t2   79   t2     3.2730058         5.1829228    3.9486258   1.6872563
    ## 80.t2   80   t2     3.6850920         3.8451843    3.6395691   1.7012907
    ## 81.t2   81   t2     5.5177550         3.0854460    3.8052317   3.6382516
    ## 82.t2   82   t2     2.6687964         4.4170053    3.6677655   2.9884672
    ## 83.t2   83   t2     4.6510002         2.2807317    3.7220113   1.7671434
    ## 84.t2   84   t2     4.0730689         4.8476899    3.7209351   3.2008552
    ## 85.t2   85   t2     6.0663448         2.4669578    3.7283987   2.9569148
    ## 86.t2   86   t2     3.0660138         4.4173393    2.0965700   4.8276271
    ## 87.t2   87   t2     4.1493591         3.3000992    1.9632459   2.4168284
    ## 88.t2   88   t2     3.2137782         3.8711372    5.4612445   4.7392633
    ## 89.t2   89   t2     3.8122420         3.5775554    2.4135336   2.9172261
    ## 90.t2   90   t2     3.8304125         4.3712045    4.3369280   4.2020732
    ## 91.t2   91   t2     3.1224673         3.6655673    3.2309180   3.9037009
    ## 92.t2   92   t2     4.3569405         3.4324893    4.6107629   3.4698956
    ## 93.t2   93   t2     2.9343064         4.2136478    3.5854957   5.1011416
    ## 94.t2   94   t2     4.7482999         2.6768342    3.8849343   5.1174701
    ## 95.t2   95   t2     3.9305051         2.2196939    4.6562710   3.7596832
    ## 96.t2   96   t2     3.1249579         1.6322025    3.5062775   1.7079699
    ## 97.t2   97   t2     3.9891698         5.9213996    3.4218470   3.0454228
    ## 98.t2   98   t2     2.7400564         3.6983310    3.5502174   3.8395346
    ## 99.t2   99   t2     4.5585907         5.1970155    5.5338013   4.0563794
    ## 100.t2 100   t2     2.8144715         3.9293416    2.5880365   3.0507950
    ## 1.t3     1   t3     4.0915834         3.6089691    4.7918211   2.6070967
    ## 2.t3     2   t3     4.5949357         4.1237843    4.7391974   4.1504086
    ## 3.t3     3   t3     4.3289072         4.5106159    3.1402804   3.9247322
    ## 4.t3     4   t3     3.6077913         2.5479016    3.3233453   2.1667525
    ## 5.t3     5   t3     3.1880169         4.4058525    3.2622480   4.5084255
    ## 6.t3     6   t3     4.5302352         3.8562771    4.3293149   5.0194474
    ## 7.t3     7   t3     1.8235455         3.4042434    5.6315769   3.1922609
    ## 8.t3     8   t3     3.3201799         4.9799327    5.0648733   4.9030604
    ## 9.t3     9   t3     3.2529958         5.3978217    3.8068764   3.1300765
    ## 10.t3   10   t3     3.5827416         2.9610605    2.3338243   4.0012532
    ## 11.t3   11   t3     2.3282129         3.7638644    4.8386811   2.0814148
    ## 12.t3   12   t3     3.9679360         4.0414328    3.3614674   3.1718677
    ## 13.t3   13   t3     2.3761802         4.3066725    4.5614099   5.1171066
    ## 14.t3   14   t3     4.7057292         5.1811907    4.5551235   6.5206901
    ## 15.t3   15   t3     4.4593385         4.8569090    3.8958667   4.2437782
    ## 16.t3   16   t3     4.0729353         2.2776618    1.4911129   3.0995009
    ## 17.t3   17   t3     3.8788244         3.8127901    5.6845830   3.9091500
    ## 18.t3   18   t3     4.3359075         3.6569902    3.9050169   3.0776954
    ## 19.t3   19   t3     3.0339199         2.1537119    4.4403459   4.7523108
    ## 20.t3   20   t3     3.5895799         4.4527913    2.4041225   6.0928846
    ## 21.t3   21   t3     2.6512684         4.6286029    2.4462535   3.4651085
    ## 22.t3   22   t3     3.7549081         3.6164564    4.6383058   4.6235277
    ## 23.t3   23   t3     3.5715029         3.9008451    4.0352934   3.7572951
    ## 24.t3   24   t3     4.7917521         2.0161697    3.8219608   3.2638914
    ## 25.t3   25   t3     4.1705554         1.8963070    3.9342013   3.0342550
    ## 26.t3   26   t3     4.9427813         4.7448124    4.9089536   3.7503730
    ## 27.t3   27   t3     5.6904660         4.1321542    5.2607639   3.5138137
    ## 28.t3   28   t3     6.6586686         2.0627124    4.4382325   4.1685412
    ## 29.t3   29   t3     5.5603691         5.0353553    3.5585577   3.2648616
    ## 30.t3   30   t3     4.3048353         4.2657003    2.6997470   4.8235399
    ## 31.t3   31   t3     5.0585635         4.9774922    3.0907354   4.2327030
    ## 32.t3   32   t3     5.3333536         4.2469464    4.8753977   5.5975016
    ## 33.t3   33   t3     3.6410419         3.6701753    5.0399606   3.0297928
    ## 34.t3   34   t3     4.6430380         4.1063105    3.9049084   4.4821602
    ## 35.t3   35   t3     3.7472708         5.2878977    3.3056186   4.4082014
    ## 36.t3   36   t3     2.9961782         5.0125459    4.3191097   4.5495474
    ## 37.t3   37   t3     1.4946167         5.1420355    4.0102849   1.9302596
    ## 38.t3   38   t3     3.6739948         3.4369970    3.7852094   4.3303567
    ## 39.t3   39   t3     3.5827346         3.6187695    4.1782190   4.2407807
    ## 40.t3   40   t3     4.1092338         4.6936709    4.2508101   2.8112538
    ## 41.t3   41   t3     4.1814848         4.2526592    4.2314644   3.7985183
    ## 42.t3   42   t3     3.4217279         5.0482602    3.9210982   3.3785552
    ## 43.t3   43   t3     4.5843414         3.4609150    3.7353948   3.6229865
    ## 44.t3   44   t3     3.9627248         3.0374757    3.6375237   4.5112823
    ## 45.t3   45   t3     3.9943090         3.0802406    3.6217456   5.3415219
    ## 46.t3   46   t3     0.5895644         4.0660504    4.7956285   4.7917979
    ## 47.t3   47   t3     4.2726497         4.9109228    2.1196339   2.0744570
    ## 48.t3   48   t3     5.0010125         3.7644883    3.6010926   3.8093795
    ## 49.t3   49   t3     3.5256416         4.3636307    1.7743356   2.3898818
    ## 50.t3   50   t3     4.3328163         4.7718402    3.8920677   2.2090176
    ## 51.t3   51   t3     4.9363944         6.6746408    3.7564326   2.2912076
    ## 52.t3   52   t3     3.4424035         4.8075160    5.1266513   3.8807485
    ## 53.t3   53   t3     5.3117221         2.7904826    4.2503673   5.4105657
    ## 54.t3   54   t3     3.6197793         4.1351332    3.3886924   4.6873964
    ## 55.t3   55   t3     4.1435173         4.7525886    5.3210335   2.9865774
    ## 56.t3   56   t3     4.7085992         2.8188715    3.3025701   5.8683667
    ## 57.t3   57   t3     3.8065532         6.3107828    5.1903374   3.5928418
    ## 58.t3   58   t3     3.2193474         4.1943193    5.2507869   4.3008721
    ## 59.t3   59   t3     6.8958836         1.3734099    4.7470010   3.3980817
    ## 60.t3   60   t3     4.3550644         4.2119095    4.8405235   3.9367364
    ## 61.t3   61   t3     4.5319971         4.5915560    2.0125435   3.8102587
    ## 62.t3   62   t3     3.5575078         6.3408022    3.4813953   1.4411315
    ## 63.t3   63   t3     4.9241834         2.1207258    4.2538912   4.1035913
    ## 64.t3   64   t3     4.9285759         4.3593489    4.9420715   2.3290307
    ## 65.t3   65   t3     2.0016224         5.3783404    4.2917412   2.2608518
    ## 66.t3   66   t3     3.9964272         5.1160543    2.7548706   4.1844566
    ## 67.t3   67   t3     4.8043065         3.9195247    3.4955213   2.1647266
    ## 68.t3   68   t3     4.2135660         4.4045777    2.6492107   5.2740793
    ## 69.t3   69   t3     4.2248249         4.6947505    4.2235341   4.3611168
    ## 70.t3   70   t3     1.8398092         3.5833929    4.6012237   2.6077141
    ## 71.t3   71   t3     3.4071516         3.7698820    3.8591854   3.9481372
    ## 72.t3   72   t3     5.2049373         2.6917363    3.4490530   3.3043004
    ## 73.t3   73   t3     4.8658745         5.1930782    4.0499047   4.7862809
    ## 74.t3   74   t3     5.2235993         1.8032136    5.6927003   2.5713339
    ## 75.t3   75   t3     6.5887810         4.7505772    4.8788323   2.5645378
    ## 76.t3   76   t3     4.5875079         5.0093945    3.3942548   3.9357037
    ## 77.t3   77   t3     3.7705245         3.8929595    4.7067345   3.9225785
    ## 78.t3   78   t3     2.7391625         3.5920045    2.7157690   4.8636222
    ## 79.t3   79   t3     3.7115257         5.5397927    4.2847728   2.0160168
    ## 80.t3   80   t3     3.9053337         4.8361458    4.3998053   2.0692008
    ## 81.t3   81   t3     6.0184928         3.5506557    4.1073534   4.1559595
    ## 82.t3   82   t3     2.7734493         4.8172783    4.2393774   3.3334184
    ## 83.t3   83   t3     5.1794539         2.8483878    3.9797703   1.8690921
    ## 84.t3   84   t3     4.6362410         5.5497438    4.0994886   3.7410786
    ## 85.t3   85   t3     6.6347842         2.7313050    4.4156063   3.5636153
    ## 86.t3   86   t3     3.5747820         4.5074026    2.8136405   5.2310356
    ## 87.t3   87   t3     4.2243043         3.6711773    2.4298309   2.9952725
    ## 88.t3   88   t3     3.7690479         4.1959094    5.8819938   5.3815267
    ## 89.t3   89   t3     4.0443437         3.7431475    2.7707537   3.6275064
    ## 90.t3   90   t3     4.1662236         4.8461317    5.1020736   5.0156876
    ## 91.t3   91   t3     3.7960267         3.9812648    3.5302337   4.3626529
    ## 92.t3   92   t3     5.1998734         3.8233348    5.1184713   3.9920683
    ## 93.t3   93   t3     3.3264715         4.6731815    4.4484105   5.7808816
    ## 94.t3   94   t3     5.2658272         3.2841850    4.3982669   5.5073337
    ## 95.t3   95   t3     4.1066225         2.9213956    5.5764882   4.2477629
    ## 96.t3   96   t3     3.9357940         2.1417762    4.1717243   1.9566492
    ## 97.t3   97   t3     4.3145032         6.5454252    3.6929264   3.4940891
    ## 98.t3   98   t3     3.1141232         4.2837911    3.5507999   4.3035844
    ## 99.t3   99   t3     5.0902466         5.8073857    6.3148182   4.6603330
    ## 100.t3 100   t3     3.1526432         4.3403305    2.7058764   3.5847711
    ## 1.t4     1   t4     4.6297021         4.2732385    4.9944275   2.8586962
    ## 2.t4     2   t4     5.4101648         4.7851955    5.3765202   4.2435133
    ## 3.t4     3   t4     4.5974554         4.8535150    3.5155866   4.2295057
    ## 4.t4     4   t4     4.2441328         3.0682277    3.6977749   2.9079715
    ## 5.t4     5   t4     3.5831228         4.6333483    3.7843449   5.1678821
    ## 6.t4     6   t4     5.1996963         4.3934685    5.0962468   5.2240633
    ## 7.t4     7   t4     2.1144065         3.5031501    6.2111780   3.7587456
    ## 8.t4     8   t4     4.0530934         5.1249622    5.7250130   5.1814307
    ## 9.t4     9   t4     3.6276168         5.7766753    4.3240420   3.4333638
    ## 10.t4   10   t4     4.0591125         3.8124280    2.5531071   4.5070887
    ## 11.t4   11   t4     2.7866668         4.4698332    5.3137258   2.4757581
    ## 12.t4   12   t4     4.5695460         4.7318364    3.6367353   3.7561012
    ## 13.t4   13   t4     2.9992328         5.1092467    5.0292944   5.5337828
    ## 14.t4   14   t4     5.0636751         5.6398692    4.9450283   6.7727654
    ## 15.t4   15   t4     5.0410122         4.9623921    4.0622882   4.6101457
    ## 16.t4   16   t4     4.5716159         2.9642117    1.9092784   3.4213266
    ## 17.t4   17   t4     4.4650731         4.1286810    6.5532572   4.3850611
    ## 18.t4   18   t4     5.1664275         4.1889629    4.2751942   3.4381553
    ## 19.t4   19   t4     3.6178928         3.0588415    5.1458435   5.2203197
    ## 20.t4   20   t4     4.3310638         5.0149026    3.0452248   6.7864629
    ## 21.t4   21   t4     2.9739203         4.8593693    3.0212615   3.6810243
    ## 22.t4   22   t4     4.4727628         4.1245696    5.3728297   4.9563371
    ## 23.t4   23   t4     4.0033585         4.3021480    4.6364501   4.0761280
    ## 24.t4   24   t4     5.1064703         2.4587570    4.5105248   3.3314058
    ## 25.t4   25   t4     4.7124411         2.5149828    4.5704229   3.3482719
    ## 26.t4   26   t4     5.6521692         5.1970767    5.2225631   4.0449715
    ## 27.t4   27   t4     6.4962050         4.6971807    5.5562898   4.0842120
    ## 28.t4   28   t4     7.0105817         2.6502624    5.1081856   4.5856333
    ## 29.t4   29   t4     5.9637831         5.3618038    4.1995942   3.4088156
    ## 30.t4   30   t4     4.6402154         4.8612778    3.0297834   5.1689437
    ## 31.t4   31   t4     5.7743260         5.6429484    3.7827026   4.8045997
    ## 32.t4   32   t4     5.6298450         4.8415567    5.2925154   5.9198278
    ## 33.t4   33   t4     3.9161477         3.9913377    5.3500240   3.6637433
    ## 34.t4   34   t4     5.3224076         4.6227577    4.2910975   5.0585114
    ## 35.t4   35   t4     4.1570181         6.0038975    3.4839002   4.8737004
    ## 36.t4   36   t4     3.9765704         5.7229644    4.9934962   5.4015085
    ## 37.t4   37   t4     2.5070732         5.6065977    4.6354944   2.7796409
    ## 38.t4   38   t4     3.7633846         3.8382693    3.9464854   5.1591311
    ## 39.t4   39   t4     3.7000993         4.0988146    4.8956791   4.7953934
    ## 40.t4   40   t4     4.6535565         5.2065537    4.8452659   3.1572120
    ## 41.t4   41   t4     4.7264100         4.5483910    4.7063515   4.1974969
    ## 42.t4   42   t4     4.2195724         5.3412804    4.3376007   3.7589275
    ## 43.t4   43   t4     5.2171917         3.9236431    4.0912227   4.3336860
    ## 44.t4   44   t4     4.8862447         3.7036342    4.1003965   5.0421036
    ## 45.t4   45   t4     4.4118006         3.5334978    4.3060208   5.6120054
    ## 46.t4   46   t4     0.8582212         4.6973296    4.7445991   5.5793714
    ## 47.t4   47   t4     5.0236938         5.3813742    2.6380465   2.5795986
    ## 48.t4   48   t4     5.5374305         4.1441359    4.3255521   4.4442278
    ## 49.t4   49   t4     3.5704247         5.1192759    2.5164569   3.1602320
    ## 50.t4   50   t4     4.7958007         5.4311159    3.8513720   2.6556882
    ## 51.t4   51   t4     5.4537325         6.9803120    4.3531043   2.7315172
    ## 52.t4   52   t4     3.9704290         5.1923315    5.5132011   4.2811884
    ## 53.t4   53   t4     6.1589819         3.7141464    4.1814763   6.1881514
    ## 54.t4   54   t4     4.0362002         4.3111388    3.9431151   5.0878646
    ## 55.t4   55   t4     4.4817692         5.2719154    5.9980526   3.3992090
    ## 56.t4   56   t4     5.3211832         3.2560804    3.9011313   6.3292878
    ## 57.t4   57   t4     4.3332037         7.1876625    5.8467159   3.8535769
    ## 58.t4   58   t4     4.0078806         4.6225087    5.5212879   5.2461209
    ## 59.t4   59   t4     7.2923313         2.0318030    5.1046724   3.6470670
    ## 60.t4   60   t4     4.6152147         4.7803972    5.5131394   4.4535464
    ## 61.t4   61   t4     4.8382476         4.9117485    2.3374162   4.1639355
    ## 62.t4   62   t4     4.4466848         7.0291247    4.2803072   1.7462815
    ## 63.t4   63   t4     5.3449509         2.8013356    4.9310021   4.3023268
    ## 64.t4   64   t4     5.4178576         4.7889257    5.3440918   2.9356007
    ## 65.t4   65   t4     2.5934522         5.8419789    4.9212197   3.0396352
    ## 66.t4   66   t4     4.5002955         5.3760589    3.2446726   4.9430831
    ## 67.t4   67   t4     4.9603493         4.5380483    3.8893805   2.7222784
    ## 68.t4   68   t4     4.4382165         4.8275046    3.0351591   5.8225712
    ## 69.t4   69   t4     4.6488008         5.1759431    4.9097200   4.4955489
    ## 70.t4   70   t4     2.2086426         3.9079530    4.9920764   2.9861196
    ## 71.t4   71   t4     3.8060058         4.0126219    4.1920294   4.4046880
    ## 72.t4   72   t4     5.5916499         3.4135103    3.8422151   3.6908573
    ## 73.t4   73   t4     5.4152276         5.9282488    4.8031641   5.5172972
    ## 74.t4   74   t4     5.9716857         2.2790490    6.4831238   3.0513878
    ## 75.t4   75   t4     7.3747236         5.4965108    5.3235533   3.0614881
    ## 76.t4   76   t4     5.2365861         5.8260779    3.6101007   4.4769010
    ## 77.t4   77   t4     4.4580713         4.4280002    5.1586029   4.5520927
    ## 78.t4   78   t4     3.5161958         4.0887066    3.3707859   5.7409001
    ## 79.t4   79   t4     4.2390488         6.3405936    4.8618474   2.3588989
    ## 80.t4   80   t4     4.2082759         5.1552769    4.7758306   2.2940077
    ## 81.t4   81   t4     6.5310778         4.2242825    4.6821470   4.2782878
    ## 82.t4   82   t4     2.8539641         5.4311032    4.7960948   3.7257957
    ## 83.t4   83   t4     5.7563163         3.4288504    4.2425159   1.9973773
    ## 84.t4   84   t4     4.8556887         5.8986556    4.4875399   4.1999577
    ## 85.t4   85   t4     7.1570173         3.5504555    4.8643309   3.8794867
    ## 86.t4   86   t4     4.0612725         4.8302862    3.3532179   5.5709699
    ## 87.t4   87   t4     4.7374509         4.2939734    3.2444062   3.5821142
    ## 88.t4   88   t4     3.8333985         4.5820829    6.4032760   5.9348783
    ## 89.t4   89   t4     4.4860207         4.6978420    3.2992840   4.0156182
    ## 90.t4   90   t4     4.4904977         5.1275591    5.4503834   5.8581101
    ## 91.t4   91   t4     4.3557529         4.5030256    3.9887946   5.1583833
    ## 92.t4   92   t4     5.7323605         4.6012639    5.5640707   4.7484542
    ## 93.t4   93   t4     4.1488967         5.1692571    5.0950856   6.4562348
    ## 94.t4   94   t4     5.6791714         3.8595390    4.5322583   5.7347778
    ## 95.t4   95   t4     4.2837577         3.3189928    6.4118404   4.7610656
    ## 96.t4   96   t4     4.2762726         2.5346046    4.5634304   2.4617792
    ## 97.t4   97   t4     4.7323347         7.0049148    4.0375972   4.2522485
    ## 98.t4   98   t4     3.3431388         4.9686999    4.1275083   5.2337732
    ## 99.t4   99   t4     5.2863088         6.4092886    7.1792710   4.9323948
    ## 100.t4 100   t4     3.4704338         4.6983302    3.4368451   4.0715617
    ##         openness  id
    ## 1.t1   2.2275104   1
    ## 2.t1   2.6271160   2
    ## 3.t1   1.7077356   3
    ## 4.t1   3.4514458   4
    ## 5.t1   4.6565225   5
    ## 6.t1   3.0110683   6
    ## 7.t1   3.4700955   7
    ## 8.t1   1.9233697   8
    ## 9.t1   2.0706178   9
    ## 10.t1  3.6506514  10
    ## 11.t1  2.8139396  11
    ## 12.t1  2.9160330  12
    ## 13.t1  4.5261936  13
    ## 14.t1  2.7836825  14
    ## 15.t1  3.4708575  15
    ## 16.t1  2.8030548  16
    ## 17.t1  3.2352183  17
    ## 18.t1  3.9873983  18
    ## 19.t1  3.4378295  19
    ## 20.t1  3.3222034  20
    ## 21.t1  2.2506141  21
    ## 22.t1  2.5434152  22
    ## 23.t1  4.1149405  23
    ## 24.t1  4.8815178  24
    ## 25.t1  2.4123356  25
    ## 26.t1  2.0637946  26
    ## 27.t1  2.6072119  27
    ## 28.t1  1.9280608  28
    ## 29.t1  3.8537626  29
    ## 30.t1  1.7413711  30
    ## 31.t1  3.6664482  31
    ## 32.t1  1.9001592  32
    ## 33.t1  2.7063259  33
    ## 34.t1  4.6491517  34
    ## 35.t1  3.8109188  35
    ## 36.t1  3.1876294  36
    ## 37.t1  3.0153533  37
    ## 38.t1  2.7089367  38
    ## 39.t1  3.2795653  39
    ## 40.t1  1.0499438  40
    ## 41.t1  2.7435339  41
    ## 42.t1  3.1383442  42
    ## 43.t1  4.6102051  43
    ## 44.t1  4.1778369  44
    ## 45.t1  3.6891573  45
    ## 46.t1  3.9154780  46
    ## 47.t1  3.7071888  47
    ## 48.t1  1.9815921  48
    ## 49.t1  3.2420952  49
    ## 50.t1  3.5040044  50
    ## 51.t1  2.0313395  51
    ## 52.t1  4.8515169  52
    ## 53.t1  2.7781244  53
    ## 54.t1  1.3316020  54
    ## 55.t1  2.8335023  55
    ## 56.t1  3.3508606  56
    ## 57.t1  2.6015181  57
    ## 58.t1  2.8699397  58
    ## 59.t1  3.4568261  59
    ## 60.t1  4.0054552  60
    ## 61.t1  3.9542148  61
    ## 62.t1  4.7876551  62
    ## 63.t1  2.6158272  63
    ## 64.t1  4.6912031  64
    ## 65.t1  4.1881475  65
    ## 66.t1  1.2202294  66
    ## 67.t1  3.7321366  67
    ## 68.t1  4.3899957  68
    ## 69.t1  3.3148470  69
    ## 70.t1  2.3181842  70
    ## 71.t1  3.3416792  71
    ## 72.t1  2.9610696  72
    ## 73.t1  3.4544760  73
    ## 74.t1  3.6772586  74
    ## 75.t1  2.3921037  75
    ## 76.t1  2.4362224  76
    ## 77.t1  2.2875774  77
    ## 78.t1  3.7134803  78
    ## 79.t1  4.4230688  79
    ## 80.t1  3.9705100  80
    ## 81.t1  0.8857988  81
    ## 82.t1  2.5179908  82
    ## 83.t1  1.3565063  83
    ## 84.t1  4.1596663  84
    ## 85.t1  4.1162164  85
    ## 86.t1  3.4725374  86
    ## 87.t1  2.6683378  87
    ## 88.t1  2.3776000  88
    ## 89.t1  2.5991811  89
    ## 90.t1  3.5477590  90
    ## 91.t1  2.6695254  91
    ## 92.t1  2.7511185  92
    ## 93.t1  3.2199360  93
    ## 94.t1  2.6809544  94
    ## 95.t1  2.3082174  95
    ## 96.t1  3.3051074  96
    ## 97.t1  2.9841207  97
    ## 98.t1  1.5368842  98
    ## 99.t1  2.8529241  99
    ## 100.t1 2.0238952 100
    ## 1.t2   2.8505735   1
    ## 2.t2   2.9226383   2
    ## 3.t2   2.3657963   3
    ## 4.t2   3.9591302   4
    ## 5.t2   5.1501968   5
    ## 6.t2   3.3808785   6
    ## 7.t2   4.0459648   7
    ## 8.t2   2.4394471   8
    ## 9.t2   2.4094179   9
    ## 10.t2  4.4505443  10
    ## 11.t2  3.4106352  11
    ## 12.t2  3.0902874  12
    ## 13.t2  5.1497410  13
    ## 14.t2  3.4299755  14
    ## 15.t2  4.1397559  15
    ## 16.t2  3.0825609  16
    ## 17.t2  3.9724460  17
    ## 18.t2  4.8118715  18
    ## 19.t2  3.9846477  19
    ## 20.t2  3.6652996  20
    ## 21.t2  2.7791638  21
    ## 22.t2  2.9347882  22
    ## 23.t2  4.8636527  23
    ## 24.t2  5.5304463  24
    ## 25.t2  3.1620699  25
    ## 26.t2  2.2787092  26
    ## 27.t2  2.7584029  27
    ## 28.t2  2.3979085  28
    ## 29.t2  4.6431032  29
    ## 30.t2  2.0379643  30
    ## 31.t2  4.1593500  31
    ## 32.t2  2.1186611  32
    ## 33.t2  3.5165333  33
    ## 34.t2  5.2983170  34
    ## 35.t2  4.5620117  35
    ## 36.t2  3.6887086  36
    ## 37.t2  3.7781808  37
    ## 38.t2  3.3203298  38
    ## 39.t2  4.0116498  39
    ## 40.t2  1.7423372  40
    ## 41.t2  3.1066353  41
    ## 42.t2  3.4690906  42
    ## 43.t2  5.3874882  43
    ## 44.t2  4.6534302  44
    ## 45.t2  4.1619681  45
    ## 46.t2  4.2241537  46
    ## 47.t2  4.2194130  47
    ## 48.t2  2.4617338  48
    ## 49.t2  3.5237597  49
    ## 50.t2  3.9763594  50
    ## 51.t2  2.7013784  51
    ## 52.t2  5.1658715  52
    ## 53.t2  2.7881008  53
    ## 54.t2  1.8326271  54
    ## 55.t2  3.2652147  55
    ## 56.t2  3.5720643  56
    ## 57.t2  3.0799137  57
    ## 58.t2  3.4377636  58
    ## 59.t2  3.8310117  59
    ## 60.t2  4.6405571  60
    ## 61.t2  4.1848607  61
    ## 62.t2  5.3671699  62
    ## 63.t2  3.1023431  63
    ## 64.t2  5.0505589  64
    ## 65.t2  4.7137002  65
    ## 66.t2  1.8456629  66
    ## 67.t2  4.2684245  67
    ## 68.t2  4.8601371  68
    ## 69.t2  3.8086644  69
    ## 70.t2  2.6883632  70
    ## 71.t2  3.7676101  71
    ## 72.t2  3.3682592  72
    ## 73.t2  3.8724205  73
    ## 74.t2  4.1531340  74
    ## 75.t2  2.7775696  75
    ## 76.t2  2.9469572  76
    ## 77.t2  3.0282975  77
    ## 78.t2  4.3093394  78
    ## 79.t2  5.1366742  79
    ## 80.t2  4.6229577  80
    ## 81.t2  1.4571191  81
    ## 82.t2  2.8397588  82
    ## 83.t2  1.9279119  83
    ## 84.t2  4.7668185  84
    ## 85.t2  4.4068984  85
    ## 86.t2  4.2073900  86
    ## 87.t2  3.7264228  87
    ## 88.t2  2.7144276  88
    ## 89.t2  3.2307026  89
    ## 90.t2  4.2682850  90
    ## 91.t2  2.8416983  91
    ## 92.t2  3.5345291  92
    ## 93.t2  3.5004674  93
    ## 94.t2  3.0625529  94
    ## 95.t2  2.9255352  95
    ## 96.t2  3.6401330  96
    ## 97.t2  3.7755505  97
    ## 98.t2  2.4943895  98
    ## 99.t2  3.0957169  99
    ## 100.t2 2.3624279 100
    ## 1.t3   3.2606008   1
    ## 2.t3   3.5571433   2
    ## 3.t3   2.9095366   3
    ## 4.t3   4.1783578   4
    ## 5.t3   5.5899384   5
    ## 6.t3   4.0163503   6
    ## 7.t3   4.6032415   7
    ## 8.t3   2.9832595   8
    ## 9.t3   3.0314045   9
    ## 10.t3  5.0326331  10
    ## 11.t3  4.0342684  11
    ## 12.t3  3.9391401  12
    ## 13.t3  5.6788987  13
    ## 14.t3  3.9174949  14
    ## 15.t3  5.0192013  15
    ## 16.t3  3.7063315  16
    ## 17.t3  4.3115737  17
    ## 18.t3  5.3174475  18
    ## 19.t3  4.4564284  19
    ## 20.t3  3.9382735  20
    ## 21.t3  3.5701857  21
    ## 22.t3  3.6638190  22
    ## 23.t3  5.1264630  23
    ## 24.t3  6.1294721  24
    ## 25.t3  3.8625515  25
    ## 26.t3  2.9054142  26
    ## 27.t3  3.1540874  27
    ## 28.t3  3.0815855  28
    ## 29.t3  5.1069997  29
    ## 30.t3  2.6399055  30
    ## 31.t3  4.9072898  31
    ## 32.t3  2.6186066  32
    ## 33.t3  3.7404900  33
    ## 34.t3  5.9173254  34
    ## 35.t3  4.5552206  35
    ## 36.t3  4.3213445  36
    ## 37.t3  4.1934455  37
    ## 38.t3  3.6453540  38
    ## 39.t3  4.6950362  39
    ## 40.t3  2.1833717  40
    ## 41.t3  3.2492767  41
    ## 42.t3  4.1613878  42
    ## 43.t3  5.8041517  43
    ## 44.t3  5.3028628  44
    ## 45.t3  4.6830141  45
    ## 46.t3  4.7667754  46
    ## 47.t3  4.7487876  47
    ## 48.t3  2.9011445  48
    ## 49.t3  3.9551431  49
    ## 50.t3  4.2882384  50
    ## 51.t3  3.2810088  51
    ## 52.t3  5.6905792  52
    ## 53.t3  3.1634767  53
    ## 54.t3  2.7740317  54
    ## 55.t3  3.8415495  55
    ## 56.t3  4.1466626  56
    ## 57.t3  3.7542018  57
    ## 58.t3  4.3455434  58
    ## 59.t3  4.4273841  59
    ## 60.t3  5.1798331  60
    ## 61.t3  4.6126994  61
    ## 62.t3  5.8413499  62
    ## 63.t3  3.7757556  63
    ## 64.t3  5.2603445  64
    ## 65.t3  5.2653441  65
    ## 66.t3  2.5580094  66
    ## 67.t3  4.7444423  67
    ## 68.t3  5.8700004  68
    ## 69.t3  4.3362769  69
    ## 70.t3  3.0143685  70
    ## 71.t3  3.9309465  71
    ## 72.t3  4.0025566  72
    ## 73.t3  4.2378133  73
    ## 74.t3  4.6489575  74
    ## 75.t3  3.3771138  75
    ## 76.t3  3.7407257  76
    ## 77.t3  3.4724106  77
    ## 78.t3  4.5617382  78
    ## 79.t3  5.4445544  79
    ## 80.t3  5.2783038  80
    ## 81.t3  1.9147446  81
    ## 82.t3  3.2525014  82
    ## 83.t3  2.2905974  83
    ## 84.t3  5.4858069  84
    ## 85.t3  4.8223959  85
    ## 86.t3  4.2755970  86
    ## 87.t3  4.0677252  87
    ## 88.t3  2.8919073  88
    ## 89.t3  4.0452038  89
    ## 90.t3  4.4681136  90
    ## 91.t3  2.9974524  91
    ## 92.t3  4.0026923  92
    ## 93.t3  4.1170773  93
    ## 94.t3  3.9131073  94
    ## 95.t3  3.6322587  95
    ## 96.t3  4.1017442  96
    ## 97.t3  4.0004122  97
    ## 98.t3  2.8399254  98
    ## 99.t3  3.4048057  99
    ## 100.t3 3.1094044 100
    ## 1.t4   3.9782590   1
    ## 2.t4   3.9013400   2
    ## 3.t4   3.3778545   3
    ## 4.t4   4.5181499   4
    ## 5.t4   6.1460450   5
    ## 6.t4   4.8268347   6
    ## 7.t4   4.6735204   7
    ## 8.t4   3.2571209   8
    ## 9.t4   3.1272491   9
    ## 10.t4  5.3980737  10
    ## 11.t4  4.2223391  11
    ## 12.t4  4.5406721  12
    ## 13.t4  5.8747005  13
    ## 14.t4  4.1496669  14
    ## 15.t4  5.4299288  15
    ## 16.t4  4.4784442  16
    ## 17.t4  5.1788063  17
    ## 18.t4  5.5924092  18
    ## 19.t4  5.1067447  19
    ## 20.t4  4.2975491  20
    ## 21.t4  4.3795642  21
    ## 22.t4  4.2032870  22
    ## 23.t4  5.6415753  23
    ## 24.t4  6.4070322  24
    ## 25.t4  4.1657754  25
    ## 26.t4  3.6675410  26
    ## 27.t4  3.9462752  27
    ## 28.t4  3.4519256  28
    ## 29.t4  5.6770829  29
    ## 30.t4  3.1173716  30
    ## 31.t4  5.2409151  31
    ## 32.t4  2.9851173  32
    ## 33.t4  4.1985477  33
    ## 34.t4  6.4638650  34
    ## 35.t4  5.1129996  35
    ## 36.t4  4.5700971  36
    ## 37.t4  4.6823569  37
    ## 38.t4  4.0054524  38
    ## 39.t4  5.0314068  39
    ## 40.t4  2.7788427  40
    ## 41.t4  3.8444643  41
    ## 42.t4  4.5544706  42
    ## 43.t4  6.1953811  43
    ## 44.t4  5.6286243  44
    ## 45.t4  5.1116134  45
    ## 46.t4  5.1992940  46
    ## 47.t4  5.2816526  47
    ## 48.t4  3.4595280  48
    ## 49.t4  4.2425920  49
    ## 50.t4  4.6615221  50
    ## 51.t4  3.7697994  51
    ## 52.t4  6.0043258  52
    ## 53.t4  3.8326226  53
    ## 54.t4  3.0301171  54
    ## 55.t4  3.9608996  55
    ## 56.t4  4.5223332  56
    ## 57.t4  4.5300013  57
    ## 58.t4  4.8097712  58
    ## 59.t4  5.3115659  59
    ## 60.t4  5.4086972  60
    ## 61.t4  4.9823563  61
    ## 62.t4  6.4163547  62
    ## 63.t4  4.5656401  63
    ## 64.t4  5.4753755  64
    ## 65.t4  5.9506751  65
    ## 66.t4  3.2446517  66
    ## 67.t4  5.2609614  67
    ## 68.t4  6.2649543  68
    ## 69.t4  5.2060007  69
    ## 70.t4  3.4633761  70
    ## 71.t4  4.5956029  71
    ## 72.t4  4.4378756  72
    ## 73.t4  4.7418712  73
    ## 74.t4  5.2779414  74
    ## 75.t4  3.5711437  75
    ## 76.t4  4.4228274  76
    ## 77.t4  4.2766649  77
    ## 78.t4  5.2088849  78
    ## 79.t4  6.0467590  79
    ## 80.t4  5.7476045  80
    ## 81.t4  2.0106555  81
    ## 82.t4  3.9370269  82
    ## 83.t4  2.5320346  83
    ## 84.t4  6.4147509  84
    ## 85.t4  5.0491436  85
    ## 86.t4  4.9878614  86
    ## 87.t4  4.3564489  87
    ## 88.t4  3.4687095  88
    ## 89.t4  4.6188889  89
    ## 90.t4  4.9794385  90
    ## 91.t4  3.7341070  91
    ## 92.t4  4.6999125  92
    ## 93.t4  4.4169153  93
    ## 94.t4  4.3056009  94
    ## 95.t4  4.2208672  95
    ## 96.t4  4.8199190  96
    ## 97.t4  4.4945058  97
    ## 98.t4  3.1257699  98
    ## 99.t4  3.8628720  99
    ## 100.t4 3.6332851 100

There, that worked, but it was a little inefficient compared to
`gather()` I think.

### Final note on reshaping data

So now you how to reshape your data. Some general tips to keep in mind:
\* `gather()` is great for lengthening data; I would recommend it over
`reshape()` everytime. \* `separate()` can be used to separate a column
that really contains multiple pieces of information \* `spread()` works
for getting widening your data, but it can require some in between
steps. \* `gather()` can be used to combine information kept in two
separate columns \* remember, this is a big one for getting data into
wide format with tidyr and `spread()` \* `reshape()` works really well
for widening your data; I recommend it over `spread()` in most cases. \*
the exception being when your dataset is already in a long (and really,
the longest reasonable) format. \* `reshape()` can be used to lengthen
your data, but it's syntax is a little wonky

### 

Things left for manipulating

-   Manipulating
    -   creating new variables with mutate()
    -   creating summary/aggregate datasets with summarize()
        -   combining group\_by() with summarize, which is where
            summarize gets powerful.
    -   reordering (incl. reordering factor levels, talking abt factors)
    -   combining dataframes (if this makes sense to do/there's time to
        do it) (see relational data in r4ds)
-   Annoyances
    -   dealing with `NaN`s
    -   typing your data (mainly to cover factors, ordered v. unordered)

Resources
=========

-   R Data Import/Export Manual:
    <https://cran.r-project.org/doc/manuals/R-data.pdf>
-   <http://zoonek2.free.fr/UNIX/48_R/02.html#6>
-   <https://www.statmethods.net/interface/io.html>
-   <http://adv-r.had.co.nz/Subsetting.html#applications>
-   <https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf>

<!-- -->

    ## [1] TRUE

    ## [1] TRUE

    ## [1] TRUE

    ## [1] TRUE

    ## [1] TRUE
